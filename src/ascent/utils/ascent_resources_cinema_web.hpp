//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~//
// Copyright (c) 2015-2021, Lawrence Livermore National Security, LLC.
//
// Produced at the Lawrence Livermore National Laboratory
//
// LLNL-CODE-716457
//
// All rights reserved.
//
// This file is part of Ascent.
//
// For details, see: http://ascent.readthedocs.io/.
//
// Please also read ascent/LICENSE
//
// Redistribution and use in source and binary forms, with or without
// modification, are permitted provided that the following conditions are met:
//
// * Redistributions of source code must retain the above copyright notice,
//   this list of conditions and the disclaimer below.
//
// * Redistributions in binary form must reproduce the above copyright notice,
//   this list of conditions and the disclaimer (as noted below) in the
//   documentation and/or other materials provided with the distribution.
//
// * Neither the name of the LLNS/LLNL nor the names of its contributors may
//   be used to endorse or promote products derived from this software without
//   specific prior written permission.
//
// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
// ARE DISCLAIMED. IN NO EVENT SHALL LAWRENCE LIVERMORE NATIONAL SECURITY,
// LLC, THE U.S. DEPARTMENT OF ENERGY OR CONTRIBUTORS BE LIABLE FOR ANY
// DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
// DAMAGES  (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
// OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
// IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
// POSSIBILITY OF SUCH DAMAGE.
//
//~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~//
// ----- 
// NOTE: THIS FILE IS AUTO GENERATED 
// ----- 
std::string RC_CINEMA_WEB =  R"xyzxyz(

{
  "schema": 
  {
    "index.html": {"dtype":"char8_str","number_of_elements": 2033,"offset": 0,"stride": 1,"element_bytes": 1,"endianness": "little"},
    "cvlib": 
    {
      "license.md": {"dtype":"char8_str","number_of_elements": 1658,"offset": 2033,"stride": 1,"element_bytes": 1,"endianness": "little"},
      "ASCENT_README.md": {"dtype":"char8_str","number_of_elements": 786,"offset": 3691,"stride": 1,"element_bytes": 1,"endianness": "little"},
      "README.md": {"dtype":"char8_str","number_of_elements": 3685,"offset": 4477,"stride": 1,"element_bytes": 1,"endianness": "little"},
      "copyright.md": {"dtype":"char8_str","number_of_elements": 1174,"offset": 8162,"stride": 1,"element_bytes": 1,"endianness": "little"},
      "css": 
      {
        "cvlib.css": {"dtype":"char8_str","number_of_elements": 3680,"offset": 9336,"stride": 1,"element_bytes": 1,"endianness": "little"}
      },
      "js": 
      {
        "Database.js": {"dtype":"char8_str","number_of_elements": 901,"offset": 13016,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "ControlsPhiTheta.js": {"dtype":"char8_str","number_of_elements": 5235,"offset": 13917,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "Renderer.js": {"dtype":"char8_str","number_of_elements": 598,"offset": 19152,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "UIFactory.js": {"dtype":"char8_str","number_of_elements": 33470,"offset": 19750,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "DatabaseSpecA.js": {"dtype":"char8_str","number_of_elements": 13013,"offset": 53220,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "ControlsBasic.js": {"dtype":"char8_str","number_of_elements": 2707,"offset": 66233,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "DatabaseSpecA_NoAJAX.js": {"dtype":"char8_str","number_of_elements": 13138,"offset": 68940,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "Parameter.js": {"dtype":"char8_str","number_of_elements": 1500,"offset": 82078,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "ResultSet.js": {"dtype":"char8_str","number_of_elements": 671,"offset": 83578,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "RendererSpecA.js": {"dtype":"char8_str","number_of_elements": 2080,"offset": 84249,"stride": 1,"element_bytes": 1,"endianness": "little"},
        "QuerySet.js": {"dtype":"char8_str","number_of_elements": 1880,"offset": 86329,"stride": 1,"element_bytes": 1,"endianness": "little"}
      },
      "lib": 
      {
        "jquery-3.1.1.min.js": {"dtype":"char8_str","number_of_elements": 86710,"offset": 88209,"stride": 1,"element_bytes": 1,"endianness": "little"}
      }
    }
  },
  "data": 
  {
    "base64": "PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9J2VuJz4KPGhlYWQ+CiAgICA8bWV0YSBjaGFyc2V0PSd1dGYtOCc+CiAgICA8dGl0bGU+Q2luZW1hIFZpZXdlciAtIFNwZWMgQTwvdGl0bGU+CiAgICA8bWV0YSBuYW1lPSdkZXNjcmlwdGlvbicgY29udGVudD0nQSBDaW5lbWEgVmlld2VyIGNhcGFibGUgb2YgYnJvd3NpbmcgU3BlYyBBIGRhdGFiYXNlcyc+CiAgICA8bWV0YSBuYW1lPSdhdXRob3InIGNvbnRlbnQ9J0pvbmFzIEx1a2FzY3p5ayc+CiAgICA8bGluayByZWw9J3N0eWxlc2hlZXQnIGhyZWY9J2N2bGliL2Nzcy9jdmxpYi5jc3MnPgogICAgPHNjcmlwdCBzcmM9J2luZm8uanMnPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9J2N2bGliL2xpYi9qcXVlcnktMy4xLjEubWluLmpzJz48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSdjdmxpYi9qcy9QYXJhbWV0ZXIuanMnPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9J2N2bGliL2pzL1F1ZXJ5U2V0LmpzJz48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSdjdmxpYi9qcy9SZXN1bHRTZXQuanMnPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9J2N2bGliL2pzL1VJRmFjdG9yeS5qcyc+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0nY3ZsaWIvanMvQ29udHJvbHNQaGlUaGV0YS5qcyc+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0nY3ZsaWIvanMvRGF0YWJhc2UuanMnPjwvc2NyaXB0PgogICAgPHNjcmlwdCBzcmM9J2N2bGliL2pzL0RhdGFiYXNlU3BlY0FfTm9BSkFYLmpzJz48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSdjdmxpYi9qcy9SZW5kZXJlci5qcyc+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0nY3ZsaWIvanMvUmVuZGVyZXJTcGVjQS5qcyc+PC9zY3JpcHQ+CjwvaGVhZD4KPGJvZHk+CiAgICA8c2NyaXB0PgogICAgICAgIC8vIGluZm8gaXMgcHVsbGVkIGluIHZpYSAiaW5mby5qcyIgamF2YXNjcmlwdCBzY3JpcHQgdGFnIGFib3ZlCiAgICAgICAgLy8gYXNjZW50IGNyZWF0ZXMgdGhpcyBmaW5lLCBpbiBhZGRpdGlvbiB0byBpbmZvLmpzb24KICAgICAgICB2YXIgZGIgPSBuZXcgQ1ZMSUIuRGF0YWJhc2VTcGVjQV9Ob0FKQVgoaW5mbyk7CiAgICAgICAgdmFyIHNpZGViYXJMYXlvdXQgPSBDVkxJQi5VSUZhY3RvcnkuY3JlYXRlU2lkZWJhckxheW91dCgpOwogICAgICAgIHNpZGViYXJMYXlvdXQuc2lkZWJhci5hcHBlbmQoICc8aDI+Q2luZW1hIFZpZXdlcjxicj5TcGVjIEEgLSBTaW5nbGU8L2gyPicgKTsKICAgICAgICAkKCdib2R5JykuYXBwZW5kKHNpZGViYXJMYXlvdXQpOwoKICAgICAgICB2YXIgcXVlcnlUYWJsZSA9IENWTElCLlVJRmFjdG9yeS5jcmVhdGVTaW1wbGVRdWVyeVRhYmxlKCBkYi5xdWVyeVNldCApOwogICAgICAgIHNpZGViYXJMYXlvdXQuc2lkZWJhci5hcHBlbmQocXVlcnlUYWJsZSk7CgogICAgICAgIHZhciB2aWV3cG9ydCA9IENWTElCLlVJRmFjdG9yeS5jcmVhdGVWaWV3cG9ydCgpOwogICAgICAgIHNpZGViYXJMYXlvdXQuY29udGVudC5hcHBlbmQodmlld3BvcnQpOwoKICAgICAgICBuZXcgQ1ZMSUIuQ29udHJvbHNQaGlUaGV0YSh2aWV3cG9ydCwgZGIucXVlcnlTZXQpOwoKICAgICAgICB2YXIgcmVuZGVyZXIgPSBuZXcgQ1ZMSUIuUmVuZGVyZXJTcGVjQSgpOwoKICAgICAgICB2YXIgcmVuZGVyRnVuY3Rpb24gPSBmdW5jdGlvbihyZXN1bHRTZXQpewogICAgICAgICAgICByZW5kZXJlci5yZW5kZXIocmVzdWx0U2V0LmRhdGEsIHZpZXdwb3J0LmNhbnZhcywgdHJ1ZSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIHVwZGF0ZUZ1bmN0aW9uID0gZnVuY3Rpb24oZSwgcGFyYW1ldGVyKXsKICAgICAgICAgICAgZGIucHJvY2Vzc1F1ZXJ5KCBkYi5xdWVyeVNldCwgcmVuZGVyRnVuY3Rpb24gKTsKICAgICAgICB9OwoKICAgICAgICBkYi5xdWVyeVNldC5lbWl0dGVyLm9uKAogICAgICAgICAgICAnY2hhbmdlJywKICAgICAgICAgICAgdXBkYXRlRnVuY3Rpb24KICAgICAgICApOwoKICAgICAgICB1cGRhdGVGdW5jdGlvbigpOwogICAgPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPgBDb3B5cmlnaHQgKGMpIDIwMTgtMjAxOSwgVHJpYWQgTmF0aW9uYWwgU2VjdXJpdHksIExMQy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICAKUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvcgp3aXRob3V0IG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucwphcmUgbWV0OgoKICAgIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSwgCiAgICAgICB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgoKICAgIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CiAgICAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhlCiAgICAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLgoKICAgIDMuIE5laXRoZXIgdGhlIG5hbWUgb2YgTG9zIEFsYW1vcyBOYXRpb25hbCBTZWN1cml0eSwgTExDLCBMb3MgQWxhbW9zCiAgICAgICBOYXRpb25hbCBMYWJvcmF0b3J5LCBMQU5MLCB0aGUgVS5TLiBHb3Zlcm5tZW50LCBub3IgdGhlIG5hbWVzIG9mIGl0cwogICAgICAgY29udHJpYnV0b3JzIG1heSBiZSB1c2VkIHRvIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gCiAgICAgICB0aGlzIHNvZnR3YXJlIHdpdGhvdXQgc3BlY2lmaWMgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLgogICAgClRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgVEhFIENPUFlSSUdIVCBIT0xERVJTIENPTlRSSUJVVE9SUyAiQVMgSVMiIEFORCAKQU5ZIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFIElNUExJRUQgCldBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkUgCkRJU0NMQUlNRUQuIElOIE5PIEVWRU5UIFNIQUxMIExPUyBBTEFNT1MgTkFUSU9OQUwgU0VDVVJJVFksIExMQyBPUiBDT05UUklCVVRPUlMgCkJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgCkNPTlNFUVVFTlRJQUwgREFNQUdFUyAoSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNUSVRVVEUgCkdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSAKSE9XRVZFUiBDQVVTRUQgQU5EIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgCkxJQUJJTElUWSwgT1IgVE9SVCAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5HIElOIEFOWSBXQVkgT1VUIE9GClRIRSBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS4KADIwMTkvMDYvMTggQWRhcHRlZCBmcm9tOgoKNmZmOTM1ZSAoSEVBRCAtPiBtYXN0ZXIsIG9yaWdpbi9tYXN0ZXIsIG9yaWdpbi9IRUFEKSBIRUFEQHswfTogY2xvbmU6IGZyb20gaHR0cHM6Ly9naXRodWIuY29tL2NpbmVtYXNjaWVuY2UvY3ZsaWIuZ2l0CgpPbmUgY2hhbmdlLCB3aGljaCBhbGxvd3MgdGhlIGh0bWwgY2xpZW50IHBhZ2UgdG8gZXhpc3QgcmlnaHQgYmVzaWRlIHRoZSBpbmZvLmpzb246CgoKZGlmZiAtLWdpdCBhL2pzL0RhdGFiYXNlU3BlY0EuanMgYi9qcy9EYXRhYmFzZVNwZWNBLmpzCmluZGV4IGZkMWVlNTEuLmUxYWY3ZjUgMTAwNjQ0Ci0tLSBhL2pzL0RhdGFiYXNlU3BlY0EuanMKKysrIGIvanMvRGF0YWJhc2VTcGVjQS5qcwpAQCAtMTgsNyArMTgsMTAgQEAgZnVuY3Rpb24gRGF0YWJhc2VTcGVjQSh1cmwsIGNhbGxiYWNrKXsKICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGpzb24pewotICAgICAgICAgICAganNvbi5kYXRhYmFzZURpciA9IHByZWZpeCsnLyc7CisgICAgICAgICAgICBpZiggcHJlZml4ID09PSAiIikKKyAgICAgICAgICAgICAgICBqc29uLmRhdGFiYXNlRGlyID0gJyc7CisgICAgICAgICAgICBlbHNlCisgICAgICAgICAgICAgICAganNvbi5kYXRhYmFzZURpciA9IHByZWZpeCsnLyc7CiAgICAgICAgICAgICBpZighc2VsZi52YWxpZGF0ZUpTT04oanNvbikpCiAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgc2VsZi5qc29uID0ganNvbjsKACMgQ1ZMSUIgLSBDaW5lbWEgVmlld2VyIExpYnJhcnkKCiMjIE5PVEU6IENWTElCIGlzIGZvciBTcGVjLUEgQ2luZW1hIERhdGFiYXNlcyBPTkxZIQoKQ1ZMSUIgaXMgYSBsaWJyYXJ5IHdoaWNoIHByb3ZpZGVzIGEgSmF2YVNjcmlwdCBBUEkgdG8gUGFyYXZpZXcgQ2luZW1hIGRhdGFiYXNlcyBmb3IgdmlzdWFsaXphdGlvbiBpbiB0aGUgQnJvd3Nlci4KCkluIGNvbnRyYXN0IHRvIG90aGVyIENpbmVtYSB2aWV3ZXJzIHRoaXMgbGlicmFyeSBpcyBmb2N1c2luZyBvbiBtb2R1bGFyIGV4cGFuZGFiaWxpdHkuIE1vc3QgYXBwbGljYXRpb25zIGhhdmUgYWRkaXRpb25hbCB2aWV3ZXIgcmVxdWlyZW1lbnRzIHN1Y2ggYXMgc3BlY2lhbGl6ZWQgZGF0YSB2aXN1YWxpemF0aW9ucywgYWdncmVnYXRpb25zLCBpbnRlcmFjdGlvbnMsIGFuZCBvdGhlciBmZWF0dXJlcyBhIGdlbmVyaWMgYWxsLWluLW9uZSB2aWV3ZXIgY2FuIG5vdCBwcm92aWRlLiBIZW5jZSwgQ1ZMSUIgcHJvdmlkZXMgZnVuY3Rpb25zIHRvIGFjY2VzcyBDaW5lbWEgZGF0YWJhc2VzLCBwcm9jZXNzIHF1ZXJpZXMsIGNyZWF0ZSB2aWV3ZXIgVUkgZWxlbWVudHMsIHJlbmRlciByZXN1bHRzLCBhbmQgaW50ZXJhY3Qgd2l0aCB0aGUgdmlzdWFsaXphdGlvbiBzbyB0aGF0IHVzZXJzIGNhbiBidWlsZCB0aGVpciBvd24gY3VzdG9tIHZpZXdlci4KClRoZSAqKkRlbW9zKiogZm9sZGVyIGNvbnRhaW5zIG1hbnkgcHJlLWJ1aWx0IHZpZXdlcnMgYW5kIHNhbXBsZSBkYXRhYmFzZXMgdG8gc3R1ZHkgaG93IHRvIHVzZSBjdmxpYiBpbiB2YXJpb3VzIHdheXMuIEl0IGlzIHJlY29tbWVuZGVkIHRvIGZpcnN0IGxvb2sgYXQgdGhlIHZpZXdlcnMgbWFya2VkIHdpdGggYSAqKkJFRyoqIChmb3IgYmVnaW5uZXIpIGJlZm9yZSBleGFtaW5pbmcgdGhlIGludGVybWVkaWF0ZSAoKipJTlQqKikgYW5kIGFkdmFuY2VkICgqKkFEVioqKSB2aWV3ZXJzLgoKIyMjIEFyY2hpdGVjdHVyZQpDVkxJQiBmb2xsb3dzIGEgc2ltcGxlIHN5c3RlbSBhcmNoaXRlY3R1cmUuIEl0IHByb3ZpZGVzIHRoZSBmb2xsb3dpbmcgY2xhc3NlczoKKiAqKlBhcmFtZXRlcioqOiBhIHBhcmFtZXRlciB3aGljaCBjYW4gYmUgcXVlcnlpZWQgKGUuZy4gY2FtZXJhIGFuZ2xlLCBpc28tdmFsdWUsIHRpbWUsIC4uLikKKiAqKlF1ZXJ5U2V0Kio6IGEgc2V0IG9mIFBhcmFtZXRlcnMKKiAqKlJlc3VsdFNldCoqOiBhIHJlc3BvbnNlIHRvIGEgUXVlcnlTZXQgKGUuZy4gaW1hZ2VzLCBncmFwaHMsIG51bWJlcnMsIC4uLikKKiAqKkRhdGFiYXNlKio6IHByb3ZpZGVzIGFuIGludGVyZmFjZSB0byB0aGUgQ2luZW1hIGRhdGFiYXNlIGFuZCBwcm9jZXNzZXMgUXVlcnlTZXRzCiogKipSZW5kZXJlcioqOiByZW5kZXJzIFJlc3VsdFNldHMKKiAqKlVJRmFjdG9yeSoqOiBnZW5lcmF0ZXMgSFRNTCB3aWRnZXRzIHRvIHJlcXVlc3QgUXVlcnlTZXRzIGFuZCBkaXNwbGF5IHJlbmRlcmVkIFJlc3VsdFNldHMKKiAqKkNvbnRyb2xzKio6IGF1Z21lbnRzIEhUTUwgd2lkZ2V0cyBlbGVtZW50cyB3aXRoIG1vdXNlIGludGVyYWN0aW9ucyBzdWNoIGFzIHBhbm5pbmcgYW5kIHpvb21pbmcKCkEgQ2luZW1hIGRhdGFiYXNlIGlzIGludGVyZmFjZWQgdmlhIHRoZSBEYXRhYmFzZSBjbGFzcyB3aGljaCBjYW4gcHJvY2VzcyBRdWVyeVNldHMuIFRoZSBkYXRhYmFzZSB3aWxsIHJlc3BvbmQgd2l0aCBSZXN1bHRTZXRzIHdoaWNoIGNhbiBiZSByZW5kZXJlZCB3aXRoIHRoZSBSZW5kZXJlci4gVGhlIFVJRmFjdG9yeSBjYW4gZ2VuZXJhdGUgSFRNTCB3aWRnZXRzIHRvIGFkanVzdCBRdWVyeVNldHMgdmlhIGlucHV0IGVsZW1lbnRzIGFuZCBkaXNwbGF5IG91dHB1dCBmcm9tIHRoZSBSZW5kZXJlciB3aXRoIHZpZXdwb3J0cy4gVGhlIGRpZmZlcmVudCBDb250cm9sIGNsYXNzZXMgZW5hYmxlIHVzZXJzIHRvIHpvb20sIHBhbiwgYW5kIHJvdGF0ZSB2aWV3cG9ydHMuCgojIyMgRXhhbXBsZXMKVG8gY3JlYXRlIHZpZXdlcnMgb25lIHNpbXBseSBoYXMgdG8gdXNlIHRoZSBtb2R1bGVzIGFuZCBpbnRlcmNvbm5lY3QgdGhlbS4KCmBgYGphdmFzY3JpcHQKLy8gTG9hZCBKU09OIGZpbGUgZGVjcmliaW5nIGEgQ2luZW1hIFNwZWNBIERhdGFiYXNlIGFuZCByZXR1cm4gdGhlIGRhdGFiYXNlIFNjaGVtZSBhcyBhIFF1ZXJ5U2V0CnZhciBkYiA9IG5ldyBDVkxJQi5EYXRhYmFzZVNwZWNBKCdkYXRhL3ZvbHVtZS1yZW5kZXIvaW5mby5qc29uJywgZnVuY3Rpb24ocXVlcnlTZXQpewoKICAgIC8vIENyZWF0ZSBhIHNpZGViYXIgbGF5b3V0CiAgICB2YXIgc2lkZWJhckxheW91dCA9IENWTElCLlVJRmFjdG9yeS5jcmVhdGVTaWRlYmFyTGF5b3V0KCk7CgogICAgLy8gQWRkIHRoZSBsYXlvdXQgdG8gdGhlIGJvZHkKICAgICQoJ2JvZHknKS5hcHBlbmQoc2lkZWJhckxheW91dCk7CgogICAgLy8gQWRkIGEgaGVhZGxpbmUgdG8gdGhlIHNpZGViYXIKICAgIHNpZGViYXJMYXlvdXQuc2lkZWJhci5hcHBlbmQoICc8aDI+Q2luZW1hIFZpZXdlcjxicj5TcGVjIEEgLSBTaW5nbGU8L2gyPicgKTsKCiAgICAvLyBDcmVhdGUgYSB0YWJsZSB3aXRoIGlucHV0IHdpZGdldHMgdG8gbW9kaWZ5IHRoZSBRdWVyeVNldAogICAgdmFyIHF1ZXJ5VGFibGUgPSBDVkxJQi5VSUZhY3RvcnkuY3JlYXRlU2ltcGxlUXVlcnlUYWJsZSggcXVlcnlTZXQgKTsKCiAgICAvLyBBZGQgdGhlIFF1ZXJ5VGFibGUgdG8gdGhlIHNpZGViYXIKICAgIHNpZGViYXJMYXlvdXQuc2lkZWJhci5hcHBlbmQocXVlcnlUYWJsZSk7CgogICAgLy8gQ3JlYXRlIGEgdmlld3BvcnQgZm9yIHRoZSBpbWFnZXMKICAgIHZhciB2aWV3cG9ydCA9IENWTElCLlVJRmFjdG9yeS5jcmVhdGVWaWV3cG9ydCgpOwoKICAgIC8vIEFkZCB0aGUgVmlld3BvcnQgdG8gdGhlIGNvbnRlbnQKICAgIHNpZGViYXJMYXlvdXQuY29udGVudC5hcHBlbmQodmlld3BvcnQpOwoKICAgIC8vIEF1Z21lbnQgdGhlIHZpZXdwb3J0IHdpdGggY29udHJvbHMgd2hpY2ggY2FuIGFsc28gbW9kaWZ5IHRoZSBRdWVyeVNldAogICAgbmV3IENWTElCLkNvbnRyb2xzUGhpVGhldGEodmlld3BvcnQsIHF1ZXJ5U2V0KTsKCiAgICAvLyBDcmVhdGUgUmVuZGVyZXIgZm9yIFNwZWNBIGltYWdlcwogICAgdmFyIHJlbmRlcmVyID0gbmV3IENWTElCLlJlbmRlcmVyU3BlY0EoKTsKCiAgICAvLyBGdW5jdGlvbiB3aGljaCByZW5kZXJzIGEgcmVzdWx0U2V0IHRvIGEgY2FudmFzCiAgICB2YXIgcmVuZGVyRnVuY3Rpb24gPSBmdW5jdGlvbihyZXN1bHRTZXQpewogICAgICAgIHJlbmRlcmVyLnJlbmRlcihyZXN1bHRTZXQuZGF0YSwgdmlld3BvcnQuY2FudmFzLCB0cnVlKTsKICAgIH07CgogICAgLy8gRnVuY3Rpb24gd2hpY2ggcmVxdWVzdHMgYSBSZXN1bHRTZXQgZm9yIHRoZSBjdXJyZW50IFF1ZXJ5U2V0CiAgICB2YXIgdXBkYXRlRnVuY3Rpb24gPSBmdW5jdGlvbigpewogICAgICAgIGRiLnByb2Nlc3NRdWVyeSggcXVlcnlTZXQsIHJlbmRlckZ1bmN0aW9uICk7CiAgICB9OwoKICAgIC8vIE9uIGNoYW5nZSBvZiB0aGUgUXVlcnlTZXQgY2FsbCB1cGRhdGVGdW5jdGlvbgogICAgcXVlcnlTZXQuZW1pdHRlci5vbigKICAgICAgICAnY2hhbmdlJywKICAgICAgICB1cGRhdGVGdW5jdGlvbgogICAgKTsKCiAgICAvLyBSZXF1ZXN0IGltYWdlIGZvciBpbml0aWFsIFF1ZXJ5U2V0CiAgICB1cGRhdGVGdW5jdGlvbigpOwp9KTsKYGBgCgBDb3B5cmlnaHQgKGMpIDIwMTgtMjAxOSwgVHJpYWQgTmF0aW9uYWwgU2VjdXJpdHksIExMQy4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KClRoaXMgc29mdHdhcmUgd2FzIHByb2R1Y2VkIHVuZGVyIFUuUy4gR292ZXJubWVudCBjb250cmFjdCA4OTIzMzIxOENOQTAwMDAwMSBmb3IgCkxvcyBBbGFtb3MgTmF0aW9uYWwgTGFib3JhdG9yeSAoTEFOTCksIHdoaWNoIGlzIG9wZXJhdGVkIGJ5IFRyaWFkIE5hdGlvbmFsIApTZWN1cml0eSwgTExDIGZvciB0aGUgVS5TLiBEZXBhcnRtZW50IG9mIEVuZXJneS9OYXRpb25hbCBOdWNsZWFyIFNlY3VyaXR5IApBZG1pbmlzdHJhdGlvbi4KCkFsbCByaWdodHMgaW4gdGhlIHByb2dyYW0gYXJlIHJlc2VydmVkIGJ5IFRyaWFkIE5hdGlvbmFsIFNlY3VyaXR5LCBMTEMsIGFuZCB0aGUgClUuUy4gRGVwYXJ0bWVudCBvZiBFbmVyZ3kvTmF0aW9uYWwgTnVjbGVhciBTZWN1cml0eSBBZG1pbmlzdHJhdGlvbi4gVGhlIApHb3Zlcm5tZW50IGlzIGdyYW50ZWQgZm9yIGl0c2VsZiBhbmQgb3RoZXJzIGFjdGluZyBvbiBpdHMgYmVoYWxmIGEgbm9uZXhjbHVzaXZlLApwYWlkLXVwLCBpcnJldm9jYWJsZSB3b3JsZHdpZGUgbGljZW5zZSBpbiB0aGlzIG1hdGVyaWFsIHRvIHJlcHJvZHVjZSwgcHJlcGFyZSAKZGVyaXZhdGl2ZSB3b3JrcywgZGlzdHJpYnV0ZSBjb3BpZXMgdG8gdGhlIHB1YmxpYywgcGVyZm9ybSBwdWJsaWNseSBhbmQgZGlzcGxheSAKcHVibGljbHksIGFuZCB0byBwZXJtaXQgb3RoZXJzIHRvIGRvIHNvLiAKClRoaXMgaXMgb3BlbiBzb3VyY2Ugc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnkgaXQgdW5kZXIgdGhlCnRlcm1zIG9mIHRoZSAiMy1DbGF1c2UgQlNEIExpY2Vuc2UiLiBJZiBzb2Z0d2FyZSBpcyBtb2RpZmllZCB0byBwcm9kdWNlIApkZXJpdmF0aXZlIHdvcmtzLCBzdWNoIG1vZGlmaWVkIHNvZnR3YXJlIHNob3VsZCBiZSBjbGVhcmx5IG1hcmtlZCwgc28gYXMgbm90IHRvIApjb25mdXNlIGl0IHdpdGggdGhlIHZlcnNpb24gYXZhaWxhYmxlIGZyb20gTEFOTC4gRnVsbCB0ZXh0IG9mIHRoZSAiMy1DbGF1c2UgQlNEIApMaWNlbnNlIiBjYW4gYmUgZm91bmQgaW4gdGhlIExpY2Vuc2UgZmlsZSBpbiB0aGUgbWFpbiBkZXZlbG9wbWVudCBicmFuY2ggb2YgdGhlIApyZXBvc2l0b3J5LgoALmN2bGliX2NhbnZhcyB7CiAgICBkaXNwbGF5OiBibG9jazsKfQoKLmN2bGliX3NpZGViYXJMYXlvdXRTaWRlYmFyIHsKICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgIGxlZnQ6MDsKICAgIHRvcDowOwogICAgYm90dG9tOjA7CiAgICBvdmVyZmxvdzogYXV0bzsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7Cn0KLmN2bGliX3NpZGViYXJMYXlvdXRDb250ZW50IHsKICAgIHRvcDowOwogICAgYm90dG9tOjA7CiAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICByaWdodDogMDsKICAgIG92ZXJmbG93OiBhdXRvOwogICAgcGFkZGluZzozMHB4IDEwcHggMCA1cHg7Cn0KCi5jdmxpYl9jYW52YXNDb250YWluZXIgewogICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgcG9zaXRpb246cmVsYXRpdmU7CiAgICAvKm92ZXJmbG93OmhpZGRlbjsqLwogICAgYm9yZGVyOjFweCBzb2xpZCAjY2NjOwp9CgouY3ZsaWJfcXVlcnlUYWJsZSB7CiAgICBib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7CiAgICBtYXJnaW46NXB4Owp9CgouY3ZsaWJfcXVlcnlUYWJsZSB0ZCB7CiAgICBib3JkZXItYm90dG9tOjFweCBzb2xpZCAjY2NjOwogICAgcGFkZGluZzo4cHggMTBweDsKICAgIHZlcnRpY2FsLWFsaWduOm1pZGRsZTsKICAgIGhlaWdodDoyOHB4OwoKICAgIC13ZWJraXQtdG91Y2gtY2FsbG91dDogbm9uZTsgLyogaU9TIFNhZmFyaSAqLwogICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsgICAvKiBDaHJvbWUvU2FmYXJpL09wZXJhICovCiAgICAta2h0bWwtdXNlci1zZWxlY3Q6IG5vbmU7ICAgIC8qIEtvbnF1ZXJvciAqLwogICAgLW1vei11c2VyLXNlbGVjdDogbm9uZTsgICAgICAvKiBGaXJlZm94ICovCiAgICAtbXMtdXNlci1zZWxlY3Q6IG5vbmU7ICAgICAgIC8qIEludGVybmV0IEV4cGxvcmVyL0VkZ2UgKi8KICAgIHVzZXItc2VsZWN0OiBub25lOyAgICAgICAgICAgLyogTm9uLXByZWZpeGVkIHZlcnNpb24sIGN1cnJlbnRseQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3Qgc3VwcG9ydGVkIGJ5IGFueSBicm93c2VyICovCn0KCi5jdmxpYl9xdWVyeVRhYmxlIHRkOmZpcnN0LWNoaWxkIHsKICAgIGN1cnNvcjpwb2ludGVyOwogICAgZm9udC13ZWlnaHQ6Ym9sZDsKfQoKLmN2bGliX3F1ZXJ5VGFibGUgdGQ6bnRoLWNoaWxkKDIpIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKfQoKLmN2bGliX3F1ZXJ5VGFibGUgdGQ6bnRoLWNoaWxkKDMpIHsKICAgIG1pbi13aWR0aDoxNTVweDsKfQoKLmN2bGliX3ZhcmlhYmxlUm93IHsKICAgIC8qYmFja2dyb3VuZC1jb2xvcjogI2ZlZmVmZTsqLwp9CgovKi5jdmxpYl9xdWVyeVRhYmxlIHRkOm50aC1jaGlsZCg0KSB7Ki8KLyogICAgbWluLXdpZHRoOjc1cHg7Ki8KLyp9Ki8KCi5jdmxpYl9xdWVyeVRhYmxlIHRkIGlucHV0W3R5cGU9Im51bWJlciJdewogICAgd2lkdGg6NTBweDsKfQoKLmN2bGliX21hdHJpeCB7CiAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOwp9CgouY3ZsaWJfbWF0cml4IHRkIHsKICAgIG1hcmdpbjowOwogICAgcGFkZGluZzowOwogICAgdmVydGljYWwtYWxpZ246IHRvcDsKICAgIC8qYm9yZGVyOiAxcHggc29saWQgI2NjYzsqLwp9CgouY3ZsaWJfbWF0cml4IHRkIHNwYW4gewogICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICB6LWluZGV4OjE7CiAgICBsZWZ0OjRweDsKICAgIHRvcDo0cHg7CiAgICBjb2xvcjogIzc3NzsKICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7Cn0KCi5jdmxpYl9zZXRJbnB1dCB1bCB7CiAgICBmbG9hdDogbGVmdDsKICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7CiAgICBwYWRkaW5nOiAwOwogICAgbWFyZ2luOiAwIDEwcHg7CiAgICBsaXN0LXN0eWxlLXR5cGU6IG5vbmU7CgogICAgLXdlYmtpdC10b3VjaC1jYWxsb3V0OiBub25lOyAvKiBpT1MgU2FmYXJpICovCiAgICAtd2Via2l0LXVzZXItc2VsZWN0OiBub25lOyAgIC8qIENocm9tZS9TYWZhcmkvT3BlcmEgKi8KICAgIC1raHRtbC11c2VyLXNlbGVjdDogbm9uZTsgICAgLyogS29ucXVlcm9yICovCiAgICAtbW96LXVzZXItc2VsZWN0OiBub25lOyAgICAgIC8qIEZpcmVmb3ggKi8KICAgIC1tcy11c2VyLXNlbGVjdDogbm9uZTsgICAgICAgLyogSW50ZXJuZXQgRXhwbG9yZXIvRWRnZSAqLwogICAgdXNlci1zZWxlY3Q6IG5vbmU7ICAgICAgICAgICAvKiBOb24tcHJlZml4ZWQgdmVyc2lvbiwgY3VycmVudGx5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdCBzdXBwb3J0ZWQgYnkgYW55IGJyb3dzZXIgKi8KfQoKLmN2bGliX3NldElucHV0IGxpIHsKICAgIG1hcmdpbjogMDsKICAgIGN1cnNvcjogcG9pbnRlcjsKICAgIG1hcmdpbi10b3A6IDFweDsKICAgIHBhZGRpbmc6IDNweCA1cHg7Cn0KCi5jdmxpYl9zZXRJbnB1dCAuZHJhZ092ZXIgewogICAgbWFyZ2luLXRvcDogMDsKICAgIGJvcmRlci10b3A6MXB4IHNvbGlkICNmMDA7Cn0KCi5jdmxpYl9zZXRJbnB1dCBsaTpob3ZlciB7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlOwp9CgoKCi5jdmxpYl9zZWFyY2hCYXIgewogICAgd2lkdGg6IDkwJTsKICAgIG1hcmdpbjogNXB4Owp9CgouY3ZsaWJfc2VhcmNoTWVzc2FnZSB7CiAgICBtYXJnaW46IDVweDsKICAgIG1heC13aWR0aDogMzAwcHgKfQoKLmN2bGliX3NlYXJjaE1lc3NhZ2VbbW9kZT0iZXJyb3IiXSB7CiAgICBjb2xvcjogZGFya3JlZDsKfQouY3ZsaWJfc2VhcmNoTWVzc2FnZVttb2RlPSJ2YWxpZCJdIHsKICAgIGNvbG9yOiBncmVlbjsKfQouY3ZsaWJfc2VhcmNoTWVzc2FnZVttb2RlPSJ3YWl0aW5nIl0gewogICAgY29sb3I6IGJsYWNrOwp9CgouY3ZsaWJfbG9hZGluZ0JhciB7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB6LWluZGV4OiAxMDsKICAgIHRvcDogMDsKICAgIGxlZnQ6IDA7CiAgICB3aWR0aDogMDsKICAgIGhlaWdodDogNXB4OwogICAgYmFja2dyb3VuZC1jb2xvcjogI2FhMDAwMDsKfQoKLmN2bGliX2xvYWRpbmdTeW1ib2wgewogICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICB6LWluZGV4OjE7CiAgICByaWdodDo0cHg7CiAgICB0b3A6NHB4Owp9CgouY3ZsaWJfbnVtYmVySW5wdXQgewogICAgd2lkdGg6NTBweDsKICAgIHRleHQtYWxpZ246IHJpZ2h0Owp9CgouY3ZsaWJfbnVtYmVyTGFiZWwgewogICAgcGFkZGluZy1sZWZ0OiA1cHg7CiAgICB3aWR0aDogNTBweDsKICAgIHRleHQtYWxpZ246IHJpZ2h0Owp9CgouY3ZsaWJfbGFiZWwgewogICAgcG9zaXRpb246YWJzb2x1dGU7CiAgICB0b3A6MDsKICAgIHdpZHRoOjEwMCU7CiAgICBoZWlnaHQ6MTAwJTsKICAgIGNvbG9yOmdyYXk7Cn0KCi8qLmN2bGliX2xvYWRpbmcgeyovCi8qICAgIHBvc2l0aW9uOmFic29sdXRlOyovCi8qICAgIGxlZnQ6NXB4OyovCi8qICAgIHRvcDo1cHg7Ki8KLyogICAgd2lkdGg6IDEwcHg7Ki8KLyogICAgaGVpZ2h0OiAxMHB4OyovCi8qICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7Ki8KLyogICAgYm9yZGVyOiAzcHggc29saWQ7Ki8KLyogICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudCAjMDAwIHRyYW5zcGFyZW50ICMwMDA7Ki8KLyogICAgYW5pbWF0aW9uOiBleGFtcGxlIDAuN3MgbGluZWFyIDBzIGluZmluaXRlOyovCi8qfSovCi8qQGtleWZyYW1lcyBleGFtcGxlIHsqLwovKiAgICAxMDAlIHt0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpO30qLwovKn0qLwAndXNlIHN0cmljdCc7IC8qIGdsb2JhbHMgJCBDVkxJQiAqLwooLyoqIEBsZW5kcyBtb2R1bGU6Q1ZMSUIgKi9mdW5jdGlvbigpewoKLyoqCiAqIEBjb25zdHJ1Y3RvcgogKiBAYWJzdHJhY3QKICovCmZ1bmN0aW9uIERhdGFiYXNlKHVybCwgY2FsbGJhY2spewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IERhdGFiYXNlKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW4ndCBpbnN0YW50aWF0ZSBhYnN0cmFjdCBjbGFzcyEiKTsKICAgIH0KfQoKLyoqCiAqIFZhbGlkYXRlIGlmIEpTT04gZmlsZSBpcyBjb21wbGlhbnQgdG8gYSBTcGVjCiAqIEBwYXJhbSB7SlNPTn0ganNvbiAtIEpTT04gb2JqZWN0CiAqIEByZXR1cm4ge2Jvb2x9CiAqLwpEYXRhYmFzZS5wcm90b3R5cGUudmFsaWRhdGVKU09OID0gZnVuY3Rpb24oanNvbil7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkFic3RyYWN0IG1ldGhvZCEiKTsKfTsKCi8qKgogKiBBc3luY2hyb25vdXNseSBwcm9jZXNzZXMgYSBxdWVyeVNldCBhbmQgcGFzc2VzIHRoZSByZXN1bHRTZXQgdG8gYSBjYWxsYmFjawogKiBAcGFyYW0ge1F1ZXJ5U2V0fSBxdWVyeVNldCAtIGRhdGFiYXNlIHJlcXVlc3QKICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sgLSB3aWxsIGJlIGNhbGxlZCBhZnRlciByZXF1ZXN0IGhhcyBiZWVuIHByb2NlZWQgd2l0aCBSZXN1bHRTZXQgYXMgaXRzIGZpcnN0IGFyZ3VtZW50CiAqLwpEYXRhYmFzZS5wcm90b3R5cGUucHJvY2Vzc1F1ZXJ5ID0gZnVuY3Rpb24ocXVlcnlTZXQsIGNhbGxiYWNrKXsKICAgIHRocm93IG5ldyBFcnJvcigiQWJzdHJhY3QgbWV0aG9kISIpOwp9OwoKaWYoIXdpbmRvdy5DVkxJQikgd2luZG93LkNWTElCID0ge307CndpbmRvdy5DVkxJQi5EYXRhYmFzZSA9IERhdGFiYXNlOwoKfSkoKTsAJ3VzZSBzdHJpY3QnOyAvKiBnbG9iYWxzICQgQ1ZMSUIgKi8KKC8qKiBAbGVuZHMgbW9kdWxlOkNWTElCICovZnVuY3Rpb24oKXsKCi8qKgogKiBBdWdtZW50cyBhIHZpZXdwb3J0IHdpdGggbW91c2UtY29udHJvbHMgdG8gem9vbSwgcGFuLCBhbmQgcm90YXRlIGFjY29yZGluZyB0byBhIHBoaS10aGV0YSBjYW1lcmEgbW9kZWwuCiAqIFdpdGggdGhlc2UgY29udHJvbHMsIGxlZnQtY2xpY2stYW5kLWRyYWdnaW5nIG9uIHRoZSBpbWFnZSByb3RhdGVzIHRoZSB2aWV3LCBzY3JvbGxpbmcgcmVzaXplcyB0aGUgaW1hZ2UKICogYW5kIHNoaWZ0LWNsaWNrLWFuZC1kcmFnZ2luZyBwYW5zIHRoZSBpbWFnZS4KICogQGNvbnN0cnVjdG9yCiAqIEBwYXJhbSB7dmlld3BvcnR9IHZpZXdwb3J0IC0gdmlld3BvcnQgd2hpY2ggaXMgdGFyZ2V0IG9mIHRoZSBtb3VzZSBpbnRlcmFjdGlvbgogKiBAcGFyYW0ge1F1ZXJ5U2V0fSBxdWVyeVNldCAtIGlzIHVwZGF0ZWQgYWZ0ZXIgdmlldyBpcyByb3RhdGVkCiAqLwpmdW5jdGlvbiBDb250cm9sc1BoaVRoZXRhKHZpZXdwb3J0LCBxdWVyeVNldCl7CiAgICB2YXIgajsKICAgIHZhciB0aGV0YTsKICAgIHZhciBwaGk7CiAgICB2YXIgdGVtcDsKCiAgICB2YXIgdE1pbiwgdE1heCwgcE1pbiwgcE1heCwgdCwgcCwgdE51bSwgcE51bSwgdE9sZCwgcE9sZDsKCiAgICB2YXIgZXBzWCA9IDAuNDsKICAgIHZhciBlcHNZID0gMC44OwoKICAgIHZhciBjYW52YXMgPSB2aWV3cG9ydC5jYW52YXM7CiAgICB2YXIgem9vbUZhY3RvciA9IDAuMTsKCiAgICB2YXIgeDA9MCwgeTA9MCwgbW9kZT0wOwoKICAgIC8vIENoZWNrIGlmIHJvdGF0aW9uIGlzIHBvc3NpYmxlCiAgICBpZihxdWVyeVNldC5wYXJhbWV0ZXJzLmhhc093blByb3BlcnR5KCd0aGV0YScpICYmIHF1ZXJ5U2V0LnBhcmFtZXRlcnMuaGFzT3duUHJvcGVydHkoJ3BoaScpKXsKICAgICAgICB0aGV0YSA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnMudGhldGE7CiAgICAgICAgcGhpID0gcXVlcnlTZXQucGFyYW1ldGVycy5waGk7CgogICAgICAgIHRNaW4gPSBJbmZpbml0eTsKICAgICAgICB0TWF4ID0gLUluZmluaXR5OwogICAgICAgIGZvcihqIGluIHRoZXRhLnZhbHVlcyl7CiAgICAgICAgICAgIHRlbXAgPSBwYXJzZUZsb2F0KHRoZXRhLnZhbHVlc1tqXSk7CiAgICAgICAgICAgIGlmKHRNaW4gPiB0ZW1wKSB0TWluID0gdGVtcDsKICAgICAgICAgICAgaWYodE1heCA8IHRlbXApIHRNYXggPSB0ZW1wOwogICAgICAgIH0KCiAgICAgICAgcE1pbiA9IEluZmluaXR5OwogICAgICAgIHBNYXggPSAtSW5maW5pdHk7CiAgICAgICAgZm9yKGogaW4gcGhpLnZhbHVlcyl7CiAgICAgICAgICAgIHRlbXAgPSBwYXJzZUZsb2F0KHBoaS52YWx1ZXNbal0pOwogICAgICAgICAgICBpZihwTWluID4gdGVtcCkgcE1pbiA9IHRlbXA7CiAgICAgICAgICAgIGlmKHBNYXggPCB0ZW1wKSBwTWF4ID0gdGVtcDsKICAgICAgICB9CgogICAgICAgIHQgPSB0aGV0YS5xdWVyeTsKICAgICAgICBwID0gcGhpLnF1ZXJ5OwogICAgICAgIHROdW0gPSBwYXJzZUZsb2F0KHQpOwogICAgICAgIHBOdW0gPSBwYXJzZUZsb2F0KHApOwogICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdVbmFibGUgdG8gY3JlYXRlIE9yYml0Q29udHJvbHM6IFF1ZXJ5U2V0IGRvZXMgbm90IGhhdmUgYSAidGhldGEiIG9yICJwaGkiIHBhcmFtZXRlcicpOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICB2YXIgb25Nb3VzZURvd24gPSBmdW5jdGlvbihlKXsKICAgICAgICBpZiAoZS53aGljaCAhPT0gMSkgcmV0dXJuOwogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICB4MCA9IGUuY2xpZW50WDsKICAgICAgICB5MCA9IGUuY2xpZW50WTsKCiAgICAgICAgbW9kZSA9IC0xOwogICAgICAgIGlmIChlLnNoaWZ0S2V5KSB7CiAgICAgICAgICAgIC8vIFBhbm5pbmcKICAgICAgICAgICAgbW9kZSA9IDE7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBSb3RhdGluZwogICAgICAgICAgICBtb2RlID0gMDsKICAgICAgICAgICAgdCA9IHRoZXRhLnF1ZXJ5OwogICAgICAgICAgICBwID0gcGhpLnF1ZXJ5OwogICAgICAgICAgICB0TnVtID0gcGFyc2VGbG9hdCh0KTsKICAgICAgICAgICAgcE51bSA9IHBhcnNlRmxvYXQocCk7CiAgICAgICAgICAgIHRPbGQgPSB0OwogICAgICAgICAgICBwT2xkID0gcDsKICAgICAgICB9CgogICAgICAgIHZpZXdwb3J0Lm9mZignbW91c2Vkb3duJywgb25Nb3VzZURvd24pOwogICAgICAgIHZpZXdwb3J0Lm9uKCdtb3VzZW1vdmUnLCBvbk1vdXNlTW92ZSk7CiAgICAgICAgdmlld3BvcnQub24oJ21vdXNlb3V0Jywgb25Nb3VzZVVwKTsKICAgICAgICB2aWV3cG9ydC5vbignbW91c2V1cCcsIG9uTW91c2VVcCk7CiAgICB9OwoKICAgIHZhciBzbmFwVG9WYWx1ZSA9IGZ1bmN0aW9uKHYsIHZhbHVlcyl7CiAgICAgICAgdmFyIG1pbiA9IEluZmluaXR5LCB0ZW1wLCB0ZW1wMiwgc25hcHBlZFZhbHVlOwogICAgICAgIGZvcih2YXIgaSBpbiB2YWx1ZXMpewogICAgICAgICAgICB0ZW1wID0gcGFyc2VGbG9hdCh2YWx1ZXNbaV0pOwogICAgICAgICAgICB0ZW1wMiA9IE1hdGguYWJzKHYtdGVtcCk7CiAgICAgICAgICAgIGlmKHRlbXAyPG1pbil7CiAgICAgICAgICAgICAgICBtaW4gPSB0ZW1wMjsKICAgICAgICAgICAgICAgIHNuYXBwZWRWYWx1ZSA9IHZhbHVlc1tpXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gc25hcHBlZFZhbHVlOwogICAgfTsKCiAgICB2YXIgb25Nb3VzZU1vdmUgPSBmdW5jdGlvbihlKXsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKCiAgICAgICAgdmFyIGR4ID0gKGUuY2xpZW50WC14MCk7CiAgICAgICAgdmFyIGR5ID0gKHkwLWUuY2xpZW50WSk7CiAgICAgICAgaWYobW9kZT09PTApewogICAgICAgICAgICAvLyBSb3RhdGUKICAgICAgICAgICAgdE51bSA9IE1hdGgubWF4KHRNaW4sIE1hdGgubWluKHRNYXgsIHROdW0gKyBkeSplcHNYKSk7CiAgICAgICAgICAgIHBOdW0gPSBNYXRoLm1heChwTWluLCBNYXRoLm1pbihwTWF4LCBwTnVtICsgZHgqZXBzWCkpOwoKICAgICAgICAgICAgdmFyIHROZXcgPSBzbmFwVG9WYWx1ZSh0TnVtLCB0aGV0YS52YWx1ZXMpOwogICAgICAgICAgICB2YXIgcE5ldyA9IHNuYXBUb1ZhbHVlKHBOdW0sIHBoaS52YWx1ZXMpOwoKICAgICAgICAgICAgaWYodE9sZCE9PXROZXcgfHwgcE9sZCE9PXBOZXcpewogICAgICAgICAgICAgICAgdE9sZCA9IHROZXc7CiAgICAgICAgICAgICAgICBwT2xkID0gcE5ldzsKICAgICAgICAgICAgICAgIHRoZXRhLnNldFZhbHVlKHROZXcpOwogICAgICAgICAgICAgICAgcGhpLnNldFZhbHVlKHBOZXcpOwogICAgICAgICAgICB9CiAgICAgICAgfWVsc2UgaWYobW9kZT09PTEpewogICAgICAgICAgICB2YXIgcG9zID0gY2FudmFzLnBvc2l0aW9uKCk7CiAgICAgICAgICAgIGNhbnZhcy5jc3MoewogICAgICAgICAgICAgICAgJ2xlZnQnOiBwb3MubGVmdCtkeCwKICAgICAgICAgICAgICAgICd0b3AnOiBwb3MudG9wLWR5CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjYW52YXMudHJpZ2dlcigndHJhbnNmb3JtZWQnLCBjYW52YXMpOwogICAgICAgIH0KICAgICAgICB4MCA9IGUuY2xpZW50WDsKICAgICAgICB5MCA9IGUuY2xpZW50WTsKCiAgICB9OwoKICAgIHZhciBvbk1vdXNlVXAgPSBmdW5jdGlvbihlKXsKICAgICAgICB2aWV3cG9ydC5vbignbW91c2Vkb3duJywgb25Nb3VzZURvd24pOwogICAgICAgIHZpZXdwb3J0Lm9mZignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpOwogICAgICAgIHZpZXdwb3J0Lm9mZignbW91c2VvdXQnLCBvbk1vdXNlVXApOwogICAgICAgIHZpZXdwb3J0Lm9mZignbW91c2V1cCcsIG9uTW91c2VVcCk7CiAgICB9OwoKICAgIHZhciBvbk1vdXNlV2hlZWwgPSBmdW5jdGlvbihlKXsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKCiAgICAgICAgLy8gWm9vbSBpbiBvdXIgb3V0CiAgICAgICAgdmFyIGRlbHRhID0gMSArIChlLm9yaWdpbmFsRXZlbnQuZGVsdGFZPDAgPyB6b29tRmFjdG9yIDogLXpvb21GYWN0b3IpOwoKICAgICAgICAvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byBjYW52YXMKICAgICAgICB2YXIgeFBvcyA9IGUucGFnZVggLSBjYW52YXMub2Zmc2V0KCkubGVmdDsKICAgICAgICB2YXIgeVBvcyA9IGUucGFnZVkgLSBjYW52YXMub2Zmc2V0KCkudG9wOwoKICAgICAgICAvLyBOb3JtYWxpemUgY3Vyc29yIHBvc2l0aW9uIHJlbGF0aXZlIHRvIGNhbnZhcwogICAgICAgIHZhciB4UmVsID0geFBvcy9jYW52YXMud2lkdGgoKTsKICAgICAgICB2YXIgeVJlbCA9IHlQb3MvY2FudmFzLmhlaWdodCgpOwoKICAgICAgICAvLyBDb21wdXRlIG5ldyBjYW52YXMgc2l6ZQogICAgICAgIHZhciBkeCA9IGRlbHRhKmNhbnZhcy53aWR0aCgpOwogICAgICAgIHZhciBkeSA9IGRlbHRhKmNhbnZhcy5oZWlnaHQoKTsKCiAgICAgICAgLy8gQ29tcHV0ZSBwcm9qZWN0aW9uIG9mIG9sZCBjdXJzb3IgcG9zaXRpb24gb24gbmV3IGNhbnZhcyBzaXplCiAgICAgICAgdmFyIHhQb3NOZXcgPSB4UmVsKmR4OwogICAgICAgIHZhciB5UG9zTmV3ID0geVJlbCpkeTsKCiAgICAgICAgdmFyIHBvcyA9IGNhbnZhcy5wb3NpdGlvbigpOwogICAgICAgIGNhbnZhcy5jc3MoewogICAgICAgICAgICAnd2lkdGgnOiBkeCwKICAgICAgICAgICAgJ2hlaWdodCc6IGR5LAogICAgICAgICAgICAnbGVmdCc6IHBvcy5sZWZ0IC0gKHhQb3NOZXcteFBvcyksCiAgICAgICAgICAgICd0b3AnOiBwb3MudG9wIC0gKHlQb3NOZXcteVBvcykKICAgICAgICB9KTsKICAgICAgICBjYW52YXMudHJpZ2dlcigndHJhbnNmb3JtZWQnLCBjYW52YXMpOwogICAgfTsKCiAgICB2aWV3cG9ydC5vbignbW91c2Vkb3duJywgb25Nb3VzZURvd24pOwogICAgdmlld3BvcnQub24oJ3doZWVsJywgb25Nb3VzZVdoZWVsKTsKICAgIHZpZXdwb3J0Lm9uKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uKGUpewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwp9CgppZighd2luZG93LkNWTElCKSB3aW5kb3cuQ1ZMSUIgPSB7fTsKd2luZG93LkNWTElCLkNvbnRyb2xzUGhpVGhldGEgPSBDb250cm9sc1BoaVRoZXRhOwoKfSkoKTsAJ3VzZSBzdHJpY3QnOyAvKiBnbG9iYWxzICQgKi8KKC8qKiBAbGVuZHMgbW9kdWxlOkNWTElCICovZnVuY3Rpb24oKXsKCi8qKgogKiBSZW5kZXJlciBmb3IgUmVzdWx0U2V0cwogKiBAY29uc3RydWN0b3IKICogQGFic3RyYWN0CiAqLwpmdW5jdGlvbiBSZW5kZXJlcigpewogICAgaWYgKHRoaXMuY29uc3RydWN0b3IgPT09IFJlbmRlcmVyKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJDYW4ndCBpbnN0YW50aWF0ZSBhYnN0cmFjdCBjbGFzcyEiKTsKICAgIH0KfQoKLyoqCiAqIFJlbmRlciBhbiBlbGVtZW50IHRvIGEgY2FudmFzCiAqIEBwYXJhbSB7b2JqZWN0fSBlbGVtZW50IC0gZWxlbWVudCBvZiBhIHJlc3VsdFNldAogKiBAcGFyYW0ge2NhbnZhc30gY2FudmFzSlEgLSBjYW52YXMgaW4gSlEgcmVwcmVzZW50YXRpb24KICovClJlbmRlcmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbihlbGVtZW50LCBjYW52YXNKUSl7CiAgICB0aHJvdyBuZXcgRXJyb3IoIkFic3RyYWN0IG1ldGhvZCEiKTsKfTsKCmlmKCF3aW5kb3cuQ1ZMSUIpIHdpbmRvdy5DVkxJQiA9IHt9Owp3aW5kb3cuQ1ZMSUIuUmVuZGVyZXIgPSBSZW5kZXJlcjsKCn0pKCk7ACd1c2Ugc3RyaWN0JzsgLyogZ2xvYmFscyAkICovCihmdW5jdGlvbigpewovKioKICogRmFjdG9yeSBmb3IgVUkgRWxlbWVudHMKICogQGV4cG9ydHMgVUlGYWN0b3J5CiAqLwp2YXIgVUlGYWN0b3J5ID0gewoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIERJViBlbGVtZW50IGNvbnRhaW5pbmcgYSBDQU5WQVMKICAgICAqIEByZXR1cm4ge2Rpdn0KICAgICAqLwogICAgY3JlYXRlVmlld3BvcnQ6IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHZhciBjYW52YXMgPSAkKCc8Y2FudmFzIGNsYXNzPSJjdmxpYl9jYW52YXMiPjwvY2FudmFzPicpOwoKICAgICAgICAgICAgdmFyIGxhYmVsID0gJCgnPGRpdiBjbGFzcz0iY3ZsaWJfbGFiZWwiPjwvZGl2PicpOwoKICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9ICQoJzxkaXYgY2xhc3M9ImN2bGliX2NhbnZhc0NvbnRhaW5lciI+PC9kaXY+Jyk7CiAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQoY2FudmFzKTsKICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZChsYWJlbCk7CgogICAgICAgICAgICAvKmNhbnZhcy5vbigncmVzaXplZCcsIGZ1bmN0aW9uKGNhbnZhcywgY29udGFpbmVyKXsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci53aWR0aChjYW52YXMud2lkdGgoKSk7CiAgICAgICAgICAgICAgICBjb250YWluZXIuaGVpZ2h0KGNhbnZhcy5oZWlnaHQoKSk7CiAgICAgICAgICAgIH0uYmluZChudWxsLCBjYW52YXMsIGNvbnRhaW5lcikpOyovCgogICAgICAgICAgICBjb250YWluZXIuY2FudmFzID0gY2FudmFzOwogICAgICAgICAgICBjb250YWluZXIubGFiZWwgPSBsYWJlbDsKCiAgICAgICAgICAgIHJldHVybiBjb250YWluZXI7CiAgICB9LAoKICAgIC8qKgogICAgICogSGVscGVyIGZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSBzeW1ib2wgZm9yIGVhY2ggcGFyYW1ldGVyIHR5cGUKICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gcGFyYW1ldGVyIG9iamVjdAogICAgICogQHJldHVybiB7c3RyaW5nfSBzeW1ib2wgaW4gaHRtbCBlbmNvZGluZwogICAgICovCiAgICBnZXRUeXBlU3ltYm9sOiBmdW5jdGlvbih0eXBlKXsKICAgICAgICBzd2l0Y2godHlwZSl7CiAgICAgICAgICAgIGNhc2UgJ3JhbmdlJzoKICAgICAgICAgICAgICAgIHJldHVybiAnJnhoYXJyOyc7CiAgICAgICAgICAgIGNhc2UgJ3NldCc6CiAgICAgICAgICAgICAgICByZXR1cm4gJyYjOTg2MzsnOwogICAgICAgICAgICBjYXNlICdib29sZWFuJzoKICAgICAgICAgICAgICAgIHJldHVybiAnJmNoZWNrOyc7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZTsKICAgICAgICB9CiAgICB9LAoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIFRSIGVsZW1lbnQgd2l0aCBtdWx0aXBsZS12YWx1ZSBpbnB1dCB3aWRnZXRzIGZvciBhIHBhcmFtZXRlcgogICAgICogQHBhcmFtIHtwYXJhbWV0ZXJ9IHAgLSBwYXJhbWV0ZXIgb2JqZWN0CiAgICAgKiBAcmV0dXJuIHt0cn0KICAgICAqLwogICAgY3JlYXRlVmFyaWFibGVSb3c6IGZ1bmN0aW9uKHApewogICAgICAgIHZhciB0ciA9ICQoJzx0ciBpZD0iY3ZsaWJfcm93XycrcC5sYWJlbC5yZXBsYWNlKCcgJywnXycpKyciIGNsYXNzPSJjdmxpYl92YXJpYWJsZVJvdyI+PC90cj4nKTsKCiAgICAgICAgLy8gQWRkIExhYmVsCiAgICAgICAgdmFyIGxhYmVsID0gJCgnPHRkPicgKyBwLmxhYmVsICsgJzwvdGQ+Jyk7CiAgICAgICAgbGFiZWwub24oJ2NsaWNrJywgZnVuY3Rpb24oKXsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5sYWJlbCwgdGhpcyk7CiAgICAgICAgfS5iaW5kKHApKTsKICAgICAgICB0ci5hcHBlbmQobGFiZWwpOwoKICAgICAgICB0ci5hcHBlbmQoJzx0ZD4nK3RoaXMuZ2V0VHlwZVN5bWJvbChwLnR5cGUpKyc8L3RkPicpOwoKICAgICAgICBzd2l0Y2ggKHAudHlwZSkgewogICAgICAgICAgICBjYXNlICdyYW5nZSc6CiAgICAgICAgICAgICAgICBpZihwLnZhbHVlcy5sZW5ndGg8Mil7CiAgICAgICAgICAgICAgICAgICAgdHIuYXBwZW5kKCc8dGQ+JytwLnZhbHVlc1swXSsnIC0gJytwLnZhbHVlc1swXSsnPC90ZD48dGQ+PC90ZD4nKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIG1pbk1heElucHV0ID0gdGhpcy5jcmVhdGVNaW5NYXhOdW1iZXJJbnB1dChwKTsKICAgICAgICAgICAgICAgICAgICB0ci5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICQoJzx0ZCBjb2xzcGFuPSIyIj48L3RkPicpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKG1pbk1heElucHV0WzBdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChtaW5NYXhJbnB1dFsxXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJyAtICcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKG1pbk1heElucHV0WzJdKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLmFwcGVuZChtaW5NYXhJbnB1dFszXSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NldCc6CiAgICAgICAgICAgICAgICBpZihwLnZhbHVlcy5sZW5ndGg8Mil7CiAgICAgICAgICAgICAgICAgICAgdHIuYXBwZW5kKCc8dGQ+JytwLnZhbHVlc1swXSsnPC90ZD48dGQ+PC90ZD4nKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdHIuYXBwZW5kKCAkKCc8dGQgY29sc3Bhbj0yPjwvdGQ+JykuYXBwZW5kKCB0aGlzLmNyZWF0ZVNldElucHV0KHApICkgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdib29sZWFuJzoKICAgICAgICAgICAgICAgIHRyLmFwcGVuZCgnPHRkPjwvdGQ+PHRkPjwvdGQ+Jyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0cjsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgVFIgZWxlbWVudCB3aXRoIG11bHRpcGxlLXZhbHVlIGlucHV0IHdpZGdldHMgZm9yIGEgcGFyYW1ldGVyCiAgICAgKiBBbGxvd3MgdGhlIHNlbGVjdGlvbiBvZiBudW0gZGlmZmVyZW50IHZhbHVlcyBvbiB0aGUgcGFyYW1ldGVyCiAgICAgKiBAcGFyYW0ge3BhcmFtZXRlcn0gcCAtIHBhcmFtZXRlciBvYmplY3QKICAgICAqIEBwYXJhbSB7aW50fSBudW0gLSBOdW1iZXIgb2Ygc2VsZWN0b3JzIHRvIGhhdmUKICAgICAqIEByZXR1cm4ge3RyfQogICAgICovCiAgICBjcmVhdGVNdWx0aVZhbHVlUm93OiBmdW5jdGlvbihwLCBudW0pIHsKICAgICAgICB2YXIgdHIgPSAkKCc8dHIgaWQ9ImN2bGliX3Jvd18nK3AubGFiZWwucmVwbGFjZSgnICcsJ18nKSsnIj48L3RyPicpOwoKICAgICAgICAvLyBBZGQgTGFiZWwKICAgICAgICB2YXIgbGFiZWwgPSAkKCc8dGQ+JyArIHAubGFiZWwgKyAnPC90ZD4nKTsKICAgICAgICB0ci5hcHBlbmQobGFiZWwpOwoKICAgICAgICB0ci5hcHBlbmQoJzx0ZD4nK3RoaXMuZ2V0VHlwZVN5bWJvbChwLnR5cGUpKyc8L3RkPicpOwoKICAgICAgICB0ci5hcHBlbmQoICQoJzx0ZCBjb2xzcGFuPTI+PC90ZD4nKS5hcHBlbmQodGhpcy5jcmVhdGVNdWx0aVZhbHVlSW5wdXQocCwgbnVtKSkpOwoKICAgICAgICByZXR1cm4gdHI7CiAgICB9LAoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIFRSIGVsZW1lbnQgd2l0aCBzaW5nbGUtdmFsdWUgaW5wdXQgd2lkZ2V0cyBmb3IgYSBwYXJhbWV0ZXIKICAgICAqIEBwYXJhbSB7cGFyYW1ldGVyfSBwIC0gcGFyYW1ldGVyIG9iamVjdAogICAgICogQHJldHVybiB7dHJ9CiAgICAgKi8KICAgIGNyZWF0ZUZpeGVkUm93OiBmdW5jdGlvbihwKXsKICAgICAgICB2YXIgdHIgPSAkKCc8dHIgaWQ9ImN2bGliX3Jvd18nK3AubGFiZWwucmVwbGFjZSgnICcsJ18nKSsnIj48L3RyPicpOwoKICAgICAgICAvLyBBZGQgTGFiZWwKICAgICAgICB2YXIgbGFiZWwgPSAkKCc8dGQ+JyArIHAubGFiZWwgKyAnPC90ZD4nKTsKICAgICAgICBsYWJlbC5vbignY2xpY2snLCBmdW5jdGlvbigpewogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmxhYmVsLCB0aGlzKTsKICAgICAgICB9LmJpbmQocCkpOwogICAgICAgIHRyLmFwcGVuZChsYWJlbCk7CgogICAgICAgIHRyLmFwcGVuZCgnPHRkPicrdGhpcy5nZXRUeXBlU3ltYm9sKHAudHlwZSkrJzwvdGQ+Jyk7CgogICAgICAgIHN3aXRjaCAocC50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ3JhbmdlJzoKICAgICAgICAgICAgICAgIGlmKHAudmFsdWVzLmxlbmd0aDwyKXsKICAgICAgICAgICAgICAgICAgICB0ci5hcHBlbmQoJzx0ZD4nK3AucXVlcnkrJzwvdGQ+PHRkPjwvdGQ+Jyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHZhciBzbGlkZXJJbnB1dCA9IHRoaXMuY3JlYXRlU2xpZGVySW5wdXQocCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIG51bWJlckxhYmVsID0gdGhpcy5jcmVhdGVOdW1iZXJMYWJlbChwKTsKICAgICAgICAgICAgICAgICAgICB0ci5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgICAgICQoJzx0ZD48L3RkPicpLmFwcGVuZChzbGlkZXJJbnB1dCksCiAgICAgICAgICAgICAgICAgICAgICAgICQoJzx0ZD48L3RkPicpLmFwcGVuZChudW1iZXJMYWJlbCkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NldCc6CiAgICAgICAgICAgICAgICBpZihwLnZhbHVlcy5sZW5ndGg8Mil7CiAgICAgICAgICAgICAgICAgICAgdHIuYXBwZW5kKCc8dGQ+JytwLnF1ZXJ5Kyc8L3RkPjx0ZD48L3RkPicpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0SW5wdXQgPSB0aGlzLmNyZWF0ZVNlbGVjdElucHV0KHApOwogICAgICAgICAgICAgICAgICAgIHRyLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICAgICAgJCgnPHRkPjwvdGQ+JykuYXBwZW5kKHNlbGVjdElucHV0KSwKICAgICAgICAgICAgICAgICAgICAgICAgJzx0ZD48L3RkPicKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICAgICAgICAgICAgdHIuYXBwZW5kKCc8dGQ+PC90ZD48dGQ+PC90ZD4nKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRyOwogICAgfSwKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBUQUJMRSBlbGVtZW50IHdpdGggY2VsbHMgY29udGFpbmluZyB2aWV3cG9ydHMgYmFzZWQgb24gYSByZXN1bHRTZXQKICAgICAqIEBwYXJhbSB7UmVzdWx0U2V0fSByZXN1bHRTZXQgLSB1c2VkIHRvIGRldGVybWluZSBtYXRyaXggc2l6ZQogICAgICogQHJldHVybiB7dGFibGV9CiAgICAgKi8KICAgIGNyZWF0ZU1hdHJpeDogZnVuY3Rpb24ocmVzdWx0U2V0KXsKICAgICAgICB2YXIgdGFibGUgPSAkKCc8dGFibGUgY2xhc3M9ImN2bGliX21hdHJpeCI+PC90YWJsZT4nKTsKICAgICAgICB2YXIgbWFwID0ge307CgogICAgICAgIGZvcih2YXIgaSBpbiByZXN1bHRTZXQuZGF0YSl7CiAgICAgICAgICAgIHZhciB0ciA9ICQoJzx0cj48L3RyPicpOwogICAgICAgICAgICBtYXBbaV0gPSB7fTsKICAgICAgICAgICAgZm9yKHZhciBqIGluIHJlc3VsdFNldC5kYXRhW2ldKXsKICAgICAgICAgICAgICAgIHZhciB2aWV3cG9ydCA9IHRoaXMuY3JlYXRlVmlld3BvcnQoKTsKICAgICAgICAgICAgICAgIC8qaWYgKCEocmVzdWx0U2V0LmRhdGFbaV1bal0uaGFzT3duUHJvcGVydHkoJ2xhYmVsJykpKQogICAgICAgICAgICAgICAgICAgIHZpZXdwb3J0LmFwcGVuZCgnPHNwYW4+KCcraSsnLCAnK2orJyk8L3NwYW4+Jyk7ICAgICovCiAgICAgICAgICAgICAgICB0ci5hcHBlbmQoICQoJzx0ZD48L3RkPicpLmFwcGVuZCh2aWV3cG9ydCkgKTsKICAgICAgICAgICAgICAgIG1hcFtpXVtqXSA9IHZpZXdwb3J0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRhYmxlLmFwcGVuZCh0cik7CiAgICAgICAgfQoKICAgICAgICB0YWJsZS52aWV3cG9ydE1hcCA9IG1hcDsKCiAgICAgICAgdGFibGUub24oJ3RyYW5zZm9ybWVkJywgZnVuY3Rpb24oZSl7CiAgICAgICAgICAgIHZhciBzdHlsZSA9IGUudGFyZ2V0LnN0eWxlOwogICAgICAgICAgICB0aGlzCiAgICAgICAgICAgICAgICAuY3NzKHsKICAgICAgICAgICAgICAgICAgICBsZWZ0OiBzdHlsZS5sZWZ0LAogICAgICAgICAgICAgICAgICAgIHRvcDogc3R5bGUudG9wLAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC53aWR0aChzdHlsZS53aWR0aCkKICAgICAgICAgICAgICAgIC5oZWlnaHQoc3R5bGUuaGVpZ2h0KTsKICAgICAgICB9LmJpbmQodGFibGUuZmluZCgnY2FudmFzJykpKTsKCiAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgfSwKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBUQUJMRSBlbGVtZW50IHdpdGggbXVsdGlwbGUtdmFsdWUgaW5wdXQgd2lkZ2V0cyBmb3IgdHdvIHBhcmFtZXRlcnMgYW5kIHNpbmdsZS12YWx1ZSB3aWRnZXRzIGZvciB0aGUgb3RoZXJzIGJhc2VkIG9uIGEgcXVlcnlTZXQKICAgICAqIEBwYXJhbSB7UXVlcnlTZXR9IHF1ZXJ5U2V0IC0gY29udGFpbnMgcGFyYW1ldGVycyB1c2VkIHRvIGdlbmVyYXRlIHRoZSB0YWJsZQogICAgICogQHJldHVybiB7dGFibGV9CiAgICAgKi8KICAgIGNyZWF0ZVZlcnN1c1F1ZXJ5VGFibGU6IGZ1bmN0aW9uKHF1ZXJ5U2V0KXsKICAgICAgICB2YXIgdGFibGUgPSB0aGlzLmNyZWF0ZVNpbXBsZVF1ZXJ5VGFibGUocXVlcnlTZXQpOwoKICAgICAgICB2YXIgcGFyYW1ldGVycyA9IE9iamVjdC5rZXlzKHF1ZXJ5U2V0LnBhcmFtZXRlcnMpOwogICAgICAgIGlmKHBhcmFtZXRlcnMubGVuZ3RoPDIpewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdDYW5ub3QgY3JlYXRlIFZlcnN1cyBUYWJsZSBmb3IgcXVlcnlTZXRzIHdpdGggbGVzcyB0aGVuIDIgcGFyYW1ldGVycy4nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIHNlbDEgPSB0aGlzLmNyZWF0ZVJhd1BhcmFtZXRlclNlbGVjdChxdWVyeVNldCk7CiAgICAgICAgc2VsMS5hdHRyKCdjbGFzcycsJ3AxX3NlbGVjdCcpOwogICAgICAgIHNlbDEub2xkVmFsdWUgPSBwYXJhbWV0ZXJzWzBdOwogICAgICAgIHNlbDEudmFsKHBhcmFtZXRlcnNbMF0pOwogICAgICAgIHZhciBzZWwyID0gdGhpcy5jcmVhdGVSYXdQYXJhbWV0ZXJTZWxlY3QocXVlcnlTZXQpOwogICAgICAgIHNlbDIuYXR0cignY2xhc3MnLCdwMl9zZWxlY3QnKTsKICAgICAgICBzZWwyLm9sZFZhbHVlID0gcGFyYW1ldGVyc1sxXTsKICAgICAgICBzZWwyLnZhbChwYXJhbWV0ZXJzWzFdKTsKCiAgICAgICAgdmFyIHVwZGF0ZVRhYmxlID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIHAxID0gc2VsMS52YWwoKTsKICAgICAgICAgICAgdmFyIHAyID0gc2VsMi52YWwoKTsKCiAgICAgICAgICAgIHZhciBvbGRQMSA9IHF1ZXJ5U2V0LmluZm8ucDE7CiAgICAgICAgICAgIHZhciBvbGRQMiA9IHF1ZXJ5U2V0LmluZm8ucDI7CgogICAgICAgICAgICBpZihwMSA9PT0gcDIpewogICAgICAgICAgICAgICAgc2VsMS52YWwob2xkUDEpOwogICAgICAgICAgICAgICAgc2VsMi52YWwob2xkUDIpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBxdWVyeVNldC5pbmZvLnAxID0gcDE7CiAgICAgICAgICAgIHF1ZXJ5U2V0LmluZm8ucDIgPSBwMjsKCiAgICAgICAgICAgIHZhciBvbGRSb3csIG5ld1JvdywgcDsKCiAgICAgICAgICAgIHZhciByZXBsYWNlVmFyaWFibGVSb3cgPSBmdW5jdGlvbihpZCl7CiAgICAgICAgICAgICAgICBvbGRSb3cgPSB0YWJsZS5maW5kKCcjY3ZsaWJfcm93XycrcXVlcnlTZXQucGFyYW1ldGVyc1tpZF0ubGFiZWwucmVwbGFjZSgnICcsJ18nKSk7CiAgICAgICAgICAgICAgICBwID0gcXVlcnlTZXQucGFyYW1ldGVyc1tpZF07CiAgICAgICAgICAgICAgICBwLnF1ZXJ5ID0gcC52YWx1ZXNbMF07CiAgICAgICAgICAgICAgICBuZXdSb3cgPSBVSUZhY3RvcnkuY3JlYXRlRml4ZWRSb3cocCk7CiAgICAgICAgICAgICAgICBvbGRSb3cuYWZ0ZXIoIG5ld1JvdyApOwogICAgICAgICAgICAgICAgb2xkUm93LnJlbW92ZSgpOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIHJlcGxhY2VGaXhlZFJvdyA9IGZ1bmN0aW9uKGlkKXsKICAgICAgICAgICAgICAgIG9sZFJvdyA9IHRhYmxlLmZpbmQoJyNjdmxpYl9yb3dfJytxdWVyeVNldC5wYXJhbWV0ZXJzW2lkXS5sYWJlbC5yZXBsYWNlKCcgJywnXycpKTsKICAgICAgICAgICAgICAgIHAgPSBxdWVyeVNldC5wYXJhbWV0ZXJzW2lkXTsKICAgICAgICAgICAgICAgIHAucXVlcnkgPSBbcC52YWx1ZXNbMF1dOwogICAgICAgICAgICAgICAgbmV3Um93ID0gVUlGYWN0b3J5LmNyZWF0ZVZhcmlhYmxlUm93KHApOwogICAgICAgICAgICAgICAgb2xkUm93LmFmdGVyKCBuZXdSb3cgKTsKICAgICAgICAgICAgICAgIG9sZFJvdy5yZW1vdmUoKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGlmKG9sZFAxICE9PSBwMSl7CiAgICAgICAgICAgICAgICBpZihvbGRQMSkgcmVwbGFjZVZhcmlhYmxlUm93KG9sZFAxKTsKICAgICAgICAgICAgICAgIHJlcGxhY2VGaXhlZFJvdyhwMSk7CiAgICAgICAgICAgICAgICB0YWJsZS50cmlnZ2VyKCdyZXNpemVkJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYob2xkUDIgIT09IHAyKXsKICAgICAgICAgICAgICAgIGlmKG9sZFAyKSByZXBsYWNlVmFyaWFibGVSb3cob2xkUDIpOwogICAgICAgICAgICAgICAgcmVwbGFjZUZpeGVkUm93KHAyKTsKICAgICAgICAgICAgICAgIHRhYmxlLnRyaWdnZXIoJ3Jlc2l6ZWQnKTsKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIHNlbDEub24oJ2NoYW5nZScsIHVwZGF0ZVRhYmxlKTsKICAgICAgICBzZWwyLm9uKCdjaGFuZ2UnLCB1cGRhdGVUYWJsZSk7CgogICAgICAgIHRhYmxlLnByZXBlbmQoCiAgICAgICAgICAgICQoJzx0cj48L3RyPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICQoJzx0ZCBjb2xzcGFuPTQ+PC90ZD4nKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHNlbDEpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoJyBWUyAnKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKHNlbDIpCiAgICAgICAgICAgICAgICApCiAgICAgICAgKTsKCiAgICAgICAgcXVlcnlTZXQuaW5mbyA9IHsKICAgICAgICAgICAgdHlwZTogJ21hdHJpeCcsCiAgICAgICAgICAgIHAxOiBudWxsLAogICAgICAgICAgICBwMjogbnVsbCwKICAgICAgICB9OwoKICAgICAgICB1cGRhdGVUYWJsZSgpOwoKICAgICAgICByZXR1cm4gdGFibGU7CiAgICB9LAoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIFRBQkxFIGVsZW1lbnQgd2l0aCBtdWx0aXBsZS12YWx1ZSBpbnB1dCB3aWRnZXRzIGZvciBvbmUgcGFyYW1ldGVyIGFuZCBzaW5nbGUtdmFsdWUgd2lkZ2V0cyBmb3IgdGhlIG90aGVycyBiYXNlZCBvbiBhIHF1ZXJ5U2V0CiAgICAgKiBAcGFyYW0ge1F1ZXJ5U2V0fSBxdWVyeVNldCAtIGNvbnRhaW5zIHBhcmFtZXRlcnMgdXNlZCB0byBnZW5lcmF0ZSB0aGUgdGFibGUKICAgICAqIEBwYXJhbSB7aW50fSBudW0gLSBUaGUgbnVtYmVyIG9mIHZhbHVlcyB0aGF0IGNhbiBiZSBzZWxlY3RlZCBmb3IgdGhlIG11bHRpcGxlLXZhbHVlIGlucHV0CiAgICAgKiBAcmV0dXJuIHt0YWJsZX0KICAgICAqLwogICAgY3JlYXRlQ29tcGFyZVF1ZXJ5VGFibGU6IGZ1bmN0aW9uKHF1ZXJ5U2V0LCBudW0pewogICAgICAgIHZhciB0YWJsZSA9IHRoaXMuY3JlYXRlU2ltcGxlUXVlcnlUYWJsZShxdWVyeVNldCk7CgogICAgICAgIHZhciBwYXJhbWV0ZXJzID0gT2JqZWN0LmtleXMocXVlcnlTZXQucGFyYW1ldGVycyk7CgogICAgICAgIHZhciBzZWwgPSB0aGlzLmNyZWF0ZVJhd1BhcmFtZXRlclNlbGVjdChxdWVyeVNldCk7CiAgICAgICAgc2VsLmF0dHIoJ2NsYXNzJywncF9zZWxlY3QnKTsKICAgICAgICBzZWwudmFsKHBhcmFtZXRlcnNbMF0pOwoKICAgICAgICB2YXIgdXBkYXRlVGFibGUgPSBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgc2VsZWN0ZWRQID0gc2VsLnZhbCgpOwogICAgICAgICAgICB2YXIgb2xkUCA9IHF1ZXJ5U2V0LmluZm8ucDsKCiAgICAgICAgICAgIHF1ZXJ5U2V0LmluZm8ucCA9IHNlbGVjdGVkUDsKCiAgICAgICAgICAgIHZhciBvbGRSb3csIG5ld1JvdywgcDsKCiAgICAgICAgICAgIHZhciByZXBsYWNlTXVsdGlWYWx1ZVJvdyA9IGZ1bmN0aW9uKGlkKXsKICAgICAgICAgICAgICAgIG9sZFJvdyA9IHRhYmxlLmZpbmQoJyNjdmxpYl9yb3dfJytxdWVyeVNldC5wYXJhbWV0ZXJzW2lkXS5sYWJlbC5yZXBsYWNlKCcgJywnXycpKTsKICAgICAgICAgICAgICAgIHAgPSBxdWVyeVNldC5wYXJhbWV0ZXJzW2lkXTsKICAgICAgICAgICAgICAgIHAucXVlcnkgPSBwLnZhbHVlc1swXTsKICAgICAgICAgICAgICAgIG5ld1JvdyA9IFVJRmFjdG9yeS5jcmVhdGVGaXhlZFJvdyhwKTsKICAgICAgICAgICAgICAgIG9sZFJvdy5hZnRlciggbmV3Um93ICk7CiAgICAgICAgICAgICAgICBvbGRSb3cucmVtb3ZlKCk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgcmVwbGFjZUZpeGVkUm93ID0gZnVuY3Rpb24oaWQpewogICAgICAgICAgICAgICAgb2xkUm93ID0gdGFibGUuZmluZCgnI2N2bGliX3Jvd18nK3F1ZXJ5U2V0LnBhcmFtZXRlcnNbaWRdLmxhYmVsLnJlcGxhY2UoJyAnLCdfJykpOwogICAgICAgICAgICAgICAgcCA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnNbaWRdOwogICAgICAgICAgICAgICAgcC5xdWVyeSA9IFtwLnZhbHVlc1swXV07CiAgICAgICAgICAgICAgICBuZXdSb3cgPSBVSUZhY3RvcnkuY3JlYXRlTXVsdGlWYWx1ZVJvdyhwLCBudW0pOwogICAgICAgICAgICAgICAgb2xkUm93LmFmdGVyKCBuZXdSb3cgKTsKICAgICAgICAgICAgICAgIG9sZFJvdy5yZW1vdmUoKTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGlmKG9sZFAgIT09IHNlbGVjdGVkUCl7CiAgICAgICAgICAgICAgICBpZihvbGRQKSByZXBsYWNlTXVsdGlWYWx1ZVJvdyhvbGRQKTsKICAgICAgICAgICAgICAgIHJlcGxhY2VGaXhlZFJvdyhzZWxlY3RlZFApOwogICAgICAgICAgICAgICAgdGFibGUudHJpZ2dlcigncmVzaXplZCcpOwoKICAgICAgICAgICAgICAgIGlmIChvbGRQKSB7CiAgICAgICAgICAgICAgICAgICAgcXVlcnlTZXQucGFyYW1ldGVyc1tvbGRQXS5lbWl0dGVyLnRyaWdnZXIoJ2NoYW5nZScsIHF1ZXJ5U2V0LnBhcmFtZXRlcnNbb2xkUF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgc2VsLm9uKCdjaGFuZ2UnLCB1cGRhdGVUYWJsZSk7CgogICAgICAgIHRhYmxlLnByZXBlbmQoCiAgICAgICAgICAgICQoJzx0cj48L3RyPicpCiAgICAgICAgICAgICAgICAuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICQoJzx0ZCBjb2xzcGFuPTQ+PC90ZD4nKQogICAgICAgICAgICAgICAgICAgICAgICAuYXBwZW5kKCJDb21wYXJlICIpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoc2VsKQogICAgICAgICAgICAgICAgKQogICAgICAgICk7CgogICAgICAgIHF1ZXJ5U2V0LmluZm8gPSB7CiAgICAgICAgICAgIHR5cGU6ICdjb21wYXJlJywKICAgICAgICAgICAgcDogbnVsbAogICAgICAgIH07CgogICAgICAgIHVwZGF0ZVRhYmxlKCk7CgogICAgICAgIHJldHVybiB0YWJsZTsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgVEFCTEUgZWxlbWVudCB3aXRoIG11bHRpcGxlLXZhbHVlIGlucHV0IHdpZGdldHMgZm9yIGFsbCBwYXJhbWV0ZXJzCiAgICAgKiBAcGFyYW0ge1F1ZXJ5U2V0fSBxdWVyeVNldCAtIEl0cyBwYXJhbWV0ZXJzIHdpbGwgYmUgdGhlIHRhcmdldHMgb2YgdGhlIGlucHV0IHdpZGdldHMKICAgICAqIEByZXR1cm4ge3RhYmxlfQogICAgICovCiAgICBjcmVhdGVTZWFyY2hRdWVyeVRhYmxlOiBmdW5jdGlvbihxdWVyeVNldCkgewogICAgICAgIHZhciB0ciwgdGFibGUgPSAkKCc8dGFibGUgY2xhc3M9ImN2bGliX3F1ZXJ5VGFibGUiPjwvdGFibGU+Jyk7CgogICAgICAgIHZhciBwLGk7CiAgICAgICAgZm9yIChpIGluIHF1ZXJ5U2V0LnBhcmFtZXRlcnMpIHsKICAgICAgICAgICAgcCA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnNbaV07CiAgICAgICAgICAgIHAucXVlcnkgPSBbcC52YWx1ZXNbMF1dOwogICAgICAgICAgICB0YWJsZS5hcHBlbmQodGhpcy5jcmVhdGVWYXJpYWJsZVJvdyhwKSk7CiAgICAgICAgfQoKICAgICAgICB0YWJsZS5wcmVwZW5kKAogICAgICAgICAgICAkKCc8dHI+PC90cj4nKS5hcHBlbmQoJzx0ZCBjb2xzcGFuPTQ+PC90ZD4nKQogICAgICAgICk7CgogICAgICAgIHF1ZXJ5U2V0LmluZm8gPSB7dHlwZSA6ICdzZWFyY2gnfTsKCiAgICAgICAgcmV0dXJuIHRhYmxlOwogICAgfSwKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBUQUJMRSBlbGVtZW50IHdpdGggc2luZ2xlLXZhbHVlIGlucHV0IHdpZGdldHMgYmFzZWQgb24gYSBxdWVyeVNldAogICAgICogQHBhcmFtIHtRdWVyeVNldH0gcXVlcnlTZXQgLSBpdHMgcGFyYW1ldGVycyB3aWxsIGJlIHRoZSB0YXJnZXRzIG9mIHRoZSBpbnB1dCB3aWRnZXRzCiAgICAgKiBAcmV0dXJuIHt0YWJsZX0KICAgICAqLwogICAgY3JlYXRlU2ltcGxlUXVlcnlUYWJsZTogZnVuY3Rpb24ocXVlcnlTZXQpewogICAgICAgIHZhciB0ciwgdGFibGUgPSAkKCc8dGFibGUgY2xhc3M9ImN2bGliX3F1ZXJ5VGFibGUiPjwvdGFibGU+Jyk7CgogICAgICAgIHZhciBwLGk7CiAgICAgICAgZm9yKGkgaW4gcXVlcnlTZXQucGFyYW1ldGVycyl7CiAgICAgICAgICAgIHAgPSBxdWVyeVNldC5wYXJhbWV0ZXJzW2ldOwogICAgICAgICAgICB0YWJsZS5hcHBlbmQoIHRoaXMuY3JlYXRlRml4ZWRSb3cocCkgKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiB0YWJsZTsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgRElWIGVsZW1lbnQgd2l0aCBhIHNlYXJjaEJhciBhbmQgbWVzc2FnZSB0byBlbnRlciB0ZXh0IHRvIHNlYXJjaCBxdWVyeVNldAogICAgICogQHBhcmFtIHtRdWVyeVNldH0gcXVlcnlTZXQKICAgICAqIEByZXR1cm4ge2Rpdn0KICAgICAqLwogICAgY3JlYXRlU2VhcmNoQmFyOiBmdW5jdGlvbihxdWVyeVNldCkgewogICAgICAgIHZhciBzZWFyY2hDb250YWluZXIgPSAkKCc8ZGl2IGNsYXNzPSJjdmxpYl9zZWFyY2hDb250YWluZXIiPjwvZGl2PicpOwogICAgICAgIHZhciBzZWFyY2hCYXIgPSAkKCc8aW5wdXQgdHlwZT0idGV4dCIgY2xhc3M9ImN2bGliX3NlYXJjaEJhciI+PC9kaXY+Jyk7CiAgICAgICAgdmFyIHNlYXJjaE1lc3NhZ2UgPSAkKCc8ZGl2IGNsYXNzPSJjdmxpYl9zZWFyY2hNZXNzYWdlIj48L2Rpdj4nKTsKCiAgICAgICAgc2VhcmNoQ29udGFpbmVyLmFwcGVuZChzZWFyY2hCYXIpOwogICAgICAgIHNlYXJjaENvbnRhaW5lci5hcHBlbmQoc2VhcmNoTWVzc2FnZSk7CgogICAgICAgIHNlYXJjaENvbnRhaW5lci5iYXIgPSBzZWFyY2hCYXI7CiAgICAgICAgc2VhcmNoQ29udGFpbmVyLm1lc3NhZ2UgPSBzZWFyY2hNZXNzYWdlOwoKICAgICAgICAvL1BhcnNlIHRleHQgaW4gc2VhcmNoIGJhciBhbmQgc2V0IHBhcmFtZXRlciBxdWVyaWVzIGFjY29yZGluZ2x5CiAgICAgICAgdmFyIHVwZGF0ZVNlYXJjaCA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICAvL1Jlc2V0IHBhcmFtZXRlciBxdWVyaWVzCiAgICAgICAgICAgIHZhciB1c2VkUGFyYW1zID0ge307IC8va2VlcHMgdHJhY2sgb2Ygd2hpY2ggcGFyYW1ldGVycyBoYXZlIGJlZW4gc3BlY2lmaWVkIGluIHRoZSBzZWFyY2gKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBxdWVyeVNldC5wYXJhbWV0ZXJzKSB7CiAgICAgICAgICAgICAgICBwID0gcXVlcnlTZXQucGFyYW1ldGVyc1tpXTsKICAgICAgICAgICAgICAgIHAucXVlcnkgPSB7fTsKICAgICAgICAgICAgICAgIHVzZWRQYXJhbXNbcC5sYWJlbF0gPSBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHNlYXJjaEJhci52YWwoKS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIHNlYXJjaE1lc3NhZ2UudGV4dCgnUGxlYXNlIGVudGVyIHNlYXJjaCB0ZXJtcyBzZXBhcmF0ZWQgYnkgYSBzZW1pY29sb24gXCc7XCcuJyk7CiAgICAgICAgICAgICAgICBzZWFyY2hNZXNzYWdlLmF0dHIoJ21vZGUnLCAnd2FpdGluZycpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vU3BsaXQgaW50byBzZWFyY2ggdGVybXMgYW5kIHBhcnNlIG9uZS1ieS1vbmUKICAgICAgICAgICAgdmFyIHRlcm1zID0gc2VhcmNoQmFyLnZhbCgpLnNwbGl0KCc7Jyk7CiAgICAgICAgICAgIGZvciAodmFyIHRlcm0gaW4gdGVybXMpIHsKICAgICAgICAgICAgICAgIHRlcm0gPSB0ZXJtc1t0ZXJtXTsKICAgICAgICAgICAgICAgIHRlcm0gPSB0ZXJtLnRyaW0oKTsKICAgICAgICAgICAgICAgIC8vUGFyc2UgcGFyYW1ldGVyCiAgICAgICAgICAgICAgICB2YXIgZm91bmRQYXJhbSA9IG51bGw7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHF1ZXJ5U2V0LnBhcmFtZXRlcnMpIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGVybS5zdGFydHNXaXRoKHF1ZXJ5U2V0LnBhcmFtZXRlcnNbaV0ubGFiZWwpKQogICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFBhcmFtID0gcXVlcnlTZXQucGFyYW1ldGVyc1tpXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICghZm91bmRQYXJhbSkgeyAvL0Vycm9yIG1lc3NhZ2UgaWYgdGV4dCBkb2VzIG5vdCBtYXRjaCBhbnkgcGFyYW1ldGVycwogICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gIlVucmVjb2duaXplZCBwYXJhbWV0ZXIuIEFsbG93ZWQgdmFsdWVzIGFyZTogIjsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHF1ZXJ5U2V0LnBhcmFtZXRlcnMpCiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gKCJcJyIrcXVlcnlTZXQucGFyYW1ldGVyc1tpXS5sYWJlbCsiXCcsICIpOwogICAgICAgICAgICAgICAgICAgIHNlYXJjaE1lc3NhZ2UudGV4dChtZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICBzZWFyY2hNZXNzYWdlLmF0dHIoJ21vZGUnLCAnZXJyb3InKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB1c2VkUGFyYW1zW2ZvdW5kUGFyYW0ubGFiZWxdID0gdHJ1ZTsKICAgICAgICAgICAgICAgIC8vUGFyc2Ugb3BlcmF0b3IgYW5kIHZhbHVlcwogICAgICAgICAgICAgICAgdGVybSA9IHRlcm0uc3Vic3RyaW5nKGZvdW5kUGFyYW0ubGFiZWwubGVuZ3RoLHRlcm0ubGVuZ3RoKTsKICAgICAgICAgICAgICAgIHRlcm0gPSB0ZXJtLnRyaW0oKTsKICAgICAgICAgICAgICAgIHZhciBvcGVyYXRvciA9IHRlcm0uc3Vic3RyKDAsMik7IC8vb3BlcmF0b3IgaXMgYWx3YXlzIHR3byBjaGFyYWN0ZXJzCiAgICAgICAgICAgICAgICB0ZXJtID0gdGVybS5zdWJzdHJpbmcoMix0ZXJtLmxlbmd0aCk7CiAgICAgICAgICAgICAgICB0ZXJtID0gdGVybS50cmltKCk7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKG9wZXJhdG9yKSB7CiAgICAgICAgICAgICAgICAgICAgLy9FcXVhbHMuIEl0ZXJhdGVzIHRocm91Z2ggY29tbWEgc2VwYXJhdGVkIHZhbHVlcyBhbmQgYWRkcyB0aGVtIHRvIHRoZSBwYXJhbWV0ZXIncyBxdWVyeQogICAgICAgICAgICAgICAgICAgIGNhc2UgJz09JyA6CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXMgPSB0ZXJtLnNwbGl0KCcsJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZXNDb3VudCA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vSXRlcmF0ZSB0aHJvdWdoIGxpc3RlZCB2YWx1ZXMKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgdmFsIGluIHZhbHVlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsID0gdmFsdWVzW3ZhbF07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWwgPSB2YWwudHJpbSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kVmFsID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0l0ZXJhdGUgdGhyb3VnaCBwYXJhbWV0ZXIgdmFsdWVzIHVudGlsIG9uZSBtYXRjaGluZyB0aGUgdGV4dCBpcyBmb3VuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBmb3VuZFBhcmFtLnZhbHVlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPT0gZm91bmRQYXJhbS52YWx1ZXNbaV0udG9TdHJpbmcoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFBhcmFtLnF1ZXJ5W3ZhbHVlc0NvdW50XSA9IGZvdW5kUGFyYW0udmFsdWVzW2ldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZXNDb3VudCsrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFZhbCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFmb3VuZFZhbCkgeyAvL0Vycm9yIGlmIG5vIG1hdGNoaW5nIHZhbHVlIGlzIGZvdW5kCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAiVW5yZWNvZ25pemVkIHZhbHVlOiBcJyIrdmFsKyJcJy4gQWxsb3dlZCB2YWx1ZXMgYXJlOiAiOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZm91bmRQYXJhbS52YWx1ZXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gKCJcJyIrZm91bmRQYXJhbS52YWx1ZXNbaV0rIlwnLCAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlICs9ICgiKGNvbW1hIHNlcGFyYXRlZCkiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hNZXNzYWdlLnRleHQobWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoTWVzc2FnZS5hdHRyKCdtb2RlJywgJ2Vycm9yJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIC8vR3JlYXRlciB0aGFuLiBBZGRzIGdpdmVuIHZhbHVlIGFuZCBhbGwgdmFsdWVzIGFmdGVyIGl0IHRvIHBhcmFtZXRlcidzIHF1ZXJ5CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnPj0nIDoKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kVmFsID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvdW5kVmFsSW5kZXg7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vSXRlcmF0ZSB0aHJvdWdoIHBhcmFtZXRlciB2YWx1ZXMgdW50aWwgb25lIG1hdGNoaW5nIHRoZSB0ZXh0IGlzIGZvdW5kCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZm91bmRQYXJhbS52YWx1ZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0ZXJtID09IGZvdW5kUGFyYW0udmFsdWVzW2ldLnRvU3RyaW5nKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFZhbCA9IGZvdW5kUGFyYW0udmFsdWVzW2ldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kVmFsSW5kZXggPSBpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmb3VuZFZhbCA9PSBudWxsKSB7IC8vRXJyb3IgaWYgbm8gbWF0Y2hpbmcgdmFsdWUgaXMgZm91bmQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gIlVucmVjb2duaXplZCB2YWx1ZTogXCciK3Rlcm0rIlwnLiBBbGxvd2VkIHZhbHVlcyBhcmU6ICI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIGZvdW5kUGFyYW0udmFsdWVzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgKz0gKCJcJyIrZm91bmRQYXJhbS52YWx1ZXNbaV0rIlwnLCAiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaE1lc3NhZ2UudGV4dChtZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaE1lc3NhZ2UuYXR0cignbW9kZScsICdlcnJvcicpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIC8vQWRkIHRvIHF1ZXJ5CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBxdWVyeSA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gZm91bmRQYXJhbS52YWx1ZXMubGVuZ3RoLTE7IGkgPj0gZm91bmRWYWxJbmRleDsgaS0tKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcXVlcnkucHVzaChmb3VuZFBhcmFtLnZhbHVlc1tpXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kUGFyYW0uc2V0VmFsdWUocXVlcnkpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAvL0xlc3MgdGhhbi4gQWRkcyBnaXZlbiB2YWx1ZSBhbmQgYWxsIHZhbHVlcyBiZWZvcmUgaXQgdG8gcGFyYW1ldGVyJ3MgcXVlcnkKICAgICAgICAgICAgICAgICAgICBjYXNlICc8PScgOgogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmRWYWwgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZm91bmRWYWxJbmRleDsKICAgICAgICAgICAgICAgICAgICAgICAgLy9JdGVyYXRlIHRocm91Z2ggcGFyYW1ldGVyIHZhbHVlcyB1bnRpbCBvbmUgbWF0Y2hpbmcgdGhlIHRleHQgaXMgZm91bmQKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBmb3VuZFBhcmFtLnZhbHVlcykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRlcm0gPT0gZm91bmRQYXJhbS52YWx1ZXNbaV0udG9TdHJpbmcoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvdW5kVmFsID0gZm91bmRQYXJhbS52YWx1ZXNbaV07CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm91bmRWYWxJbmRleCA9IGk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kVmFsID09IG51bGwpIHsgLy9FcnJvciBpZiBubyBtYXRjaGluZyB2YWx1ZSBpcyBmb3VuZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAiVW5yZWNvZ25pemVkIHZhbHVlOiBcJyIrdGVybSsiXCcuIEFsbG93ZWQgdmFsdWVzIGFyZTogIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZm91bmRQYXJhbS52YWx1ZXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSArPSAoIlwnIitmb3VuZFBhcmFtLnZhbHVlc1tpXSsiXCcsICIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoTWVzc2FnZS50ZXh0KG1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoTWVzc2FnZS5hdHRyKCdtb2RlJywgJ2Vycm9yJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy9BZGQgdG8gcXVlcnkKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHF1ZXJ5ID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IGZvdW5kVmFsSW5kZXg7IGkrKykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHF1ZXJ5LnB1c2goZm91bmRQYXJhbS52YWx1ZXNbaV0pOwogICAgICAgICAgICAgICAgICAgICAgICBmb3VuZFBhcmFtLnNldFZhbHVlKHF1ZXJ5KTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoTWVzc2FnZS50ZXh0KCJVbnJlY29nbml6ZWQgb3BlcmF0b3I6IFwnIitvcGVyYXRvcisiXCcuIEFsbG93ZWQgdmFsdWVzIGFyZTogXCc9PVwnLCBcJz49XCcsIFwnPD1cJyIpOwogICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2hNZXNzYWdlLmF0dHIoJ21vZGUnLCAnZXJyb3InKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9IC8vRW5kIHN3aXRjaAogICAgICAgICAgICB9IC8vRW5kIGZvciBsb29wICh0ZXJtcykKICAgICAgICAgICAgLy9GaWxsIHF1ZXJpZXMgZm9yIHVuc3BlY2lmaWVkIHBhcmFtZXRlcnMKICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBxdWVyeVNldC5wYXJhbWV0ZXJzKSB7CiAgICAgICAgICAgICAgICB2YXIgcCA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnNbaV07CiAgICAgICAgICAgICAgICBpZiAoIXVzZWRQYXJhbXNbcC5sYWJlbF0pIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqIGluIHAudmFsdWVzKQogICAgICAgICAgICAgICAgICAgICAgICBwLnF1ZXJ5W2pdID0gcC52YWx1ZXNbal07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9Fc3RpbWF0ZSBudW1iZXIgb2YgcmVzdWx0cwogICAgICAgICAgICAgICAgdmFyIHJlc3VsdHNDb3VudCA9IDE7CiAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIHF1ZXJ5U2V0LnBhcmFtZXRlcnMpCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0c0NvdW50ICo9IE9iamVjdC5rZXlzKHF1ZXJ5U2V0LnBhcmFtZXRlcnNbaV0ucXVlcnkpLmxlbmd0aDsKICAgICAgICAgICAgICAgIHNlYXJjaE1lc3NhZ2UudGV4dCgiRXN0aW1hdGVkIG51bWJlciBvZiByZXN1bHRzOiAiICsgcmVzdWx0c0NvdW50KTsKICAgICAgICAgICAgICAgIHNlYXJjaE1lc3NhZ2UuYXR0cignbW9kZScsICd2YWxpZCcpOwogICAgICAgIH07IC8vRW5kIHVwZGF0ZVNlYXJjaAoKICAgICAgICBxdWVyeVNldC5pbmZvID0ge3R5cGUgOiAnc2VhcmNoJ307CgogICAgICAgIHNlYXJjaEJhci5vbignaW5wdXQnLCB1cGRhdGVTZWFyY2gpOwoKICAgICAgICB1cGRhdGVTZWFyY2goKTsKCiAgICAgICAgcmV0dXJuIHNlYXJjaENvbnRhaW5lcjsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgbnVtYmVyIGxhYmVsIGVsZW1lbnQgZm9yIGEgcGFyYW1ldGVyCiAgICAgKiBAcGFyYW0ge3BhcmFtZXRlcn0gcCAtIHRhcmdldCBvZiB0aGUgaW5wdXQgd2lkZ2V0CiAgICAgKiBAcmV0dXJuIHtpbnB1dH0KICAgICAqLwogICAgY3JlYXRlTnVtYmVyTGFiZWw6IGZ1bmN0aW9uKHApIHsKICAgICAgICB2YXIgbGFiZWwgPSAkKCc8c3BhbiBjbGFzcz0iY3ZsaWJfbnVtYmVyTGFiZWwiPicrcC5xdWVyeSsnPC9zcGFuPicpOwogICAgICAgIGxhYmVsLm9sZFZhbHVlID0gcC5xdWVyeTsKCiAgICAgICAgcC5lbWl0dGVyLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihpbnB1dCwgZSwgcCkgewogICAgICAgICAgICBpbnB1dC5vbGRWYWx1ZSA9IHAucXVlcnk7CiAgICAgICAgICAgIGlucHV0LnRleHQocC5xdWVyeSk7CiAgICAgICAgfS5iaW5kKG51bGwsIGxhYmVsKSk7CgogICAgICAgIHJldHVybiBsYWJlbDsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgcmFuZ2UgSU5QVVQgZWxlbWVudCBmb3IgYSBtaW4sIG1heCwgYW5kIGRlZmF1bHQgdmFsdWUKICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtaW4gLSBtaW4KICAgICAqIEBwYXJhbSB7bnVtYmVyfSBtYXggLSBtYXgKICAgICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZSAtIGRlZmF1bHQgdmFsdWUKICAgICAqIEByZXR1cm4ge2lucHV0fQogICAgICovCiAgICBjcmVhdGVSYXdTbGlkZXJJbnB1dDogZnVuY3Rpb24obWluLCBtYXgsIHZhbHVlKXsKICAgICAgICByZXR1cm4gJCgnPGlucHV0IHR5cGU9InJhbmdlIiAgbWluPSInK21pbisnIiBtYXg9IicrbWF4KyciIHZhbHVlPSInK3ZhbHVlKyciPicpOwogICAgfSwKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSByYW5nZSBJTlBVVCBlbGVtZW50IGZvciBhIHBhcmFtZXRlcgogICAgICogQHBhcmFtIHtwYXJhbWV0ZXJ9IHAgLSB0YXJnZXQgb2YgdGhlIGlucHV0IHdpZGdldAogICAgICogQHJldHVybiB7aW5wdXR9CiAgICAgKi8KICAgIGNyZWF0ZVNsaWRlcklucHV0OiBmdW5jdGlvbihwKSB7CiAgICAgICAgdmFyIGlucHV0ID0gdGhpcy5jcmVhdGVSYXdTbGlkZXJJbnB1dCgwLCBwLnZhbHVlcy5sZW5ndGgtMSwgcC52YWx1ZXMuaW5kZXhPZihwLnF1ZXJ5KSk7CgogICAgICAgIHAuZW1pdHRlci5vbignY2hhbmdlJywgZnVuY3Rpb24oaW5wdXQsIGUsIHApewogICAgICAgICAgICBpbnB1dC52YWwoIHBhcnNlSW50KHAudmFsdWVzLmluZGV4T2YocC5xdWVyeSkpICk7CiAgICAgICAgfS5iaW5kKG51bGwsIGlucHV0KSk7CgogICAgICAgIGlucHV0Lm9uKCdpbnB1dCcsIGZ1bmN0aW9uKGlucHV0LCBwKXsKICAgICAgICAgICAgcC5zZXRWYWx1ZSggcC52YWx1ZXNbaW5wdXQudmFsKCldICk7CiAgICAgICAgfS5iaW5kKG51bGwsIGlucHV0LCBwKSk7CgogICAgICAgIHJldHVybiBpbnB1dDsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgU0VMRUNUIGVsZW1lbnQgZm9yIGEgc2V0IG9mIGxhYmVscyBhbmQgdmFsdWVzCiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSBsYWJlbHMKICAgICAqIEBwYXJhbSB7b2JqZWN0W119IHZhbHVlcwogICAgICogQHJldHVybiB7c2VsZWN0fQogICAgICovCiAgICBjcmVhdGVSYXdTZWxlY3RJbnB1dDogZnVuY3Rpb24obGFiZWxzLCB2YWx1ZXMpewogICAgICAgIHZhciBzZWxlY3QgPSAkKCc8c2VsZWN0Pjwvc2VsZWN0PicpOwogICAgICAgIGZvcih2YXIgaSBpbiBsYWJlbHMpCiAgICAgICAgICAgIHNlbGVjdC5hcHBlbmQoJzxvcHRpb24nKyAodmFsdWVzID8gJyB2YWx1ZT0iJyt2YWx1ZXNbaV0rJyInIDogJycpICsnPicrbGFiZWxzW2ldKyc8L29wdGlvbj4nKTsKCiAgICAgICAgcmV0dXJuIHNlbGVjdDsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgU0VMRUNUIGVsZW1lbnQgZm9yIHNlbGVjdGluZyBhIHBhcmFtZXRlciBvZiB0aGUgZ2l2ZW4gcXVlcnlTZXQKICAgICAqIEBwYXJhbSB7cXVlcnlTZXR9IHF1ZXJ5U2V0CiAgICAgKiBAcmV0dXJuIHtzZWxlY3R9CiAgICAgKi8KICAgIGNyZWF0ZVJhd1BhcmFtZXRlclNlbGVjdDogZnVuY3Rpb24ocXVlcnlTZXQpIHsKICAgICAgICB2YXIga2V5cyA9IFtdOwogICAgICAgIHZhciBsYWJlbHMgPSBbXTsKICAgICAgICBmb3IgKHZhciBwIGluIHF1ZXJ5U2V0LnBhcmFtZXRlcnMpIHsKICAgICAgICAgICAga2V5cy5wdXNoKHApCiAgICAgICAgICAgIGxhYmVscy5wdXNoKHF1ZXJ5U2V0LnBhcmFtZXRlcnNbcF0ubGFiZWwpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVSYXdTZWxlY3RJbnB1dChsYWJlbHMsa2V5cyk7CiAgICB9LAoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIFNFTEVDVCBlbGVtZW50IGZvciBhIHBhcmFtZXRlcgogICAgICogQHBhcmFtIHtwYXJhbWV0ZXJ9IHAgLSB0YXJnZXQgb2YgdGhlIGlucHV0IHdpZGdldAogICAgICogQHJldHVybiB7aW5wdXR9CiAgICAgKi8KICAgIGNyZWF0ZVNlbGVjdElucHV0OiBmdW5jdGlvbihwKXsKICAgICAgICB2YXIgc2VsZWN0ID0gdGhpcy5jcmVhdGVSYXdTZWxlY3RJbnB1dChwLnZhbHVlcyk7CgogICAgICAgIHAuZW1pdHRlci5vbignY2hhbmdlJywgZnVuY3Rpb24oc2VsZWN0LCBlLCBwKXsKICAgICAgICAgICAgc2VsZWN0LnZhbChwLnF1ZXJ5KTsKICAgICAgICB9LmJpbmQobnVsbCwgc2VsZWN0KSk7CgogICAgICAgIHNlbGVjdC5vbignY2hhbmdlJywgZnVuY3Rpb24oc2VsZWN0LCBwKXsKICAgICAgICAgICAgcC5zZXRWYWx1ZShzZWxlY3QudmFsKCkpOwogICAgICAgIH0uYmluZChudWxsLCBzZWxlY3QsIHApKTsKCiAgICAgICAgcmV0dXJuIHNlbGVjdDsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgY2hlY2tib3ggSU5QVVQgZWxlbWVudAogICAgICogQHBhcmFtIHtib29sfSBjaGVja2VkIC0gZGVmYXVsdAogICAgICogQHJldHVybiB7aW5wdXR9CiAgICAgKi8KICAgIGNyZWF0ZVJhd0NoZWNrYm94SW5wdXQ6IGZ1bmN0aW9uKGNoZWNrZWQpewogICAgICAgIHJldHVybiAkKCc8aW5wdXQgdHlwZT0iY2hlY2tib3giICcgKyAoY2hlY2tlZCA/ICdjaGVja2VkJyA6ICcnKSArICc+Jyk7CiAgICB9LAoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIGNoZWNrYm94IElOUFVUIGVsZW1lbnQgZm9yIGEgcGFyYW1ldGVyCiAgICAgKiBAcGFyYW0ge3BhcmFtZXRlcn0gcCAtIHRhcmdldCBvZiB0aGUgaW5wdXQgd2lkZ2V0CiAgICAgKiBAcmV0dXJuIHtpbnB1dH0KICAgICAqLwogICAgY3JlYXRlQ2hlY2tib3hJbnB1dDogZnVuY3Rpb24ocCl7CiAgICAgICAgdmFyIHNlbGVjdCA9IHRoaXMuY3JlYXRlUmF3U2VsZWN0SW5wdXQocCk7CgogICAgICAgIHAuZW1pdHRlci5vbignY2hhbmdlJywgZnVuY3Rpb24oc2VsZWN0LCBlLCBwKXsKICAgICAgICAgICAgc2VsZWN0LnZhbChwLnF1ZXJ5KTsKICAgICAgICB9LmJpbmQobnVsbCwgc2VsZWN0KSk7CgogICAgICAgIHNlbGVjdC5vbignY2hhbmdlJywgZnVuY3Rpb24oc2VsZWN0LCBwKXsKICAgICAgICAgICAgcC5zZXRWYWx1ZShzZWxlY3QudmFsKCkpOwogICAgICAgIH0uYmluZChudWxsLCBzZWxlY3QsIHApKTsKCiAgICAgICAgcmV0dXJuIHNlbGVjdDsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgcGFpciBvZiBzeW5jaHJvbml6ZWQgbnVtYmVyIElOUFVUIGVsZW1lbnRzIGZvciBhIHBhcmFtZXRlciByZXByZXNlbnRpbmcgYSBtaW4gYW5kIG1heCB2YWx1ZQogICAgICogQHBhcmFtIHtwYXJhbWV0ZXJ9IHAgLSB0YXJnZXQgb2YgdGhlIGlucHV0IHdpZGdldHMKICAgICAqIEByZXR1cm4ge0FycmF5LjxpbnB1dD59IHRoZSBtaW4gYW5kIG1heCBlbGVtZW50CiAgICAgKi8KICAgIGNyZWF0ZU1pbk1heE51bWJlcklucHV0OiBmdW5jdGlvbihwKSB7CiAgICAgICAgdmFyIG1pbklucHV0ID0gJCgnPGlucHV0IHR5cGU9Im51bWJlciIgdmFsdWU9IjAiIG1pbj0iMCIgbWF4PSInKyhwLnZhbHVlcy5sZW5ndGgtMSkrJyIgc3RlcD0iMSI+PC9pbnB1dD4nKTsKICAgICAgICAvL3ZhciBtaW5JbnB1dFZpcyA9IHRoaXMuY3JlYXRlUmF3TnVtYmVySW5wdXQoMCwwLHAucXVlcnlbMF0pOwogICAgICAgIHZhciBtaW5JbnB1dFZpcyA9ICQoJzxzcGFuIGNsYXNzPSJjdmxpYl9udW1iZXJMYWJlbCI+JytwLnF1ZXJ5WzBdKyc8L3NwYW4+Jyk7CgogICAgICAgIHZhciBtYXhJbnB1dCA9ICQoJzxpbnB1dCB0eXBlPSJudW1iZXIiIHZhbHVlPSIwIiBtaW49IjAiIG1heD0iJysocC52YWx1ZXMubGVuZ3RoLTEpKyciIHN0ZXA9IjEiPjwvaW5wdXQ+Jyk7CiAgICAgICAgLy92YXIgbWF4SW5wdXRWaXMgPSB0aGlzLmNyZWF0ZVJhd051bWJlcklucHV0KDAsMCxwLnF1ZXJ5WzBdKTsKICAgICAgICB2YXIgbWF4SW5wdXRWaXMgPSAkKCc8c3BhbiBjbGFzcz0iY3ZsaWJfbnVtYmVyTGFiZWwiPicrcC5xdWVyeVswXSsnPC9zcGFuPicpOwoKICAgICAgICBtaW5JbnB1dC5vbignaW5wdXQnLCBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgdjEgPSBwYXJzZUludChtaW5JbnB1dC52YWwoKSk7CiAgICAgICAgICAgIG1pbklucHV0VmlzLnRleHQocC52YWx1ZXNbdjFdKTsKCiAgICAgICAgICAgIHZhciB2MiA9IHBhcnNlSW50KG1heElucHV0LnZhbCgpKTsKICAgICAgICAgICAgaWYodjE+djIpewogICAgICAgICAgICAgICAgbWF4SW5wdXQudmFsKHYxKTsKICAgICAgICAgICAgICAgIG1heElucHV0VmlzLnRleHQocC52YWx1ZXNbdjFdKTsKICAgICAgICAgICAgICAgIHYyPXYxOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcXVlcnkgPSBbXTsKICAgICAgICAgICAgZm9yKHZhciBpPXYxOyBpPD12MjsgaSsrKQogICAgICAgICAgICAgICAgcXVlcnkucHVzaChwLnZhbHVlc1tpXSk7CiAgICAgICAgICAgIHAuc2V0VmFsdWUocXVlcnkpOwogICAgICAgIH0pOwoKICAgICAgICBtYXhJbnB1dC5vbignaW5wdXQnLCBmdW5jdGlvbigpewogICAgICAgICAgICB2YXIgdjIgPSBwYXJzZUludChtYXhJbnB1dC52YWwoKSk7CiAgICAgICAgICAgIG1heElucHV0VmlzLnRleHQocC52YWx1ZXNbdjJdKTsKCiAgICAgICAgICAgIHZhciB2MSA9IHBhcnNlSW50KG1pbklucHV0LnZhbCgpKTsKICAgICAgICAgICAgaWYodjE+djIpewogICAgICAgICAgICAgICAgbWluSW5wdXQudmFsKHYyKTsKICAgICAgICAgICAgICAgIG1pbklucHV0VmlzLnRleHQocC52YWx1ZXNbdjJdKTsKICAgICAgICAgICAgICAgIHYxPXYyOwogICAgICAgICAgICB9CgogICAgICAgICAgICB2YXIgcXVlcnkgPSBbXTsKICAgICAgICAgICAgZm9yKHZhciBpPXYxOyBpPD12MjsgaSsrKQogICAgICAgICAgICAgICAgcXVlcnkucHVzaChwLnZhbHVlc1tpXSk7CiAgICAgICAgICAgIHAuc2V0VmFsdWUocXVlcnkpOwogICAgICAgIH0pOwoKICAgICAgICBwLmVtaXR0ZXIub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgdmFyIG1heCA9IHAudmFsdWVzLmluZGV4T2YocC5xdWVyeVtwLnF1ZXJ5Lmxlbmd0aC0xXSk7CiAgICAgICAgICAgIHZhciBtaW4gPSBwLnZhbHVlcy5pbmRleE9mKHAucXVlcnlbMF0pOwogICAgICAgICAgICBtYXhJbnB1dC52YWwobWF4KTsKICAgICAgICAgICAgbWluSW5wdXQudmFsKG1pbik7CiAgICAgICAgICAgIG1heElucHV0VmlzLnRleHQocC52YWx1ZXNbbWF4XSk7CiAgICAgICAgICAgIG1pbklucHV0VmlzLnRleHQocC52YWx1ZXNbbWluXSk7CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBbbWluSW5wdXQsIG1pbklucHV0VmlzLCBtYXhJbnB1dCwgbWF4SW5wdXRWaXNdOwogICAgfSwKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBjb250YWluZXIgY29udGFpbmluZyB0d28gaW50ZXJhY3RpdmUgbGlzdHMgYmFzZWQgb24gcGFyYW1ldGVyLiBUaGUgZmlyc3QgbGlzdCBjb250YWlucyBhbGwgYXZhaWxhYmxlIG9wdGlvbnMgYW5kIHRoZSBvdGhlciBhbGwgc2VsZWN0ZWQgb3B0aW9ucy4KICAgICAqIEBwYXJhbSB7cGFyYW1ldGVyfSBwIC0gdGFyZ2V0IG9mIHRoZSBpbnB1dCB3aWRnZXRzCiAgICAgKiBAcmV0dXJuIHtkaXZ9CiAgICAgKi8KICAgIGNyZWF0ZVNldElucHV0OiBmdW5jdGlvbihwKXsKICAgICAgICB2YXIgY29udGFpbmVyID0gJCgnPGRpdiBjbGFzcz0iY3ZsaWJfc2V0SW5wdXQiPjwvZGl2PicpOwogICAgICAgIHZhciBzb3VyY2VMaXN0ID0gJCgnPHVsPjwvdWw+Jyk7CiAgICAgICAgdmFyIHRhcmdldExpc3QgPSAkKCc8dWw+PC91bD4nKTsKCiAgICAgICAgdmFyIGRyYWdFbGVtZW50ID0gbnVsbDsKCiAgICAgICAgdmFyIHVwZGF0ZVNldElucHV0ID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtdOwogICAgICAgICAgICB2YXIgdGVtcCA9IHRhcmdldExpc3QuZmluZCgnbGknKTsKICAgICAgICAgICAgZm9yKHZhciBpPTAsIGo9dGVtcC5sZW5ndGgtMTsgaTxqOyBpKyspCiAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaCh0ZW1wW2ldLmlubmVySFRNTCk7CiAgICAgICAgICAgIHAuc2V0VmFsdWUodmFsdWVzKTsKICAgICAgICB9OwoKICAgICAgICB2YXIgYWRkRHJhZ0xpc3RlbmVycyA9IGZ1bmN0aW9uKGxpKXsKICAgICAgICAgICAgbGkub24oJ2RyYWdlbnRlcicsIGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdkcmFnT3ZlcicpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbGkub24oJ2RyYWdvdmVyJywgZnVuY3Rpb24oZSl7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsaS5vbignZHJhZ2xlYXZlJywgZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlQ2xhc3MoJ2RyYWdPdmVyJyk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsaS5vbignZHJhZ3N0YXJ0JywgZnVuY3Rpb24oZSl7CiAgICAgICAgICAgICAgICBkcmFnRWxlbWVudCA9IHRoaXM7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsaS5vbignZHJvcCcsIGZ1bmN0aW9uKGUpewogICAgICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnZHJhZ092ZXInKTsKICAgICAgICAgICAgICAgIGlmKGRyYWdFbGVtZW50IT10aGlzKXsKICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmJlZm9yZShkcmFnRWxlbWVudCk7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU2V0SW5wdXQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgdmFyIGdob3N0ID0gJCgnPGxpPjwvbGk+Jyk7CiAgICAgICAgYWRkRHJhZ0xpc3RlbmVycyhnaG9zdCk7CiAgICAgICAgdGFyZ2V0TGlzdC5hcHBlbmQoZ2hvc3QpOwogICAgICAgIGdob3N0LmhpZGUoKTsKCiAgICAgICAgdmFyIGNyZWF0ZVRhcmdldExpID0gZnVuY3Rpb24odil7CiAgICAgICAgICAgIHZhciBsaSA9ICQoJzxsaSBkcmFnZ2FibGU9InRydWUiPicrdisnPC9saT4nKTsKICAgICAgICAgICAgYWRkRHJhZ0xpc3RlbmVycyhsaSk7CiAgICAgICAgICAgIGxpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpewogICAgICAgICAgICAgICAgaWYoZS53aGljaCA9PT0gMSAmJiB0YXJnZXRMaXN0LmZpbmQoJ2xpJykubGVuZ3RoPjIpewogICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgdXBkYXRlU2V0SW5wdXQoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiBsaTsKICAgICAgICB9OwoKICAgICAgICB2YXIgYWRkVGFyZ2V0ID0gZnVuY3Rpb24oZSl7CiAgICAgICAgICAgIGlmKCF0YXJnZXRMaXN0LmZpbmQoJ2xpOmNvbnRhaW5zKCcrdGhpcy52KycpJykubGVuZ3RoKXsKICAgICAgICAgICAgICAgIGdob3N0LmJlZm9yZSggY3JlYXRlVGFyZ2V0TGkodGhpcy52KSApOwogICAgICAgICAgICAgICAgdXBkYXRlU2V0SW5wdXQoKTsKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIHAuZW1pdHRlci5vbignY2hhbmdlJywgZnVuY3Rpb24oZSl7CiAgICAgICAgICAgIHZhciBpLGRlajsKICAgICAgICAgICAgdmFyIHRlbXAgPSBnaG9zdC5wcmV2KCk7CiAgICAgICAgICAgIHdoaWxlKHRlbXAubGVuZ3RoKXsKICAgICAgICAgICAgICAgIHRlbXAucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0ZW1wID0gZ2hvc3QucHJldigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZvcihpIGluIHAucXVlcnkpewogICAgICAgICAgICAgICAgZ2hvc3QuYmVmb3JlKCBjcmVhdGVUYXJnZXRMaShwLnF1ZXJ5W2ldKSApOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHZhciBpOwoKICAgICAgICBmb3IoaSBpbiBwLnF1ZXJ5KXsKICAgICAgICAgICAgZ2hvc3QuYmVmb3JlKCBjcmVhdGVUYXJnZXRMaShwLnF1ZXJ5W2ldKSApOwogICAgICAgIH0KCiAgICAgICAgZm9yKGkgaW4gcC52YWx1ZXMpewogICAgICAgICAgICB2YXIgc291cmNlID0gJCgnPGxpPicrcC52YWx1ZXNbaV0rJzwvbGk+Jyk7CiAgICAgICAgICAgIHNvdXJjZVswXS52ID0gcC52YWx1ZXNbaV07CiAgICAgICAgICAgIHNvdXJjZS5vbignY2xpY2snLCBhZGRUYXJnZXQpOwogICAgICAgICAgICBzb3VyY2VMaXN0LmFwcGVuZChzb3VyY2UpOwogICAgICAgIH0KICAgICAgICBjb250YWluZXIuYXBwZW5kKHNvdXJjZUxpc3QsIHRhcmdldExpc3QpOwoKICAgICAgICByZXR1cm4gY29udGFpbmVyOwogICAgfSwKCiAgICAvKioKICAgICAqIENyZWF0ZXMgYSBjb250YWluZXIgY29udGFpbmluZyBudW0gc2VsZWN0aW9ucyBiYXNlZCBvbiB0aGUgcGFyYW1ldGVyCiAgICAgKiBAcGFyYW0ge3BhcmFtZXRlcn0gcCAtIHRhcmdldCBvZiB0aGUgaW5wdXQgd2lkZ2V0cwogICAgICogQHBhcmFtIHtpbnR9IG51bSAtIFRoZSBudW1iZXIgb2Ygc2VsZWN0b3JzIHRvIGhhdmUKICAgICAqIEByZXR1cm4ge2Rpdn0KICAgICAqLwogICAgY3JlYXRlTXVsdGlWYWx1ZUlucHV0OiBmdW5jdGlvbihwLCBudW0pIHsKICAgICAgICB2YXIgY29udGFpbmVyID0gJCgnPGRpdiBjbGFzcz0iY3ZsaWJfbXVsdGlWYWx1ZUlucHV0Ij48L2Rpdj4nKTsKCiAgICAgICAgdmFyIGkgPSAwOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBudW07IGkrKykgewogICAgICAgICAgICAoZnVuY3Rpb24gKCl7IC8vbmVzdGVkIGludG8gYSBmdW5jdGlvbiBiZWNhdXNlIGphdmFzY3JpcHQgZG9lc24ndCBkbyBibG9jayBzY29wZSBvdGhlcndpc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29taW5nIGJhY2sgdG8gdGhpcyBmdW5jdGlvbiBtb250aHMgbGF0ZXIsIEkgcmVhbGl6ZSBob3cgbXVjaCBJJ3ZlIGltcHJvdmVkIHdpdGggamF2YXNjcmlwdCBzaW5jZSB0aGVuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FuZCBzZWVpbmcgaGFja2luZXNzIGxpa2UgdGhpcyBtYWtlcyBtZSBjcmluZ2UsIGJ1dCBJIGRvbid0IGhhdmUgdGltZSB0byByZXdyaXRlIGl0IG5vdyBzbyBJIG11c3QgbGl2ZSB3aXRoIGl0IDooCiAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBpOwogICAgICAgICAgICAgICAgcC5xdWVyeVtpbmRleF0gPSBwLnZhbHVlc1swXTsKICAgICAgICAgICAgICAgIHZhciBzZWwgPSBDVkxJQi5VSUZhY3RvcnkuY3JlYXRlUmF3U2VsZWN0SW5wdXQocC52YWx1ZXMpOwogICAgICAgICAgICAgICAgc2VsLmF0dHIoJ2NsYXNzJywncF8nK2luZGV4KTsKICAgICAgICAgICAgICAgIHNlbC5vbignY2hhbmdlJywgZnVuY3Rpb24oKXsKICAgICAgICAgICAgICAgICAgICBwLnF1ZXJ5W2luZGV4XSA9IHNlbC52YWwoKTsKICAgICAgICAgICAgICAgICAgICBwLmVtaXR0ZXIudHJpZ2dlcignY2hhbmdlJywgcCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQoc2VsKTsKICAgICAgICAgICAgICAgIGlmIChpICE9IG51bS0xKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZCgnICwgJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pKCk7CiAgICAgICAgfQoKICAgICAgICBwLmVtaXR0ZXIub24oJ2NoYW5nZScsZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIGZvcih2YXIgaSBpbiBwLnF1ZXJ5KSB7CiAgICAgICAgICAgICAgICB2YXIgc2VsID0gY29udGFpbmVyLmZpbmQoJy5wXycraSk7CiAgICAgICAgICAgICAgICBzZWwudmFsKHAucXVlcnlbaV0pOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIHJldHVybiBjb250YWluZXI7CiAgICB9LAoKICAgIC8qKgogICAgICogQ3JlYXRlcyBhIGNvbnRhaW5lciBjb250YWluaW5nIGEgc2lkZWJhciBhbmQgY29udGVudCBjb250YWluZXIKICAgICAqIEByZXR1cm4ge2Rpdn0KICAgICAqLwogICAgY3JlYXRlU2lkZWJhckxheW91dDogZnVuY3Rpb24oKXsKICAgICAgICB2YXIgY29udGFpbmVyID0gJCgnPGRpdj48L2Rpdj4nKTsKICAgICAgICB2YXIgc2lkZWJhciA9ICQoJzxkaXYgY2xhc3M9ImN2bGliX3NpZGViYXJMYXlvdXRTaWRlYmFyIj48L2Rpdj4nKTsKICAgICAgICB2YXIgY29udGVudCA9ICQoJzxkaXYgY2xhc3M9ImN2bGliX3NpZGViYXJMYXlvdXRDb250ZW50Ij48L2Rpdj4nKTsKICAgICAgICB2YXIgb2xkQXBwZW5kID0gY29udGVudC5hcHBlbmQ7CiAgICAgICAgY29udGVudC5hcHBlbmQgPSBmdW5jdGlvbihkb20pewogICAgICAgICAgICBjb250ZW50LmNzcyh7bGVmdDogc2lkZWJhclswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5yaWdodH0pOwogICAgICAgICAgICBvbGRBcHBlbmQuYXBwbHkodGhpcywgZG9tKTsKICAgICAgICB9OwoKICAgICAgICBzaWRlYmFyLm9uKCdyZXNpemVkJywgZnVuY3Rpb24oKXsKICAgICAgICAgICAgY29udGVudC5jc3Moe2xlZnQ6IHNpZGViYXJbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkucmlnaHR9KTsKICAgICAgICB9KTsKCiAgICAgICAgY29udGFpbmVyLmFwcGVuZChzaWRlYmFyLCBjb250ZW50KTsKCiAgICAgICAgY29udGFpbmVyLnNpZGViYXIgPSBzaWRlYmFyOwogICAgICAgIGNvbnRhaW5lci5jb250ZW50ID0gY29udGVudDsKCiAgICAgICAgcmV0dXJuIGNvbnRhaW5lcjsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgRElWIGVsZW1lbnQgcmVwcmVzZW50aW5nIGEgbG9hZGluZyBiYXIgd2l0aCB0aGUgZnVuY3Rpb25zICdzZXRTdGVwcycgYW5kICdwcm9ncmVzcycuCiAgICAgKiBAcmV0dXJuIHtkaXZ9CiAgICAgKi8KICAgIGNyZWF0ZUxvYWRpbmdCYXI6IGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIGJhciA9ICQoJzxkaXYgY2xhc3M9ImN2bGliX2xvYWRpbmdCYXIiPjwvZGl2PicpOwogICAgICAgIGJhci5zZXRTdGVwcyA9IGZ1bmN0aW9uKHN0ZXBzKXsKICAgICAgICAgICAgdGhpcy53aWR0aCgwKTsKICAgICAgICAgICAgdGhpcy5mYWRlSW4oMCk7CiAgICAgICAgICAgIHRoaXMuc3RlcCA9IDA7CiAgICAgICAgICAgIHRoaXMuc3RlcHMgPSBzdGVwczsKICAgICAgICB9OwogICAgICAgIGJhci5wcm9ncmVzcyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIHRoaXMuc3RlcCsrOwogICAgICAgICAgICB0aGlzLndpZHRoKCB0aGlzLnN0ZXAvdGhpcy5zdGVwcyAqICQod2luZG93KS53aWR0aCgpICk7CiAgICAgICAgICAgIGlmKHRoaXMuc3RlcCA9PT0gdGhpcy5zdGVwcykKICAgICAgICAgICAgICAgIHRoaXMuZmFkZU91dCgzMDApOwogICAgICAgIH07CiAgICAgICAgcmV0dXJuIGJhcjsKICAgIH0sCgogICAgLyoqCiAgICAgKiBDcmVhdGVzIGEgRElWIGVsZW1lbnQgcmVwcmVzZW50aW5nIGEgbG9hZGluZyBzeW1ib2wKICAgICAqIEByZXR1cm4ge2Rpdn0KICAgICAqLwogICAgY3JlYXRlTG9hZGluZ1N5bWJvbDogZnVuY3Rpb24oKXsKICAgICAgICByZXR1cm4gJCgnPGRpdiBjbGFzcz0iY3ZsaWJfbG9hZGluZ1N5bWJvbCI+TG9hZGluZy4uLjwvZGl2PicpOwogICAgfQp9OwoKaWYoIXdpbmRvdy5DVkxJQikgd2luZG93LkNWTElCID0ge307CndpbmRvdy5DVkxJQi5VSUZhY3RvcnkgPSBVSUZhY3Rvcnk7Cgp9KSgpOwoAJ3VzZSBzdHJpY3QnOyAvKiBnbG9iYWxzICQgQ1ZMSUIgKi8KKC8qKiBAbGVuZHMgbW9kdWxlOkNWTElCICovZnVuY3Rpb24oKXsKCi8qKgogKiBEYXRhYmFzZSBmb3IgYSBTcGVjIEEgaW1hZ2UgcmVwb3NpdG9yeQogKiBAY29uc3RydWN0b3IKICogQGF1Z21lbnRzIERhdGFiYXNlCiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgLSBwYXRoIHRvIEpTT04gZmlsZQogKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjayAtIGNhbGxlZCBhZnRlciBEQiBpbml0aWFsaXphdGlvbiB3aXRoIGEgUXVlcnlTZXQgZGVzY3JpYmluZyB0aGUgREIgU2NoZW1lCiAqLwpmdW5jdGlvbiBEYXRhYmFzZVNwZWNBKHVybCwgY2FsbGJhY2spewogICAgQ1ZMSUIuRGF0YWJhc2UuY2FsbCggdGhpcyApOwoKICAgIGNvbnNvbGUubG9nKCdMb2FkaW5nOicsIHVybCk7CiAgICB2YXIgcHJlZml4ID0gdXJsLnNwbGl0KCcvJykuc2xpY2UoMCwtMSkuam9pbignLycpOwogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgJC5hamF4KHsKICAgICAgICBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgIHVybDogdXJsLAogICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGpzb24pewogICAgICAgICAgICBpZiggcHJlZml4ID09PSAiIikKICAgICAgICAgICAgICAgIGpzb24uZGF0YWJhc2VEaXIgPSAnJzsKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAganNvbi5kYXRhYmFzZURpciA9IHByZWZpeCsnLyc7CiAgICAgICAgICAgIGlmKCFzZWxmLnZhbGlkYXRlSlNPTihqc29uKSkKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgc2VsZi5qc29uID0ganNvbjsKCiAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzID0ge307CiAgICAgICAgICAgIGZvcih2YXIgaSBpbiBqc29uLmFyZ3VtZW50cyl7CiAgICAgICAgICAgICAgICB2YXIgYXJnID0ganNvbi5hcmd1bWVudHNbaV07CiAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzW2ldID0gbmV3IENWTElCLlBhcmFtZXRlcigKICAgICAgICAgICAgICAgICAgICBhcmcubGFiZWwsCiAgICAgICAgICAgICAgICAgICAgYXJnLnR5cGUsCiAgICAgICAgICAgICAgICAgICAgYXJnLnZhbHVlcywKICAgICAgICAgICAgICAgICAgICBhcmcuZGVmYXVsdAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2FsbGJhY2soIG5ldyBDVkxJQi5RdWVyeVNldChwYXJhbWV0ZXJzKSApOwogICAgICAgIH0sCiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKGUpewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbmFibGUgdG8gbG9hZCBKU09OOicsIGUpOwogICAgICAgIH0KICAgIH0pOwp9CkRhdGFiYXNlU3BlY0EucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggQ1ZMSUIuRGF0YWJhc2UucHJvdG90eXBlICk7CkRhdGFiYXNlU3BlY0EucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gRGF0YWJhc2VTcGVjQTsKCi8qKgogKiBWYWxpZGF0ZSBpZiBKU09OIGZpbGUgaXMgY29tcGxpYW50IHRvIFNwZWMgQQogKiBAcGFyYW0ge0pTT059IGpzb24gLSBKU09OIG9iamVjdAogKiBAcmV0dXJuIHtib29sfQogKi8KRGF0YWJhc2VTcGVjQS5wcm90b3R5cGUudmFsaWRhdGVKU09OID0gZnVuY3Rpb24oanNvbil7CiAgICBjb25zb2xlLmxvZygnUHJvY2Vzc2luZyBKU09OLUZpbGU6JywganNvbik7CgogICAgdmFyIHBhcnNlRXJyb3JGbGFnID0gZmFsc2U7CiAgICB2YXIgcGFyc2VFcnJvciA9IGZ1bmN0aW9uKG1zZyl7CiAgICAgICAgY29uc29sZS5lcnJvcignSlNPTi1GaWxlIGRvZXMgbm90IG1lZXQgU3BlYyBBOicsIG1zZyk7CiAgICAgICAgcGFyc2VFcnJvckZsYWcgPSB0cnVlOwogICAgfS5iaW5kKHRoaXMpOwoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vIENoZWNrIGlmIEpTT04gbWVldHMgU3BlYyBBCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICBpZiggICAgIWpzb24uaGFzT3duUHJvcGVydHkoICdhcmd1bWVudHMnICAgICkKICAgICAgICB8fCAhanNvbi5oYXNPd25Qcm9wZXJ0eSggJ21ldGFkYXRhJyAgICAgKQogICAgICAgIHx8ICFqc29uLmhhc093blByb3BlcnR5KCAnbmFtZV9wYXR0ZXJuJyApCiAgICApewogICAgICAgIHBhcnNlRXJyb3IoJ0pTT04tRmlsZSBoYXMgbm8gYXR0cmlidXRlIFwnYXJndW1lbnRzXCcsIFwnbWV0YWRhdGFcJywgb3IgXCduYW1lX3BhdHRlcm5cJycpOwogICAgfQogICAgLy8gQ2hlY2sgdXJsIHRvIGpzb24uYXJndW1lbnRzIGNvbnNpc3RhbmN5CiAgICBpZiggJC50eXBlKGpzb24ubmFtZV9wYXR0ZXJuKSAhPT0gJ3N0cmluZycgKXsKICAgICAgICBwYXJzZUVycm9yKCdqc29uLm5hbWVfcGF0dGVybiBpcyBub3Qgb2YgdHlwZSBcJ1N0cmluZ1wnJyk7CgogICAgfQogICAgdmFyIGFyZ3VtZW50TGlzdCA9IGpzb24ubmFtZV9wYXR0ZXJuLm1hdGNoKC9ceyguKj8pXH0vZyk7CiAgICBhcmd1bWVudExpc3QuZm9yRWFjaChmdW5jdGlvbih2LGkpewogICAgICAgIGFyZ3VtZW50TGlzdFtpXSA9IHYuc3Vic3RyaW5nKDEsdi5sZW5ndGgtMSk7CiAgICB9KTsKCiAgICB2YXIgaSxqOwoKICAgIC8vIENoZWNrIEV4aXN0YW5jZQogICAgZm9yKGkgaW4gYXJndW1lbnRMaXN0KXsKICAgICAgICBpZighanNvbi5hcmd1bWVudHMuaGFzT3duUHJvcGVydHkoIGFyZ3VtZW50TGlzdFtpXSApKQogICAgICAgICAgICBwYXJzZUVycm9yKCdBcmd1bWVudCBpbiBVUkwgaXMgbm90IHNwZWNpZmllZCBpbiBqc29uLmFyZ3VtZW50cycpOwogICAgfQoKICAgIHZhciBwYXJhbWV0ZXI7CiAgICB2YXIgaXNDb250YWluZWQgPSBmYWxzZTsKICAgIHZhciB2YWx1ZXMgPSBbXTsKICAgIGZvcihpIGluIGpzb24uYXJndW1lbnRzKXsKICAgICAgICBwYXJhbWV0ZXIgPSBqc29uLmFyZ3VtZW50c1tpXTsKICAgICAgICBpZighcGFyYW1ldGVyLmhhc093blByb3BlcnR5KCdsYWJlbCcpKSBwYXJzZUVycm9yKCdQYXJhbWV0ZXIgaGFzIG5vIGxhYmVsOicsIHBhcmFtZXRlcik7CiAgICAgICAgaWYoIXBhcmFtZXRlci5oYXNPd25Qcm9wZXJ0eSgnZGVmYXVsdCcpKSBwYXJzZUVycm9yKCdQYXJhbWV0ZXIgaGFzIG5vIGRlZmF1bHQgdmFsdWUnLCBwYXJhbWV0ZXIpOwogICAgICAgIGlmKCFwYXJhbWV0ZXIuaGFzT3duUHJvcGVydHkoJ3ZhbHVlcycpKSBwYXJzZUVycm9yKCdQYXJhbWV0ZXIgaGFzIG5vIGxpc3Qgb2YgdmFsdWVzJywgcGFyYW1ldGVyKTsKICAgICAgICBzd2l0Y2ggKHBhcmFtZXRlci50eXBlKSB7CiAgICAgICAgICAgIGNhc2UgJ3JhbmdlJzoKICAgICAgICAgICAgICAgIGlmKCEkLmlzTnVtZXJpYyhwYXJhbWV0ZXIuZGVmYXVsdCkpCiAgICAgICAgICAgICAgICAgICAgcGFyc2VFcnJvcignRGVmYXVsdCB2YWx1ZSBvZiByYW5nZSBQYXJhbWV0ZXIgaXMgbm90IE51bWVyaWMnLCBwYXJhbWV0ZXIpOwoKICAgICAgICAgICAgICAgIC8vIHBhcmFtZXRlci5kZWZhdWx0ID0gcGFyc2VGbG9hdChwYXJhbWV0ZXIuZGVmYXVsdCk7CiAgICAgICAgICAgICAgICBwYXJhbWV0ZXIuZGVmYXVsdCA9IHBhcmFtZXRlci5kZWZhdWx0OwoKICAgICAgICAgICAgICAgIHZhbHVlcyA9IFtdOwogICAgICAgICAgICAgICAgaXNDb250YWluZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcihqIGluIHBhcmFtZXRlci52YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIGlmKCEkLmlzTnVtZXJpYyhwYXJhbWV0ZXIudmFsdWVzW2pdKSkKICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VFcnJvcignUGFyYW1ldGVyIGlzIG9mIHR5cGUgXCdyYW5nZVwnIGJ1dCBtZW1iZXJzIG9mIGl0cyB2YWx1ZXMgYXJlIG5vdCBOdW1lcmljJywgcGFyYW1ldGVyKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gdmFsdWVzW2pdID0gcGFyc2VGbG9hdChwYXJhbWV0ZXIudmFsdWVzW2pdKTsKICAgICAgICAgICAgICAgICAgICB2YWx1ZXNbal0gPSBwYXJhbWV0ZXIudmFsdWVzW2pdOwogICAgICAgICAgICAgICAgICAgIGlmKHZhbHVlc1tqXSA9PT0gcGFyYW1ldGVyLmRlZmF1bHQpIGlzQ29udGFpbmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCFpc0NvbnRhaW5lZCkKICAgICAgICAgICAgICAgICAgICBwYXJzZUVycm9yKCdEZWZhdWx0IHZhbHVlIG9mIFBhcmFtZXRlciBpcyBub3QgY29udGFpbmVkIGluIHZhbHVlcycsIHBhcmFtZXRlcik7CgogICAgICAgICAgICAgICAgcGFyYW1ldGVyLnZhbHVlcyA9IHZhbHVlcy5zb3J0KGZ1bmN0aW9uKGEsYil7IHJldHVybiBhLWI7IH0pOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICAgICAgICAgICAgcGFyYW1ldGVyLnZhbHVlcyA9IFswLDFdOwogICAgICAgICAgICAgICAgcGFyYW1ldGVyLmRlZmF1bHQgPSBwYXJhbWV0ZXIuZGVmYXVsdCA/IDEgOiAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NldCc6CiAgICAgICAgICAgICAgICBpc0NvbnRhaW5lZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgZm9yKGogaW4gcGFyYW1ldGVyLnZhbHVlcyl7CiAgICAgICAgICAgICAgICAgICAgaWYocGFyYW1ldGVyLnZhbHVlc1tqXSA9PT0gcGFyYW1ldGVyLmRlZmF1bHQpIGlzQ29udGFpbmVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIHBhcnNlRXJyb3IoJ1Vua25vd24gUGFyYW1ldGVyIFR5cGUnLCBwYXJhbWV0ZXIpOwogICAgICAgIH0KICAgIH0KCiAgICBpZihwYXJzZUVycm9yRmxhZykgcmV0dXJuIGZhbHNlOwogICAgY29uc29sZS5sb2coJ1ZhbGlkIFNwZWMgQSBKU09OLUZpbGUnKTsKICAgIHJldHVybiB0cnVlOwp9OwoKLyoqCiAqIEFzeW5jaHJvbm91c2x5IHByb2Nlc3NlcyBhIHF1ZXJ5U2V0IGFuZCBwYXNzZXMgdGhlIHJlc3VsdFNldCB0byBhIGNhbGxiYWNrCiAqIEBwYXJhbSB7UXVlcnlTZXR9IHF1ZXJ5U2V0CiAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrCiAqLwpEYXRhYmFzZVNwZWNBLnByb3RvdHlwZS5wcm9jZXNzUXVlcnkgPSBmdW5jdGlvbihxdWVyeVNldCwgY2FsbGJhY2spewogICAgdmFyIGksajsKCiAgICB2YXIgcGF0dGVyblJlcGxhY2UgPSBmdW5jdGlvbihwYXR0ZXJuLCBwYXJhbWV0ZXJzKXsKICAgICAgICBmb3IoaSBpbiBwYXJhbWV0ZXJzKXsKICAgICAgICAgICAgaWYoJC5pc0FycmF5KHBhcmFtZXRlcnNbaV0ucXVlcnkpKSBjb250aW51ZTsKICAgICAgICAgICAgcGF0dGVybiA9IHBhdHRlcm4ucmVwbGFjZSgneycraSsnfScsIHBhcmFtZXRlcnNbaV0ucXVlcnkpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcGF0dGVybjsKICAgIH07CgogICAgdmFyIHJlcGxhY2VBbGwgPSBmdW5jdGlvbihzdHJpbmcsIHNlYXJjaCwgcmVwbGFjZW1lbnQpIHsKICAgICAgICByZXR1cm4gc3RyaW5nLnNwbGl0KHNlYXJjaCkuam9pbihyZXBsYWNlbWVudCk7CiAgICB9CgogICAgdmFyIHBhdHRlcm4gPSB0aGlzLmpzb24ubmFtZV9wYXR0ZXJuOwogICAgdmFyIGRpciA9IHRoaXMuanNvbi5kYXRhYmFzZURpcjsKICAgIHZhciByZXN1bHRTZXQ7CiAgICBzd2l0Y2gocXVlcnlTZXQuaW5mby50eXBlKXsKICAgICAgICBjYXNlICdzaW5nbGUnOgogICAgICAgICAgICByZXN1bHRTZXQgPSBuZXcgQ1ZMSUIuUmVzdWx0U2V0KAogICAgICAgICAgICAgICAgcXVlcnlTZXQuc2VyaWFsaXplKCksCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2ltYWdlJywKICAgICAgICAgICAgICAgICAgICBzcmM6IGRpciArIHBhdHRlcm5SZXBsYWNlKHBhdHRlcm4sIHF1ZXJ5U2V0LnBhcmFtZXRlcnMpLAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdtYXRyaXgnOgogICAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciBiYXNlUGF0dGVybiA9IHBhdHRlcm5SZXBsYWNlKHBhdHRlcm4sIHF1ZXJ5U2V0LnBhcmFtZXRlcnMpOwogICAgICAgICAgICB2YXIgcDEgPSBxdWVyeVNldC5pbmZvLnAxOwogICAgICAgICAgICB2YXIgcDIgPSBxdWVyeVNldC5pbmZvLnAyOwogICAgICAgICAgICB2YXIgcDFxID0gcGFyYW1ldGVyc1twMV0ucXVlcnk7CiAgICAgICAgICAgIHZhciBwMnEgPSBwYXJhbWV0ZXJzW3AyXS5xdWVyeTsKICAgICAgICAgICAgdmFyIHAxcWksIHAycWk7CiAgICAgICAgICAgIHZhciBkYXRhID0ge307CiAgICAgICAgICAgIGZvcihpIGluIHAxcSl7CiAgICAgICAgICAgICAgICBwMXFpID0gcDFxW2ldOwogICAgICAgICAgICAgICAgZGF0YVtwMXFpXSA9IHt9OwogICAgICAgICAgICAgICAgcGF0dGVybiA9IGJhc2VQYXR0ZXJuLnJlcGxhY2UoJ3snK3AxKyd9JywgcDFxaSk7CiAgICAgICAgICAgICAgICBmb3IoaiBpbiBwMnEpewogICAgICAgICAgICAgICAgICAgIHAycWkgPSBwMnFbal07CiAgICAgICAgICAgICAgICAgICAgZGF0YVtwMXFpXVtwMnFpXSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2ltYWdlJywKICAgICAgICAgICAgICAgICAgICAgICAgc3JjOiBkaXIgKyBwYXR0ZXJuLnJlcGxhY2UoJ3snK3AyKyd9JywgcDJxaSksCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVzdWx0U2V0ID0gbmV3IENWTElCLlJlc3VsdFNldCgKICAgICAgICAgICAgICAgIHF1ZXJ5U2V0LnNlcmlhbGl6ZSgpLAogICAgICAgICAgICAgICAgZGF0YQogICAgICAgICAgICApOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdzZWFyY2gnIDoKICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSBxdWVyeVNldC5wYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKHBhcmFtZXRlcnMpCiAgICAgICAgICAgIHZhciBkYXRhID0gW107CgogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogQWRkIGFsbCBwb3NzaWJsZSByZXN1bHRzIGZvciB0aGUgcXVlcmllcyBmb3IgYWxsIHBhcmFtZXRlcnMgYXQga2V5SW5kZXggYW5kIHBhc3QsCiAgICAgICAgICAgICAqIFVzaW5nIGN1cnJlbnRWYWx1ZXMgdG8gZGVmaW5lIHRoZSB2YWx1ZXMgZm9yIHBhcmFtZXRlcnMgYmVmb3JlIGtleUluZGV4LgogICAgICAgICAgICAgKiAod29ya3MgcmVjdXJzaXZlbHkpCiAgICAgICAgICAgICAqLwogICAgICAgICAgICB2YXIgYWRkUmVzdWx0cyA9IGZ1bmN0aW9uKGtleUluZGV4LCBjdXJyZW50VmFsdWVzKSB7CiAgICAgICAgICAgICAgICB2YXIgcCA9IHBhcmFtZXRlcnNba2V5c1trZXlJbmRleF1dOwogICAgICAgICAgICAgICAgZm9yIChxIGluIHAucXVlcnkpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbmV3VmFsdWVzID0gJC5leHRlbmQoe30sY3VycmVudFZhbHVlcyk7Ly9Db3B5IHZhbHVlcwogICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlc1trZXlzW2tleUluZGV4XV0gPSBwLnF1ZXJ5W3FdOwogICAgICAgICAgICAgICAgICAgIGlmIChrZXlJbmRleCA9PSBrZXlzLmxlbmd0aC0xKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXRoID0gcGF0dGVybjsKICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBuZXdWYWx1ZXMpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoID0gcmVwbGFjZUFsbChwYXRoLCAneycraSsnfScsIG5ld1ZhbHVlc1tpXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEucHVzaCh7dHlwZTonaW1hZ2UnLCBzcmM6IGRpciArIHBhdGgsIHZhbHVlczogbmV3VmFsdWVzfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRSZXN1bHRzKGtleUluZGV4KzEsIG5ld1ZhbHVlcyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vQWRkIGFsbCByZXN1bHRzIGZvciBhbGwgcGFyYW1ldGVycwogICAgICAgICAgICBhZGRSZXN1bHRzKDAse30pOwoKICAgICAgICAgICAgcmVzdWx0U2V0ID0gbmV3IENWTElCLlJlc3VsdFNldCgKICAgICAgICAgICAgICAgIHF1ZXJ5U2V0LnNlcmlhbGl6ZSgpLAogICAgICAgICAgICAgICAgZGF0YQogICAgICAgICAgICApOwogICAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICdjb21wYXJlJyA6CiAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzID0gcXVlcnlTZXQucGFyYW1ldGVyczsKICAgICAgICAgICAgdmFyIGJhc2VQYXR0ZXJuID0gcGF0dGVyblJlcGxhY2UocGF0dGVybiwgcXVlcnlTZXQucGFyYW1ldGVycyk7CiAgICAgICAgICAgIHZhciBwID0gcXVlcnlTZXQuaW5mby5wOwogICAgICAgICAgICB2YXIgcSA9IHBhcmFtZXRlcnNbcF0ucXVlcnk7CiAgICAgICAgICAgIHZhciBkYXRhID0ge307CiAgICAgICAgICAgIGZvciAoaSBpbiBxKSB7CiAgICAgICAgICAgICAgICBkYXRhW2ldID0gewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJpbWFnZSIsCiAgICAgICAgICAgICAgICAgICAgc3JjOiBkaXIgKyBiYXNlUGF0dGVybi5yZXBsYWNlKCd7JytwKyd9JywgcVtpXSkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJlc3VsdFNldCA9IG5ldyBDVkxJQi5SZXN1bHRTZXQoCiAgICAgICAgICAgICAgICBxdWVyeVNldC5zZXJpYWxpemUoKSwKICAgICAgICAgICAgICAgIGRhdGEKICAgICAgICAgICAgKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgY29uc29sZS5lcnJvcignVW5zdXBwb3J0ZWQgTW9kZTogJyArIHF1ZXJ5U2V0LmluZm8udHlwZSk7CiAgICAgICAgICAgIHJldHVybjsKICAgIH0KCiAgICBxdWVyeVNldC5lbWl0dGVyLnRyaWdnZXIoJ3Byb2Nlc3NlZCcpOwoKICAgIGNhbGxiYWNrKAogICAgICAgIHJlc3VsdFNldAogICAgKTsKfTsKCi8qKgogKiBBc3luY2hyb25vdXNseSBwcm9jZXNzZXMgYSBxdWVyeVNldCBhbmQgcGFzc2VzIHRoZSByZXN1bHRTZXQgdG8gYSBjYWxsYmFjawogKiBBbGxvd3MgZm9yIGEgY3VzdG9taXphYmxlIGxhYmVsIHRvIGJlIGFkZGVkIHRvIGVhY2ggaW1hZ2UKICogQHBhcmFtIHtRdWVyeVNldH0gcXVlcnlTZXQKICogQHBhcmFtIHtTdHJpbmd9ICAgbGFiZWwKICogQHBhcmFtIHtmdW5jdGlvbn0gY2FsbGJhY2sKICovCkRhdGFiYXNlU3BlY0EucHJvdG90eXBlLnByb2Nlc3NRdWVyeVdpdGhMYWJlbHMgPSBmdW5jdGlvbihxdWVyeVNldCwgbGFiZWwsIGNhbGxiYWNrKXsKCiAgICB2YXIgcmVwbGFjZUFsbCA9IGZ1bmN0aW9uKHN0cmluZywgc2VhcmNoLCByZXBsYWNlbWVudCkgewogICAgICAgIHJldHVybiBzdHJpbmcuc3BsaXQoc2VhcmNoKS5qb2luKHJlcGxhY2VtZW50KTsKICAgIH0KCiAgICB2YXIgcGF0dGVyblJlcGxhY2VBbGwgPSBmdW5jdGlvbihwYXR0ZXJuLCBwYXJhbWV0ZXJzKXsKICAgICAgICBmb3IodmFyIGkgaW4gcGFyYW1ldGVycyl7CiAgICAgICAgICAgIGlmKCQuaXNBcnJheShwYXJhbWV0ZXJzW2ldLnF1ZXJ5KSkgY29udGludWU7CiAgICAgICAgICAgIHBhdHRlcm4gPSByZXBsYWNlQWxsKHBhdHRlcm4sICd7JytwYXJhbWV0ZXJzW2ldLmxhYmVsKyd9JywgcGFyYW1ldGVyc1tpXS5xdWVyeSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYXR0ZXJuOwogICAgfTsKCiAgICB2YXIgYWRkTGFiZWxzID0gZnVuY3Rpb24ocmVzdWx0U2V0KSB7CiAgICAgICAgc3dpdGNoIChxdWVyeVNldC5pbmZvLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnc2luZ2xlJyA6CiAgICAgICAgICAgICAgICBsYWJlbCA9IHBhdHRlcm5SZXBsYWNlQWxsKGxhYmVsLHF1ZXJ5U2V0LnBhcmFtZXRlcnMpOwogICAgICAgICAgICAgICAgJC5leHRlbmQocmVzdWx0U2V0LmRhdGEse2xhYmVsOiBsYWJlbH0pOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ21hdHJpeCcgOgogICAgICAgICAgICAgICAgdmFyIHZzMV9sYWJlbCA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnNbcXVlcnlTZXQuaW5mby5wMV0ubGFiZWw7CiAgICAgICAgICAgICAgICB2YXIgdnMyX2xhYmVsID0gcXVlcnlTZXQucGFyYW1ldGVyc1txdWVyeVNldC5pbmZvLnAyXS5sYWJlbDsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzdWx0U2V0LmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqIGluIHJlc3VsdFNldC5kYXRhW2ldKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vVGhlIHRhZ3Mge3ZzMX0se3ZzMn0se3ZzMV9sYWJlbH0gYW5kIHt2czJfbGFiZWx9IGFyZQogICAgICAgICAgICAgICAgICAgICAgICAvL3JlcGxhY2VkIHdpdGggdmFsdWVzIHJlbGF0ZWQgdG8gdGhlIHR3byBwYXJhbWV0ZXJzIGJlaW5nIGNvbXBhcmVkCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdMYWJlbCA9IHBhdHRlcm5SZXBsYWNlQWxsKGxhYmVsLHF1ZXJ5U2V0LnBhcmFtZXRlcnMpOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7dnMxX2xhYmVsfScsdnMxX2xhYmVsKTsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3TGFiZWwgPSByZXBsYWNlQWxsKG5ld0xhYmVsLCAne3ZzMX0nLGkpOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7Jyt2czFfbGFiZWwrJ30nLGkpOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7dnMyX2xhYmVsfScsdnMyX2xhYmVsKTsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3TGFiZWwgPSByZXBsYWNlQWxsKG5ld0xhYmVsLCAne3ZzMn0nLGopOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7Jyt2czJfbGFiZWwrJ30nLGopOwogICAgICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZChyZXN1bHRTZXQuZGF0YVtpXVtqXSx7bGFiZWw6IG5ld0xhYmVsfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NlYXJjaCcgOgogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXN1bHRTZXQuZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciBuZXdMYWJlbCA9IGxhYmVsOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHZhbHVlIGluIHJlc3VsdFNldC5kYXRhW2ldLnZhbHVlcykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnNbdmFsdWVdOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7JytwLmxhYmVsKyd9JyxyZXN1bHRTZXQuZGF0YVtpXS52YWx1ZXNbdmFsdWVdKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy9UaGUgdGFnIHtyZXN1bHR9IGlzIHJlcGxhY2VkIHdpdGggdGhlIHJlc3VsdCBudW1iZXIgb2YgdGhpcyBkYXRhIHBvaW50CiAgICAgICAgICAgICAgICAgICAgbmV3TGFiZWwgPSByZXBsYWNlQWxsKG5ld0xhYmVsLCAne3Jlc3VsdH0nLCBpKTsKICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZChyZXN1bHRTZXQuZGF0YVtpXSx7bGFiZWw6IG5ld0xhYmVsfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnY29tcGFyZScgOgogICAgICAgICAgICAgICAgbGFiZWwgPSBwYXR0ZXJuUmVwbGFjZUFsbChsYWJlbCxxdWVyeVNldC5wYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIHZhciBwID0gcXVlcnlTZXQuaW5mby5wOwogICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSBxdWVyeVNldC5wYXJhbWV0ZXJzOwogICAgICAgICAgICAgICAgdmFyIHEgPSBwYXJhbWV0ZXJzW3BdLnF1ZXJ5OwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXN1bHRTZXQuZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobGFiZWwsJ3snK3BhcmFtZXRlcnNbcF0ubGFiZWwrJ30nLCBxW2ldKTsKICAgICAgICAgICAgICAgICAgICAvL1RoZSB0YWdzIHtjb21wYXJlfSBhbmQge2NvbXBhcmVfbGFiZWx9IGFyZSByZXBsYWNlZCB3aXRoIHZhbHVlcyByZWxhdGVkIHRvIHRoZSB2YWx1ZSBiZWluZyBjb21wYXJlZAogICAgICAgICAgICAgICAgICAgIG5ld0xhYmVsID0gcmVwbGFjZUFsbChuZXdMYWJlbCwgJ3tjb21wYXJlX2xhYmVsfScsIHBhcmFtZXRlcnNbcF0ubGFiZWwpOwogICAgICAgICAgICAgICAgICAgIG5ld0xhYmVsID0gcmVwbGFjZUFsbChuZXdMYWJlbCwgJ3tjb21wYXJlfScsIHFbaV0pOwogICAgICAgICAgICAgICAgICAgIC8vVGhlIHRhZ3Mge3Jlc3VsdH0gYW5kIHt2aWV3fSBhcmUgcmVwbGFjZWQgd2l0aCB0aGUgaW5kZXgKICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7dmlld30nLCBpKTsKICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7cmVzdWx0fScsIGkpOwogICAgICAgICAgICAgICAgICAgICQuZXh0ZW5kKHJlc3VsdFNldC5kYXRhW2ldLHtsYWJlbDogbmV3TGFiZWx9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNhbGxiYWNrKAogICAgICAgICAgICByZXN1bHRTZXQKICAgICAgICApOwogICAgfQoKICAgIHRoaXMucHJvY2Vzc1F1ZXJ5KHF1ZXJ5U2V0LCBhZGRMYWJlbHMpOyAKfTsKCmlmKCF3aW5kb3cuQ1ZMSUIpIHdpbmRvdy5DVkxJQiA9IHt9Owp3aW5kb3cuQ1ZMSUIuRGF0YWJhc2VTcGVjQSA9IERhdGFiYXNlU3BlY0E7Cgp9KSgpOwAndXNlIHN0cmljdCc7IC8qIGdsb2JhbHMgJCAqLwooLyoqIEBsZW5kcyBtb2R1bGU6Q1ZMSUIgKi9mdW5jdGlvbigpewoKLyoqCiAqIEF1Z21lbnRzIGEgdmlld3BvcnQgd2l0aCBtb3VzZS1jb250cm9scyB0byB6b29tIGFuZCBwYW4uCiAqIFdpdGggdGhlc2UgY29udHJvbHMsIGxlZnQtY2xpY2stYW5kLWRyYWdnaW5nIHBhbnMgdGhlIGltYWdlIGFuZCBzY3JvbGxpbmcgem9vbXMgdGhlIGltYWdlLgogKiBAY29uc3RydWN0b3IKICogQHBhcmFtIHt2aWV3cG9ydH0gdmlld3BvcnQgLSB2aWV3cG9ydCB3aGljaCBpcyB0YXJnZXQgb2YgdGhlIG1vdXNlIGludGVyYWN0aW9uCiAqLwpmdW5jdGlvbiBDb250cm9sc0Jhc2ljKHZpZXdwb3J0KXsKICAgIHZhciBjYW52YXMgPSB2aWV3cG9ydC5jYW52YXM7CiAgICB2YXIgem9vbUZhY3RvciA9IDAuMTsKCiAgICB2YXIgeDA9MCwgeTA9MDsKCiAgICB2YXIgb25Nb3VzZURvd24gPSBmdW5jdGlvbihlKXsKICAgICAgICBpZihlLndoaWNoICE9PSAxKSByZXR1cm47CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIHgwID0gZS5jbGllbnRYOwogICAgICAgIHkwID0gZS5jbGllbnRZOwoKICAgICAgICB2aWV3cG9ydC5vZmYoJ21vdXNlZG93bicsIG9uTW91c2VEb3duKTsKICAgICAgICB2aWV3cG9ydC5vbignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpOwogICAgICAgIHZpZXdwb3J0Lm9uKCdtb3VzZW91dCcsIG9uTW91c2VVcCk7CiAgICAgICAgdmlld3BvcnQub24oJ21vdXNldXAnLCBvbk1vdXNlVXApOwogICAgfTsKCiAgICB2YXIgb25Nb3VzZU1vdmUgPSBmdW5jdGlvbihlKXsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKCiAgICAgICAgdmFyIGR4ID0gKGUuY2xpZW50WC14MCk7CiAgICAgICAgdmFyIGR5ID0gKHkwLWUuY2xpZW50WSk7CgogICAgICAgIHZhciBwb3MgPSBjYW52YXMucG9zaXRpb24oKTsKICAgICAgICBjYW52YXMuY3NzKHsKICAgICAgICAgICAgJ2xlZnQnOiBwb3MubGVmdCtkeCwKICAgICAgICAgICAgJ3RvcCc6IHBvcy50b3AtZHkKICAgICAgICB9KTsKICAgICAgICBjYW52YXMudHJpZ2dlcigndHJhbnNmb3JtZWQnLCBjYW52YXMpOwoKICAgICAgICB4MCA9IGUuY2xpZW50WDsKICAgICAgICB5MCA9IGUuY2xpZW50WTsKCiAgICB9OwoKICAgIHZhciBvbk1vdXNlVXAgPSBmdW5jdGlvbihlKXsKICAgICAgICB2aWV3cG9ydC5vbignbW91c2Vkb3duJywgb25Nb3VzZURvd24pOwogICAgICAgIHZpZXdwb3J0Lm9mZignbW91c2Vtb3ZlJywgb25Nb3VzZU1vdmUpOwogICAgICAgIHZpZXdwb3J0Lm9mZignbW91c2VvdXQnLCBvbk1vdXNlVXApOwogICAgICAgIHZpZXdwb3J0Lm9mZignbW91c2V1cCcsIG9uTW91c2VVcCk7CiAgICB9OwoKICAgIHZhciBvbk1vdXNlV2hlZWwgPSBmdW5jdGlvbihlKXsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKCiAgICAgICAgLy8gWm9vbSBpbiBvdXIgb3V0CiAgICAgICAgdmFyIGRlbHRhID0gMSArIChlLm9yaWdpbmFsRXZlbnQuZGVsdGFZPDAgPyB6b29tRmFjdG9yIDogLXpvb21GYWN0b3IpOwoKICAgICAgICAvLyBQb3NpdGlvbiByZWxhdGl2ZSB0byBjYW52YXMKICAgICAgICB2YXIgeFBvcyA9IGUucGFnZVggLSBjYW52YXMub2Zmc2V0KCkubGVmdDsKICAgICAgICB2YXIgeVBvcyA9IGUucGFnZVkgLSBjYW52YXMub2Zmc2V0KCkudG9wOwoKICAgICAgICAvLyBOb3JtYWxpemUgY3Vyc29yIHBvc2l0aW9uIHJlbGF0aXZlIHRvIGNhbnZhcwogICAgICAgIHZhciB4UmVsID0geFBvcy9jYW52YXMud2lkdGgoKTsKICAgICAgICB2YXIgeVJlbCA9IHlQb3MvY2FudmFzLmhlaWdodCgpOwoKICAgICAgICAvLyBDb21wdXRlIG5ldyBjYW52YXMgc2l6ZQogICAgICAgIHZhciBkeCA9IGRlbHRhKmNhbnZhcy53aWR0aCgpOwogICAgICAgIHZhciBkeSA9IGRlbHRhKmNhbnZhcy5oZWlnaHQoKTsKCiAgICAgICAgLy8gQ29tcHV0ZSBwcm9qZWN0aW9uIG9mIG9sZCBjdXJzb3IgcG9zaXRpb24gb24gbmV3IGNhbnZhcyBzaXplCiAgICAgICAgdmFyIHhQb3NOZXcgPSB4UmVsKmR4OwogICAgICAgIHZhciB5UG9zTmV3ID0geVJlbCpkeTsKCiAgICAgICAgdmFyIHBvcyA9IGNhbnZhcy5wb3NpdGlvbigpOwogICAgICAgIGNhbnZhcy5jc3MoewogICAgICAgICAgICAnd2lkdGgnOiBkeCwKICAgICAgICAgICAgJ2hlaWdodCc6IGR5LAogICAgICAgICAgICAnbGVmdCc6IHBvcy5sZWZ0IC0gKHhQb3NOZXcteFBvcyksCiAgICAgICAgICAgICd0b3AnOiBwb3MudG9wIC0gKHlQb3NOZXcteVBvcykKICAgICAgICB9KTsKICAgICAgICBjYW52YXMudHJpZ2dlcigndHJhbnNmb3JtZWQnLCBjYW52YXMpOwogICAgfTsKCiAgICB2aWV3cG9ydC5vbignbW91c2Vkb3duJywgb25Nb3VzZURvd24pOwogICAgdmlld3BvcnQub24oJ3doZWVsJywgb25Nb3VzZVdoZWVsKTsKICAgIHZpZXdwb3J0Lm9uKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uKGUpewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwp9CgppZighd2luZG93LkNWTElCKSB3aW5kb3cuQ1ZMSUIgPSB7fTsKd2luZG93LkNWTElCLkNvbnRyb2xzQmFzaWMgPSBDb250cm9sc0Jhc2ljOwoKfSkoKTsAJ3VzZSBzdHJpY3QnOyAvKiBnbG9iYWxzICQgQ1ZMSUIgKi8KKC8qKiBAbGVuZHMgbW9kdWxlOkNWTElCICovZnVuY3Rpb24oKXsKCgovLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCi8vIE5vdGUgKGN5cnVzaCk6Ci8vIFRoaXMgaXMgYSBtb2RpZmllZCB2ZXJzaW9uIG9mIERhdGFiYXNlU3BlY0EgdGhhdCBkb2VzCi8vIG5vdCB1c2UgQUpBWCB0byBsb2FkIHRoZSBqYXZhc2NyaXB0IHJlcAovLyBvZiB0aGUgZGF0YWJhc2VzLiBUaGlzIGFsbG93cyB1cyB0byB1c2UgdGhlIGNpbmVtYSBhcGkKLy8gd2l0aG91dCBhIHdlYnNlcnZlciAobm8gY3Jvc3Mtb3JpZ2luIGlzc3VlcykgYnkgZGlyZWN0bHkKLy8gaW5jbHVkaW5nIHRoZSBkYXRhYmFzZSBqYXZhc2NyaXB0IHJlcCAoaW5mbykgd2l0aCBhIHNjcmlwdAovLyB0YWcuCi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8KLyoqCiAqIERhdGFiYXNlIGZvciBhIFNwZWMgQSBpbWFnZSByZXBvc2l0b3J5CiAqIEBjb25zdHJ1Y3RvcgogKiBAYXVnbWVudHMgRGF0YWJhc2UKICogQHBhcmFtIHtzdHJpbmd9IHVybCAtIHBhdGggdG8gSlNPTiBmaWxlCiAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIC0gY2FsbGVkIGFmdGVyIERCIGluaXRpYWxpemF0aW9uIHdpdGggYSBRdWVyeVNldCBkZXNjcmliaW5nIHRoZSBEQiBTY2hlbWUKICovCmZ1bmN0aW9uIERhdGFiYXNlU3BlY0FfTm9BSkFYKGluZm8sIGNhbGxiYWNrKXsKICAgIENWTElCLkRhdGFiYXNlLmNhbGwoIHRoaXMgKTsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIC8vIHZhbGlkYXRlIG91ciBwYXNzZWQgaW5mbyBtZXRzIGNpbmVtYSBzcGVjIGEKICAgIGlmKCFzZWxmLnZhbGlkYXRlSlNPTihpbmZvKSkKICAgICAgICByZXR1cm47CiAgICAKICAgIHNlbGYuanNvbiA9IGluZm87CiAgICAvLyBkYXRhYmFzZSBkaXIgbXVzdCBiZSBzZXQsIGl0IGlzIHVzZWQgd2hlbiBmZXRjaGluZyByZXN1bHRzCiAgICBzZWxmLmpzb24uZGF0YWJhc2VEaXIgPSAnJzsKICAgIHZhciBwYXJhbWV0ZXJzID0ge307CiAgICBmb3IodmFyIGkgaW4gaW5mby5hcmd1bWVudHMpewogICAgICAgIHZhciBhcmcgPSBpbmZvLmFyZ3VtZW50c1tpXTsKICAgICAgICBwYXJhbWV0ZXJzW2ldID0gbmV3IENWTElCLlBhcmFtZXRlcigKICAgICAgICAgICAgYXJnLmxhYmVsLAogICAgICAgICAgICBhcmcudHlwZSwKICAgICAgICAgICAgYXJnLnZhbHVlcywKICAgICAgICAgICAgYXJnLmRlZmF1bHQKICAgICAgICApOwogICAgfQogICAgCiAgICBzZWxmLnF1ZXJ5U2V0ID0gbmV3IENWTElCLlF1ZXJ5U2V0KHBhcmFtZXRlcnMpOwp9CkRhdGFiYXNlU3BlY0FfTm9BSkFYLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIENWTElCLkRhdGFiYXNlLnByb3RvdHlwZSApOwpEYXRhYmFzZVNwZWNBX05vQUpBWC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBEYXRhYmFzZVNwZWNBX05vQUpBWDsKCi8qKgogKiBWYWxpZGF0ZSBpZiBKU09OIGZpbGUgaXMgY29tcGxpYW50IHRvIFNwZWMgQQogKiBAcGFyYW0ge0pTT059IGpzb24gLSBKU09OIG9iamVjdAogKiBAcmV0dXJuIHtib29sfQogKi8KRGF0YWJhc2VTcGVjQV9Ob0FKQVgucHJvdG90eXBlLnZhbGlkYXRlSlNPTiA9IGZ1bmN0aW9uKGpzb24pewogICAgY29uc29sZS5sb2coJ1Byb2Nlc3NpbmcgSlNPTi1GaWxlOicsIGpzb24pOwoKICAgIHZhciBwYXJzZUVycm9yRmxhZyA9IGZhbHNlOwogICAgdmFyIHBhcnNlRXJyb3IgPSBmdW5jdGlvbihtc2cpewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0pTT04tRmlsZSBkb2VzIG5vdCBtZWV0IFNwZWMgQTonLCBtc2cpOwogICAgICAgIHBhcnNlRXJyb3JGbGFnID0gdHJ1ZTsKICAgIH0uYmluZCh0aGlzKTsKCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvLyBDaGVjayBpZiBKU09OIG1lZXRzIFNwZWMgQQogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgaWYoICAgICFqc29uLmhhc093blByb3BlcnR5KCAnYXJndW1lbnRzJyAgICApCiAgICAgICAgfHwgIWpzb24uaGFzT3duUHJvcGVydHkoICdtZXRhZGF0YScgICAgICkKICAgICAgICB8fCAhanNvbi5oYXNPd25Qcm9wZXJ0eSggJ25hbWVfcGF0dGVybicgKQogICAgKXsKICAgICAgICBwYXJzZUVycm9yKCdKU09OLUZpbGUgaGFzIG5vIGF0dHJpYnV0ZSBcJ2FyZ3VtZW50c1wnLCBcJ21ldGFkYXRhXCcsIG9yIFwnbmFtZV9wYXR0ZXJuXCcnKTsKICAgIH0KICAgIC8vIENoZWNrIHVybCB0byBqc29uLmFyZ3VtZW50cyBjb25zaXN0YW5jeQogICAgaWYoICQudHlwZShqc29uLm5hbWVfcGF0dGVybikgIT09ICdzdHJpbmcnICl7CiAgICAgICAgcGFyc2VFcnJvcignanNvbi5uYW1lX3BhdHRlcm4gaXMgbm90IG9mIHR5cGUgXCdTdHJpbmdcJycpOwoKICAgIH0KICAgIHZhciBhcmd1bWVudExpc3QgPSBqc29uLm5hbWVfcGF0dGVybi5tYXRjaCgvXHsoLio/KVx9L2cpOwogICAgYXJndW1lbnRMaXN0LmZvckVhY2goZnVuY3Rpb24odixpKXsKICAgICAgICBhcmd1bWVudExpc3RbaV0gPSB2LnN1YnN0cmluZygxLHYubGVuZ3RoLTEpOwogICAgfSk7CgogICAgdmFyIGksajsKCiAgICAvLyBDaGVjayBFeGlzdGFuY2UKICAgIGZvcihpIGluIGFyZ3VtZW50TGlzdCl7CiAgICAgICAgaWYoIWpzb24uYXJndW1lbnRzLmhhc093blByb3BlcnR5KCBhcmd1bWVudExpc3RbaV0gKSkKICAgICAgICAgICAgcGFyc2VFcnJvcignQXJndW1lbnQgaW4gVVJMIGlzIG5vdCBzcGVjaWZpZWQgaW4ganNvbi5hcmd1bWVudHMnKTsKICAgIH0KCiAgICB2YXIgcGFyYW1ldGVyOwogICAgdmFyIGlzQ29udGFpbmVkID0gZmFsc2U7CiAgICB2YXIgdmFsdWVzID0gW107CiAgICBmb3IoaSBpbiBqc29uLmFyZ3VtZW50cyl7CiAgICAgICAgcGFyYW1ldGVyID0ganNvbi5hcmd1bWVudHNbaV07CiAgICAgICAgaWYoIXBhcmFtZXRlci5oYXNPd25Qcm9wZXJ0eSgnbGFiZWwnKSkgcGFyc2VFcnJvcignUGFyYW1ldGVyIGhhcyBubyBsYWJlbDonLCBwYXJhbWV0ZXIpOwogICAgICAgIGlmKCFwYXJhbWV0ZXIuaGFzT3duUHJvcGVydHkoJ2RlZmF1bHQnKSkgcGFyc2VFcnJvcignUGFyYW1ldGVyIGhhcyBubyBkZWZhdWx0IHZhbHVlJywgcGFyYW1ldGVyKTsKICAgICAgICBpZighcGFyYW1ldGVyLmhhc093blByb3BlcnR5KCd2YWx1ZXMnKSkgcGFyc2VFcnJvcignUGFyYW1ldGVyIGhhcyBubyBsaXN0IG9mIHZhbHVlcycsIHBhcmFtZXRlcik7CiAgICAgICAgc3dpdGNoIChwYXJhbWV0ZXIudHlwZSkgewogICAgICAgICAgICBjYXNlICdyYW5nZSc6CiAgICAgICAgICAgICAgICBpZighJC5pc051bWVyaWMocGFyYW1ldGVyLmRlZmF1bHQpKQogICAgICAgICAgICAgICAgICAgIHBhcnNlRXJyb3IoJ0RlZmF1bHQgdmFsdWUgb2YgcmFuZ2UgUGFyYW1ldGVyIGlzIG5vdCBOdW1lcmljJywgcGFyYW1ldGVyKTsKCiAgICAgICAgICAgICAgICAvLyBwYXJhbWV0ZXIuZGVmYXVsdCA9IHBhcnNlRmxvYXQocGFyYW1ldGVyLmRlZmF1bHQpOwogICAgICAgICAgICAgICAgcGFyYW1ldGVyLmRlZmF1bHQgPSBwYXJhbWV0ZXIuZGVmYXVsdDsKCiAgICAgICAgICAgICAgICB2YWx1ZXMgPSBbXTsKICAgICAgICAgICAgICAgIGlzQ29udGFpbmVkID0gZmFsc2U7CiAgICAgICAgICAgICAgICBmb3IoaiBpbiBwYXJhbWV0ZXIudmFsdWVzKXsKICAgICAgICAgICAgICAgICAgICBpZighJC5pc051bWVyaWMocGFyYW1ldGVyLnZhbHVlc1tqXSkpCiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlRXJyb3IoJ1BhcmFtZXRlciBpcyBvZiB0eXBlIFwncmFuZ2VcJyBidXQgbWVtYmVycyBvZiBpdHMgdmFsdWVzIGFyZSBub3QgTnVtZXJpYycsIHBhcmFtZXRlcik7CgogICAgICAgICAgICAgICAgICAgIC8vIHZhbHVlc1tqXSA9IHBhcnNlRmxvYXQocGFyYW1ldGVyLnZhbHVlc1tqXSk7CiAgICAgICAgICAgICAgICAgICAgdmFsdWVzW2pdID0gcGFyYW1ldGVyLnZhbHVlc1tqXTsKICAgICAgICAgICAgICAgICAgICBpZih2YWx1ZXNbal0gPT09IHBhcmFtZXRlci5kZWZhdWx0KSBpc0NvbnRhaW5lZCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZighaXNDb250YWluZWQpCiAgICAgICAgICAgICAgICAgICAgcGFyc2VFcnJvcignRGVmYXVsdCB2YWx1ZSBvZiBQYXJhbWV0ZXIgaXMgbm90IGNvbnRhaW5lZCBpbiB2YWx1ZXMnLCBwYXJhbWV0ZXIpOwoKICAgICAgICAgICAgICAgIHBhcmFtZXRlci52YWx1ZXMgPSB2YWx1ZXMuc29ydChmdW5jdGlvbihhLGIpeyByZXR1cm4gYS1iOyB9KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdib29sZWFuJzoKICAgICAgICAgICAgICAgIHBhcmFtZXRlci52YWx1ZXMgPSBbMCwxXTsKICAgICAgICAgICAgICAgIHBhcmFtZXRlci5kZWZhdWx0ID0gcGFyYW1ldGVyLmRlZmF1bHQgPyAxIDogMDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICdzZXQnOgogICAgICAgICAgICAgICAgaXNDb250YWluZWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIGZvcihqIGluIHBhcmFtZXRlci52YWx1ZXMpewogICAgICAgICAgICAgICAgICAgIGlmKHBhcmFtZXRlci52YWx1ZXNbal0gPT09IHBhcmFtZXRlci5kZWZhdWx0KSBpc0NvbnRhaW5lZCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBwYXJzZUVycm9yKCdVbmtub3duIFBhcmFtZXRlciBUeXBlJywgcGFyYW1ldGVyKTsKICAgICAgICB9CiAgICB9CgogICAgaWYocGFyc2VFcnJvckZsYWcpIHJldHVybiBmYWxzZTsKICAgIGNvbnNvbGUubG9nKCdWYWxpZCBTcGVjIEEgSlNPTi1GaWxlJyk7CiAgICByZXR1cm4gdHJ1ZTsKfTsKCi8qKgogKiBBc3luY2hyb25vdXNseSBwcm9jZXNzZXMgYSBxdWVyeVNldCBhbmQgcGFzc2VzIHRoZSByZXN1bHRTZXQgdG8gYSBjYWxsYmFjawogKiBAcGFyYW0ge1F1ZXJ5U2V0fSBxdWVyeVNldAogKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjawogKi8KRGF0YWJhc2VTcGVjQV9Ob0FKQVgucHJvdG90eXBlLnByb2Nlc3NRdWVyeSA9IGZ1bmN0aW9uKHF1ZXJ5U2V0LCBjYWxsYmFjayl7CiAgICB2YXIgaSxqOwoKICAgIHZhciBwYXR0ZXJuUmVwbGFjZSA9IGZ1bmN0aW9uKHBhdHRlcm4sIHBhcmFtZXRlcnMpewogICAgICAgIGZvcihpIGluIHBhcmFtZXRlcnMpewogICAgICAgICAgICBpZigkLmlzQXJyYXkocGFyYW1ldGVyc1tpXS5xdWVyeSkpIGNvbnRpbnVlOwogICAgICAgICAgICBwYXR0ZXJuID0gcGF0dGVybi5yZXBsYWNlKCd7JytpKyd9JywgcGFyYW1ldGVyc1tpXS5xdWVyeSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYXR0ZXJuOwogICAgfTsKCiAgICB2YXIgcmVwbGFjZUFsbCA9IGZ1bmN0aW9uKHN0cmluZywgc2VhcmNoLCByZXBsYWNlbWVudCkgewogICAgICAgIHJldHVybiBzdHJpbmcuc3BsaXQoc2VhcmNoKS5qb2luKHJlcGxhY2VtZW50KTsKICAgIH0KCiAgICB2YXIgcGF0dGVybiA9IHRoaXMuanNvbi5uYW1lX3BhdHRlcm47CiAgICB2YXIgZGlyID0gdGhpcy5qc29uLmRhdGFiYXNlRGlyOwogICAgdmFyIHJlc3VsdFNldDsKICAgIHN3aXRjaChxdWVyeVNldC5pbmZvLnR5cGUpewogICAgICAgIGNhc2UgJ3NpbmdsZSc6CiAgICAgICAgICAgIHJlc3VsdFNldCA9IG5ldyBDVkxJQi5SZXN1bHRTZXQoCiAgICAgICAgICAgICAgICBxdWVyeVNldC5zZXJpYWxpemUoKSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW1hZ2UnLAogICAgICAgICAgICAgICAgICAgIHNyYzogZGlyICsgcGF0dGVyblJlcGxhY2UocGF0dGVybiwgcXVlcnlTZXQucGFyYW1ldGVycyksCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ21hdHJpeCc6CiAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzID0gcXVlcnlTZXQucGFyYW1ldGVyczsKICAgICAgICAgICAgdmFyIGJhc2VQYXR0ZXJuID0gcGF0dGVyblJlcGxhY2UocGF0dGVybiwgcXVlcnlTZXQucGFyYW1ldGVycyk7CiAgICAgICAgICAgIHZhciBwMSA9IHF1ZXJ5U2V0LmluZm8ucDE7CiAgICAgICAgICAgIHZhciBwMiA9IHF1ZXJ5U2V0LmluZm8ucDI7CiAgICAgICAgICAgIHZhciBwMXEgPSBwYXJhbWV0ZXJzW3AxXS5xdWVyeTsKICAgICAgICAgICAgdmFyIHAycSA9IHBhcmFtZXRlcnNbcDJdLnF1ZXJ5OwogICAgICAgICAgICB2YXIgcDFxaSwgcDJxaTsKICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTsKICAgICAgICAgICAgZm9yKGkgaW4gcDFxKXsKICAgICAgICAgICAgICAgIHAxcWkgPSBwMXFbaV07CiAgICAgICAgICAgICAgICBkYXRhW3AxcWldID0ge307CiAgICAgICAgICAgICAgICBwYXR0ZXJuID0gYmFzZVBhdHRlcm4ucmVwbGFjZSgneycrcDErJ30nLCBwMXFpKTsKICAgICAgICAgICAgICAgIGZvcihqIGluIHAycSl7CiAgICAgICAgICAgICAgICAgICAgcDJxaSA9IHAycVtqXTsKICAgICAgICAgICAgICAgICAgICBkYXRhW3AxcWldW3AycWldID0gewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW1hZ2UnLAogICAgICAgICAgICAgICAgICAgICAgICBzcmM6IGRpciArIHBhdHRlcm4ucmVwbGFjZSgneycrcDIrJ30nLCBwMnFpKSwKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXN1bHRTZXQgPSBuZXcgQ1ZMSUIuUmVzdWx0U2V0KAogICAgICAgICAgICAgICAgcXVlcnlTZXQuc2VyaWFsaXplKCksCiAgICAgICAgICAgICAgICBkYXRhCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ3NlYXJjaCcgOgogICAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnM7CiAgICAgICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMocGFyYW1ldGVycykKICAgICAgICAgICAgdmFyIGRhdGEgPSBbXTsKCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBBZGQgYWxsIHBvc3NpYmxlIHJlc3VsdHMgZm9yIHRoZSBxdWVyaWVzIGZvciBhbGwgcGFyYW1ldGVycyBhdCBrZXlJbmRleCBhbmQgcGFzdCwKICAgICAgICAgICAgICogVXNpbmcgY3VycmVudFZhbHVlcyB0byBkZWZpbmUgdGhlIHZhbHVlcyBmb3IgcGFyYW1ldGVycyBiZWZvcmUga2V5SW5kZXguCiAgICAgICAgICAgICAqICh3b3JrcyByZWN1cnNpdmVseSkKICAgICAgICAgICAgICovCiAgICAgICAgICAgIHZhciBhZGRSZXN1bHRzID0gZnVuY3Rpb24oa2V5SW5kZXgsIGN1cnJlbnRWYWx1ZXMpIHsKICAgICAgICAgICAgICAgIHZhciBwID0gcGFyYW1ldGVyc1trZXlzW2tleUluZGV4XV07CiAgICAgICAgICAgICAgICBmb3IgKHEgaW4gcC5xdWVyeSkgewogICAgICAgICAgICAgICAgICAgIHZhciBuZXdWYWx1ZXMgPSAkLmV4dGVuZCh7fSxjdXJyZW50VmFsdWVzKTsvL0NvcHkgdmFsdWVzCiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWVzW2tleXNba2V5SW5kZXhdXSA9IHAucXVlcnlbcV07CiAgICAgICAgICAgICAgICAgICAgaWYgKGtleUluZGV4ID09IGtleXMubGVuZ3RoLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhdGggPSBwYXR0ZXJuOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIG5ld1ZhbHVlcykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGggPSByZXBsYWNlQWxsKHBhdGgsICd7JytpKyd9JywgbmV3VmFsdWVzW2ldKTsKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5wdXNoKHt0eXBlOidpbWFnZScsIHNyYzogZGlyICsgcGF0aCwgdmFsdWVzOiBuZXdWYWx1ZXN9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZFJlc3VsdHMoa2V5SW5kZXgrMSwgbmV3VmFsdWVzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9BZGQgYWxsIHJlc3VsdHMgZm9yIGFsbCBwYXJhbWV0ZXJzCiAgICAgICAgICAgIGFkZFJlc3VsdHMoMCx7fSk7CgogICAgICAgICAgICByZXN1bHRTZXQgPSBuZXcgQ1ZMSUIuUmVzdWx0U2V0KAogICAgICAgICAgICAgICAgcXVlcnlTZXQuc2VyaWFsaXplKCksCiAgICAgICAgICAgICAgICBkYXRhCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIGNhc2UgJ2NvbXBhcmUnIDoKICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSBxdWVyeVNldC5wYXJhbWV0ZXJzOwogICAgICAgICAgICB2YXIgYmFzZVBhdHRlcm4gPSBwYXR0ZXJuUmVwbGFjZShwYXR0ZXJuLCBxdWVyeVNldC5wYXJhbWV0ZXJzKTsKICAgICAgICAgICAgdmFyIHAgPSBxdWVyeVNldC5pbmZvLnA7CiAgICAgICAgICAgIHZhciBxID0gcGFyYW1ldGVyc1twXS5xdWVyeTsKICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTsKICAgICAgICAgICAgZm9yIChpIGluIHEpIHsKICAgICAgICAgICAgICAgIGRhdGFbaV0gPSB7CiAgICAgICAgICAgICAgICAgICAgdHlwZTogImltYWdlIiwKICAgICAgICAgICAgICAgICAgICBzcmM6IGRpciArIGJhc2VQYXR0ZXJuLnJlcGxhY2UoJ3snK3ArJ30nLCBxW2ldKQogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmVzdWx0U2V0ID0gbmV3IENWTElCLlJlc3VsdFNldCgKICAgICAgICAgICAgICAgIHF1ZXJ5U2V0LnNlcmlhbGl6ZSgpLAogICAgICAgICAgICAgICAgZGF0YQogICAgICAgICAgICApOwogICAgICAgICAgICBicmVhazsKICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdVbnN1cHBvcnRlZCBNb2RlOiAnICsgcXVlcnlTZXQuaW5mby50eXBlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgfQoKICAgIHF1ZXJ5U2V0LmVtaXR0ZXIudHJpZ2dlcigncHJvY2Vzc2VkJyk7CgogICAgY2FsbGJhY2soCiAgICAgICAgcmVzdWx0U2V0CiAgICApOwp9OwoKLyoqCiAqIEFzeW5jaHJvbm91c2x5IHByb2Nlc3NlcyBhIHF1ZXJ5U2V0IGFuZCBwYXNzZXMgdGhlIHJlc3VsdFNldCB0byBhIGNhbGxiYWNrCiAqIEFsbG93cyBmb3IgYSBjdXN0b21pemFibGUgbGFiZWwgdG8gYmUgYWRkZWQgdG8gZWFjaCBpbWFnZQogKiBAcGFyYW0ge1F1ZXJ5U2V0fSBxdWVyeVNldAogKiBAcGFyYW0ge1N0cmluZ30gICBsYWJlbAogKiBAcGFyYW0ge2Z1bmN0aW9ufSBjYWxsYmFjawogKi8KRGF0YWJhc2VTcGVjQV9Ob0FKQVgucHJvdG90eXBlLnByb2Nlc3NRdWVyeVdpdGhMYWJlbHMgPSBmdW5jdGlvbihxdWVyeVNldCwgbGFiZWwsIGNhbGxiYWNrKXsKCiAgICB2YXIgcmVwbGFjZUFsbCA9IGZ1bmN0aW9uKHN0cmluZywgc2VhcmNoLCByZXBsYWNlbWVudCkgewogICAgICAgIHJldHVybiBzdHJpbmcuc3BsaXQoc2VhcmNoKS5qb2luKHJlcGxhY2VtZW50KTsKICAgIH0KCiAgICB2YXIgcGF0dGVyblJlcGxhY2VBbGwgPSBmdW5jdGlvbihwYXR0ZXJuLCBwYXJhbWV0ZXJzKXsKICAgICAgICBmb3IodmFyIGkgaW4gcGFyYW1ldGVycyl7CiAgICAgICAgICAgIGlmKCQuaXNBcnJheShwYXJhbWV0ZXJzW2ldLnF1ZXJ5KSkgY29udGludWU7CiAgICAgICAgICAgIHBhdHRlcm4gPSByZXBsYWNlQWxsKHBhdHRlcm4sICd7JytwYXJhbWV0ZXJzW2ldLmxhYmVsKyd9JywgcGFyYW1ldGVyc1tpXS5xdWVyeSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBwYXR0ZXJuOwogICAgfTsKCiAgICB2YXIgYWRkTGFiZWxzID0gZnVuY3Rpb24ocmVzdWx0U2V0KSB7CiAgICAgICAgc3dpdGNoIChxdWVyeVNldC5pbmZvLnR5cGUpIHsKICAgICAgICAgICAgY2FzZSAnc2luZ2xlJyA6CiAgICAgICAgICAgICAgICBsYWJlbCA9IHBhdHRlcm5SZXBsYWNlQWxsKGxhYmVsLHF1ZXJ5U2V0LnBhcmFtZXRlcnMpOwogICAgICAgICAgICAgICAgJC5leHRlbmQocmVzdWx0U2V0LmRhdGEse2xhYmVsOiBsYWJlbH0pOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ21hdHJpeCcgOgogICAgICAgICAgICAgICAgdmFyIHZzMV9sYWJlbCA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnNbcXVlcnlTZXQuaW5mby5wMV0ubGFiZWw7CiAgICAgICAgICAgICAgICB2YXIgdnMyX2xhYmVsID0gcXVlcnlTZXQucGFyYW1ldGVyc1txdWVyeVNldC5pbmZvLnAyXS5sYWJlbDsKICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVzdWx0U2V0LmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqIGluIHJlc3VsdFNldC5kYXRhW2ldKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vVGhlIHRhZ3Mge3ZzMX0se3ZzMn0se3ZzMV9sYWJlbH0gYW5kIHt2czJfbGFiZWx9IGFyZQogICAgICAgICAgICAgICAgICAgICAgICAvL3JlcGxhY2VkIHdpdGggdmFsdWVzIHJlbGF0ZWQgdG8gdGhlIHR3byBwYXJhbWV0ZXJzIGJlaW5nIGNvbXBhcmVkCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdMYWJlbCA9IHBhdHRlcm5SZXBsYWNlQWxsKGxhYmVsLHF1ZXJ5U2V0LnBhcmFtZXRlcnMpOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7dnMxX2xhYmVsfScsdnMxX2xhYmVsKTsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3TGFiZWwgPSByZXBsYWNlQWxsKG5ld0xhYmVsLCAne3ZzMX0nLGkpOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7Jyt2czFfbGFiZWwrJ30nLGkpOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7dnMyX2xhYmVsfScsdnMyX2xhYmVsKTsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3TGFiZWwgPSByZXBsYWNlQWxsKG5ld0xhYmVsLCAne3ZzMn0nLGopOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7Jyt2czJfbGFiZWwrJ30nLGopOwogICAgICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZChyZXN1bHRTZXQuZGF0YVtpXVtqXSx7bGFiZWw6IG5ld0xhYmVsfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ3NlYXJjaCcgOgogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXN1bHRTZXQuZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciBuZXdMYWJlbCA9IGxhYmVsOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHZhbHVlIGluIHJlc3VsdFNldC5kYXRhW2ldLnZhbHVlcykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IHF1ZXJ5U2V0LnBhcmFtZXRlcnNbdmFsdWVdOwogICAgICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7JytwLmxhYmVsKyd9JyxyZXN1bHRTZXQuZGF0YVtpXS52YWx1ZXNbdmFsdWVdKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy9UaGUgdGFnIHtyZXN1bHR9IGlzIHJlcGxhY2VkIHdpdGggdGhlIHJlc3VsdCBudW1iZXIgb2YgdGhpcyBkYXRhIHBvaW50CiAgICAgICAgICAgICAgICAgICAgbmV3TGFiZWwgPSByZXBsYWNlQWxsKG5ld0xhYmVsLCAne3Jlc3VsdH0nLCBpKTsKICAgICAgICAgICAgICAgICAgICAkLmV4dGVuZChyZXN1bHRTZXQuZGF0YVtpXSx7bGFiZWw6IG5ld0xhYmVsfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnY29tcGFyZScgOgogICAgICAgICAgICAgICAgbGFiZWwgPSBwYXR0ZXJuUmVwbGFjZUFsbChsYWJlbCxxdWVyeVNldC5wYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIHZhciBwID0gcXVlcnlTZXQuaW5mby5wOwogICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSBxdWVyeVNldC5wYXJhbWV0ZXJzOwogICAgICAgICAgICAgICAgdmFyIHEgPSBwYXJhbWV0ZXJzW3BdLnF1ZXJ5OwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXN1bHRTZXQuZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobGFiZWwsJ3snK3BhcmFtZXRlcnNbcF0ubGFiZWwrJ30nLCBxW2ldKTsKICAgICAgICAgICAgICAgICAgICAvL1RoZSB0YWdzIHtjb21wYXJlfSBhbmQge2NvbXBhcmVfbGFiZWx9IGFyZSByZXBsYWNlZCB3aXRoIHZhbHVlcyByZWxhdGVkIHRvIHRoZSB2YWx1ZSBiZWluZyBjb21wYXJlZAogICAgICAgICAgICAgICAgICAgIG5ld0xhYmVsID0gcmVwbGFjZUFsbChuZXdMYWJlbCwgJ3tjb21wYXJlX2xhYmVsfScsIHBhcmFtZXRlcnNbcF0ubGFiZWwpOwogICAgICAgICAgICAgICAgICAgIG5ld0xhYmVsID0gcmVwbGFjZUFsbChuZXdMYWJlbCwgJ3tjb21wYXJlfScsIHFbaV0pOwogICAgICAgICAgICAgICAgICAgIC8vVGhlIHRhZ3Mge3Jlc3VsdH0gYW5kIHt2aWV3fSBhcmUgcmVwbGFjZWQgd2l0aCB0aGUgaW5kZXgKICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7dmlld30nLCBpKTsKICAgICAgICAgICAgICAgICAgICBuZXdMYWJlbCA9IHJlcGxhY2VBbGwobmV3TGFiZWwsICd7cmVzdWx0fScsIGkpOwogICAgICAgICAgICAgICAgICAgICQuZXh0ZW5kKHJlc3VsdFNldC5kYXRhW2ldLHtsYWJlbDogbmV3TGFiZWx9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGNhbGxiYWNrKAogICAgICAgICAgICByZXN1bHRTZXQKICAgICAgICApOwogICAgfQoKICAgIHRoaXMucHJvY2Vzc1F1ZXJ5KHF1ZXJ5U2V0LCBhZGRMYWJlbHMpOyAKfTsKCmlmKCF3aW5kb3cuQ1ZMSUIpIHdpbmRvdy5DVkxJQiA9IHt9Owp3aW5kb3cuQ1ZMSUIuRGF0YWJhc2VTcGVjQV9Ob0FKQVggPSBEYXRhYmFzZVNwZWNBX05vQUpBWDsKCn0pKCk7ACd1c2Ugc3RyaWN0JzsgLyogZ2xvYmFscyAkICovCigvKiogQGxlbmRzIG1vZHVsZTpDVkxJQiAqL2Z1bmN0aW9uKCl7CgovKioKICogUmVwcmVzZW50cyBhIHBhcmFtZXRlciB3aGljaCBjYW4gYmUgcXVlcmllZAogKiBAY29uc3RydWN0b3IKICogQHBhcmFtIHtzdHJpbmd9ICAgIGxhYmVsICAgLSBwYXJhbWV0ZXIgbGFiZWwKICogQHBhcmFtIHtzdHJpbmd9ICAgIHR5cGUgICAgLSBwYXJhbWV0ZXIgdHlwZQogKiBAcGFyYW0ge0FycmF5LjxUPn0gdmFsdWVzICAtIGxpc3Qgb2YgcGFyYW10ZXJzIHZhbHVlcwogKiBAcGFyYW0ge1R9ICAgICAgICAgcXVlcnkgICAtIGEgc3Vic2V0IG9mIHZhbHVlcwogKiBAcHJvcCAge3N0cmluZ30gICAgbGFiZWwgICAtIHBhcmFtZXRlciBsYWJlbAogKiBAcHJvcCAge3N0cmluZ30gICAgdHlwZSAgICAtIHBhcmFtZXRlciB0eXBlCiAqIEBwcm9wICB7QXJyYXkuPFQ+fSB2YWx1ZXMgIC0gbGlzdCBvZiBwYXJhbXRlcnMgdmFsdWVzCiAqIEBwcm9wICB7VH0gICAgICAgICBxdWVyeSAgIC0gYSBzdWJzZXQgb2YgdmFsdWVzCiAqIEBwcm9wICB7ZGl2fSAgICAgICBlbWl0dGVyIC0gZGl2IGVsZW1lbnQgdXNlZCB0byB0cmlnZ2VyIHdoZW4gcGFyYW1ldGVyIHdhcyB1cGRhdGVkCiAqLwpmdW5jdGlvbiBQYXJhbWV0ZXIobGFiZWwsIHR5cGUsIHZhbHVlcywgcXVlcnkpewogICAgdGhpcy5sYWJlbCA9IGxhYmVsOwogICAgdGhpcy50eXBlID0gdHlwZTsKICAgIHRoaXMudmFsdWVzID0gdmFsdWVzOwogICAgdGhpcy5xdWVyeSA9IHF1ZXJ5OwogICAgdGhpcy5lbWl0dGVyID0gJCgnPGRpdj48L2Rpdj4nKTsKfQoKLyoqCiAqIFNldHMgdGhlIHF1ZXJ5IHZhbHVlIG9mIGEgcGFyYW10ZXIgYW5kIHRyaWdnZXJzIGEgY2hhbmdlIGV2ZW50IHVubGVzcyBzdXBwcmVzc0NoYW5nZUV2ZW50IGlzIHRydWUKICogQHBhcmFtIHtUfSAgICBxdWVyeSAgICAgICAgICAgICAgIC0gdGFyZ2V0IHZhbHVlCiAqIEBwYXJhbSB7Ym9vbH0gc3VwcHJlc3NDaGFuZ2VFdmVudCAtIGlmIHRydWUgdGhlIGNoYW5nZSBldmVudCB3aWxsIG5vdCBiZSBmaXJlZAogKi8KUGFyYW1ldGVyLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uKHF1ZXJ5LCBzdXBwcmVzc0NoYW5nZUV2ZW50KXsKICAgIHRoaXMucXVlcnkgPSBxdWVyeTsKICAgIGlmKCFzdXBwcmVzc0NoYW5nZUV2ZW50KQogICAgICAgIHRoaXMuZW1pdHRlci50cmlnZ2VyKCdjaGFuZ2UnLCBbdGhpc10pOwp9OwoKLyoqCiAqIENyZWF0ZXMgYSBjbG9uZSBvZiB0aGUgcGFyYW1ldGVyCiAqIEByZXR1cm4ge1BhcmFtZXRlcn0KICovClBhcmFtZXRlci5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpewogICAgcmV0dXJuIG5ldyBQYXJhbWV0ZXIodGhpcy5sYWJlbCwgdGhpcy50eXBlLCB0aGlzLnZhbHVlcywgdGhpcy5xdWVyeSk7Cn07CgppZighd2luZG93LkNWTElCKSB3aW5kb3cuQ1ZMSUIgPSB7fTsKd2luZG93LkNWTElCLlBhcmFtZXRlciA9IFBhcmFtZXRlcjsKCn0pKCk7ACd1c2Ugc3RyaWN0JzsgLyogZ2xvYmFscyAkICovCigvKiogQGxlbmRzIG1vZHVsZTpDVkxJQiAqL2Z1bmN0aW9uKCl7CgovKioKICogUmVwcmVzZW50cyBhIHNldCBvZiByZXN1bHRzIGZvciBhIFF1ZXJ5U2V0CiAqIEBjb25zdHJ1Y3RvcgogKiBAcGFyYW0ge0pTT059IHNlcmlhbGl6ZWRRdWVyeVNldCAtIHNlcmlhbGl6ZWQgdmVyc2lvbiBvZiB0aGUgcmVxdWVzdGVkIFF1ZXJ5U2V0CiAqIEBwYXJhbSB7SlNPTn0gZGF0YSAgICAgICAgICAgICAgIC0gZGF0YSBvYmplY3QgY29udGFpbmcgdGhlIHJlc3BvbnNlIHRvIHRoZSByZXF1ZXN0ZWQgUXVlcnlTZXQKICogQHByb3Age0pTT059IHF1ZXJ5U2V0IC0gc2VyaWFsaXplZCB2ZXJzaW9uIG9mIHRoZSByZXF1ZXN0ZWQgUXVlcnlTZXQKICogQHByb3Age0pTT059IGRhdGEgICAgIC0gZGF0YSBvYmplY3QgY29udGFpbmcgdGhlIHJlc3BvbnNlIHRvIHRoZSByZXF1ZXN0ZWQgUXVlcnlTZXQKICovCmZ1bmN0aW9uIFJlc3VsdFNldChzZXJpYWxpemVkUXVlcnlTZXQsIGRhdGEpewogICAgdGhpcy5xdWVyeVNldCA9IHNlcmlhbGl6ZWRRdWVyeVNldDsKICAgIHRoaXMuZGF0YSA9IGRhdGE7Cn0KCmlmKCF3aW5kb3cuQ1ZMSUIpIHdpbmRvdy5DVkxJQiA9IHt9Owp3aW5kb3cuQ1ZMSUIuUmVzdWx0U2V0ID0gUmVzdWx0U2V0OwoKfSkoKTsAJ3VzZSBzdHJpY3QnOyAvKiBnbG9iYWxzICQgQ1ZMSUIqLwooLyoqIEBsZW5kcyBtb2R1bGU6Q1ZMSUIgKi9mdW5jdGlvbigpewoKLyoqCiAqIFJlbmRlcmVyIGZvciBTcGVjIEEgUmVzdWx0U2V0cwogKiBAY29uc3RydWN0b3IKICovCmZ1bmN0aW9uIFJlbmRlcmVyU3BlY0EoKXsKICAgIENWTElCLlJlbmRlcmVyLmNhbGwoIHRoaXMgKTsKCiAgICB0aGlzLmltYWdlTG9hZGVyID0ge307Cn0KUmVuZGVyZXJTcGVjQS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBDVkxJQi5SZW5kZXJlci5wcm90b3R5cGUgKTsKUmVuZGVyZXJTcGVjQS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBSZW5kZXJlclNwZWNBOwoKLyoqCiAqIFJlbmRlciBhbiBlbGVtZW50IHRvIGEgY2FudmFzIGFuZCBhYm9ydE9sZCByZW5kZXIgcHJvY2VzcyBpZiByZXF1ZXN0ZWQKICogQHBhcmFtIHtvYmplY3R9IGVsZW1lbnQgLSBlbGVtZW50IG9mIGEgc3BlYyBBIFJlc3VsdFNldAogKiBAcGFyYW0ge2NhbnZhc30gY2FudmFzSlEgLSBjYW52YXMgaW4gSlEgcmVwcmVzZW50YXRpb24KICogQHBhcmFtIHtib29sfSBhYm9ydE9sZCAtIGlmIHRydWUgYWJvcnQgb2xkIHJlbmRlciBwcm9jZXNzCiAqLwpSZW5kZXJlclNwZWNBLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbihlbGVtZW50LCBjYW52YXNKUSwgYWJvcnRPbGQsIGNhbGxiYWNrKXsKICAgIHZhciBjYW52YXMgPSBjYW52YXNKUVswXTsKICAgIHN3aXRjaCAoZWxlbWVudC50eXBlKSB7CiAgICAgICAgY2FzZSAnaW1hZ2UnOgogICAgICAgICAgICBpZihlbGVtZW50Lmhhc093blByb3BlcnR5KCdpbWcnKSkgewogICAgICAgICAgICAgICAgY2FudmFzLndpZHRoID0gZWxlbWVudC5pbWcud2lkdGg7CiAgICAgICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gZWxlbWVudC5pbWcuaGVpZ2h0OwogICAgICAgICAgICAgICAgY2FudmFzLmdldENvbnRleHQoJzJkJykuZHJhd0ltYWdlKGVsZW1lbnQuaW1nLCAwLCAwKTsKICAgICAgICAgICAgICAgIGNhbnZhcy5pbWcgPSBlbGVtZW50LmltZzsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuaW1hZ2VMb2FkZXIuaWdub3JlID0gYWJvcnRPbGQ7CiAgICAgICAgICAgICAgICB0aGlzLmltYWdlTG9hZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7CiAgICAgICAgICAgICAgICB0aGlzLmltYWdlTG9hZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5pZ25vcmUpIHJldHVybjsKCiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbWcgPSB0aGlzOwogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMud2lkdGggIT09IGNhbnZhcy53aWR0aCB8fCB0aGlzLmhlaWdodCAhPT0gY2FudmFzLmhlaWdodCl7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy53aWR0aCA9IHRoaXMud2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLmhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgICAgY2FudmFzSlEudHJpZ2dlcigncmVzaXplZCcpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKS5kcmF3SW1hZ2UodGhpcywgMCwgMCk7CiAgICAgICAgICAgICAgICAgICAgY2FudmFzLmltZyA9IGVsZW1lbnQuaW1nOwoKICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgdGhpcy5pbWFnZUxvYWRlci5zcmMgPSBlbGVtZW50LnNyYzsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgY29uc29sZS5lcnJvcignUmVuZGVyZXIgZG9lc25cJ3Qgc3VwcG9ydCBlbGVtZW50IHR5cGUnLCBlbGVtZW50LnR5cGUsIGVsZW1lbnQpOwogICAgfQp9OwoKaWYoIXdpbmRvdy5DVkxJQikgd2luZG93LkNWTElCID0ge307CndpbmRvdy5DVkxJQi5SZW5kZXJlclNwZWNBID0gUmVuZGVyZXJTcGVjQTsKCn0pKCk7ACd1c2Ugc3RyaWN0JzsgLyogZ2xvYmFscyAkICovCigvKiogQGxlbmRzIG1vZHVsZTpDVkxJQiAqL2Z1bmN0aW9uKCl7CgovKioKICogUmVwcmVzZW50cyBhIHNldCBvZiBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBxdWVyaWVkCiAqIEBjb25zdHJ1Y3RvcgogKiBAcGFyYW0ge29iamVjdH0gcGFyYW1ldGVycyAtIGxpc3Qgb2YgcGFyYW10ZXJzIHRvIHF1ZXJ5CiAqIEBwcm9wIHtkaXZ9IGVtaXR0ZXIgICAgIC0gZGl2IGVsZW1lbnQgdXNlZCB0byB0cmlnZ2VyIGFuZCBsaXN0ZW4gdG8gcXVlcnkgcmVsYXRlZCBldmVudHMKICogQHByb3Age0pTT059IHBhcmFtZXRlcnMgLSBvYmplY3QgcmVwcmVzZW50aW5nIGFsbCBxdWVyeWFibGUgcGFyYW1ldGVycwogKiBAcHJvcCB7SlNPTn0gaW5mbyAgICAgICAtIGdlbmVyaWMgaW5mb3JtYXRpb24gYWJvdXQgdGhlIFF1ZXJ5U2V0CiAqLwpmdW5jdGlvbiBRdWVyeVNldChwYXJhbWV0ZXJzKXsKCiAgICB0aGlzLmVtaXR0ZXIgPSAkKCc8ZGl2PjwvZGl2PicpOwogICAgdGhpcy5wYXJhbWV0ZXJzID0gcGFyYW1ldGVyczsKCiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICBmb3IodmFyIGkgaW4gdGhpcy5wYXJhbWV0ZXJzKXsKICAgICAgICB2YXIgcCA9IHRoaXMucGFyYW1ldGVyc1tpXTsKICAgICAgICB0aGlzLmVtaXR0ZXIuYXBwZW5kKHAuZW1pdHRlcik7CiAgICB9CgogICAgdGhpcy5pbmZvID0gewogICAgICAgIHR5cGU6ICdzaW5nbGUnCiAgICB9Owp9CgovKioKICogUmV0dXJucyBhIHNpbXBsaWZpZWQgSlNPTiB2ZXJzaW9uIG9mIHRoZSBvYmplY3QKICogQHJldHVybiB7SlNPTn0gc2ltcGxpZmllZCBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBRdWVyeVNldAogKi8KUXVlcnlTZXQucHJvdG90eXBlLnNlcmlhbGl6ZSA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyYW1ldGVycyA9IHt9OwogICAgZm9yKHZhciBpIGluIHRoaXMucGFyYW1ldGVycyl7CiAgICAgICAgdmFyIHAgPSB0aGlzLnBhcmFtZXRlcnNbaV07CiAgICAgICAgcGFyYW1ldGVyc1tpXSA9IHAucXVlcnk7CiAgICB9CgogICAgcmV0dXJuIHsKICAgICAgICBpbmZvOiB0aGlzLmluZm8sCiAgICAgICAgcGFyYW1ldGVyczogcGFyYW1ldGVycwogICAgfTsKfTsKClF1ZXJ5U2V0LnByb3RvdHlwZS5kZXNlcmlhbGl6ZSA9IGZ1bmN0aW9uKGpzb24pewogICAgaWYgKHRoaXMuaW5mby50eXBlID09IGpzb24uaW5mby50eXBlKSB7CiAgICAgICAgZm9yICh2YXIgaSBpbiBqc29uLnBhcmFtZXRlcnMpIHsKICAgICAgICAgICAgaWYgKHRoaXMucGFyYW1ldGVyc1tpXSkKICAgICAgICAgICAgICAgIHRoaXMucGFyYW1ldGVyc1tpXS5zZXRWYWx1ZShqc29uLnBhcmFtZXRlcnNbaV0pOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRXJyb3I6IENvdWxkIG5vdCBsb2FkIHBhcmFtZXRlciAiICsgaSk7CiAgICAgICAgfQogICAgfQogICAgZWxzZQogICAgICAgIGNvbnNvbGUubG9nKCJFcnJvcjogQ291bGQgbm90IGxvYWQgcXVlcnkgb2YgZGlmZmVyZW50IHR5cGUiKQp9CgovKioKICogQ3JlYXRlcyBhIGNsb25lIG9mIHRoZSBRdWVyeVNldAogKiBAcmV0dXJuIHtRdWVyeVNldH0KICovClF1ZXJ5U2V0LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCl7CiAgICB2YXIgcGFyYW1ldGVycyA9IHt9OwogICAgZm9yKHZhciBpIGluIHRoaXMucGFyYW1ldGVycyl7CiAgICAgICAgcGFyYW1ldGVyc1tpXSA9IHRoaXMucGFyYW1ldGVyc1tpXS5jbG9uZSgpOwogICAgfQogICAgcmV0dXJuIG5ldyBRdWVyeVNldCggcGFyYW1ldGVycyApOwp9OwoKaWYoIXdpbmRvdy5DVkxJQikgd2luZG93LkNWTElCID0ge307CndpbmRvdy5DVkxJQi5RdWVyeVNldCA9IFF1ZXJ5U2V0OwoKfSkoKTsALyohIGpRdWVyeSB2My4xLjEgfCAoYykgalF1ZXJ5IEZvdW5kYXRpb24gfCBqcXVlcnkub3JnL2xpY2Vuc2UgKi8KIWZ1bmN0aW9uKGEsYil7InVzZSBzdHJpY3QiOyJvYmplY3QiPT10eXBlb2YgbW9kdWxlJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZS5leHBvcnRzP21vZHVsZS5leHBvcnRzPWEuZG9jdW1lbnQ/YihhLCEwKTpmdW5jdGlvbihhKXtpZighYS5kb2N1bWVudCl0aHJvdyBuZXcgRXJyb3IoImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnQiKTtyZXR1cm4gYihhKX06YihhKX0oInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3c/d2luZG93OnRoaXMsZnVuY3Rpb24oYSxiKXsidXNlIHN0cmljdCI7dmFyIGM9W10sZD1hLmRvY3VtZW50LGU9T2JqZWN0LmdldFByb3RvdHlwZU9mLGY9Yy5zbGljZSxnPWMuY29uY2F0LGg9Yy5wdXNoLGk9Yy5pbmRleE9mLGo9e30saz1qLnRvU3RyaW5nLGw9ai5oYXNPd25Qcm9wZXJ0eSxtPWwudG9TdHJpbmcsbj1tLmNhbGwoT2JqZWN0KSxvPXt9O2Z1bmN0aW9uIHAoYSxiKXtiPWJ8fGQ7dmFyIGM9Yi5jcmVhdGVFbGVtZW50KCJzY3JpcHQiKTtjLnRleHQ9YSxiLmhlYWQuYXBwZW5kQ2hpbGQoYykucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjKX12YXIgcT0iMy4xLjEiLHI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHIuZm4uaW5pdChhLGIpfSxzPS9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZyx0PS9eLW1zLS8sdT0vLShbYS16XSkvZyx2PWZ1bmN0aW9uKGEsYil7cmV0dXJuIGIudG9VcHBlckNhc2UoKX07ci5mbj1yLnByb3RvdHlwZT17anF1ZXJ5OnEsY29uc3RydWN0b3I6cixsZW5ndGg6MCx0b0FycmF5OmZ1bmN0aW9uKCl7cmV0dXJuIGYuY2FsbCh0aGlzKX0sZ2V0OmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hP2YuY2FsbCh0aGlzKTphPDA/dGhpc1thK3RoaXMubGVuZ3RoXTp0aGlzW2FdfSxwdXNoU3RhY2s6ZnVuY3Rpb24oYSl7dmFyIGI9ci5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksYSk7cmV0dXJuIGIucHJldk9iamVjdD10aGlzLGJ9LGVhY2g6ZnVuY3Rpb24oYSl7cmV0dXJuIHIuZWFjaCh0aGlzLGEpfSxtYXA6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKHIubWFwKHRoaXMsZnVuY3Rpb24oYixjKXtyZXR1cm4gYS5jYWxsKGIsYyxiKX0pKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZi5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSxmaXJzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKDApfSxsYXN0OmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXEoLTEpfSxlcTpmdW5jdGlvbihhKXt2YXIgYj10aGlzLmxlbmd0aCxjPSthKyhhPDA/YjowKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soYz49MCYmYzxiP1t0aGlzW2NdXTpbXSl9LGVuZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLnByZXZPYmplY3R8fHRoaXMuY29uc3RydWN0b3IoKX0scHVzaDpoLHNvcnQ6Yy5zb3J0LHNwbGljZTpjLnNwbGljZX0sci5leHRlbmQ9ci5mbi5leHRlbmQ9ZnVuY3Rpb24oKXt2YXIgYSxiLGMsZCxlLGYsZz1hcmd1bWVudHNbMF18fHt9LGg9MSxpPWFyZ3VtZW50cy5sZW5ndGgsaj0hMTtmb3IoImJvb2xlYW4iPT10eXBlb2YgZyYmKGo9ZyxnPWFyZ3VtZW50c1toXXx8e30saCsrKSwib2JqZWN0Ij09dHlwZW9mIGd8fHIuaXNGdW5jdGlvbihnKXx8KGc9e30pLGg9PT1pJiYoZz10aGlzLGgtLSk7aDxpO2grKylpZihudWxsIT0oYT1hcmd1bWVudHNbaF0pKWZvcihiIGluIGEpYz1nW2JdLGQ9YVtiXSxnIT09ZCYmKGomJmQmJihyLmlzUGxhaW5PYmplY3QoZCl8fChlPXIuaXNBcnJheShkKSkpPyhlPyhlPSExLGY9YyYmci5pc0FycmF5KGMpP2M6W10pOmY9YyYmci5pc1BsYWluT2JqZWN0KGMpP2M6e30sZ1tiXT1yLmV4dGVuZChqLGYsZCkpOnZvaWQgMCE9PWQmJihnW2JdPWQpKTtyZXR1cm4gZ30sci5leHRlbmQoe2V4cGFuZG86ImpRdWVyeSIrKHErTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXEQvZywiIiksaXNSZWFkeTohMCxlcnJvcjpmdW5jdGlvbihhKXt0aHJvdyBuZXcgRXJyb3IoYSl9LG5vb3A6ZnVuY3Rpb24oKXt9LGlzRnVuY3Rpb246ZnVuY3Rpb24oYSl7cmV0dXJuImZ1bmN0aW9uIj09PXIudHlwZShhKX0saXNBcnJheTpBcnJheS5pc0FycmF5LGlzV2luZG93OmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hJiZhPT09YS53aW5kb3d9LGlzTnVtZXJpYzpmdW5jdGlvbihhKXt2YXIgYj1yLnR5cGUoYSk7cmV0dXJuKCJudW1iZXIiPT09Ynx8InN0cmluZyI9PT1iKSYmIWlzTmFOKGEtcGFyc2VGbG9hdChhKSl9LGlzUGxhaW5PYmplY3Q6ZnVuY3Rpb24oYSl7dmFyIGIsYztyZXR1cm4hKCFhfHwiW29iamVjdCBPYmplY3RdIiE9PWsuY2FsbChhKSkmJighKGI9ZShhKSl8fChjPWwuY2FsbChiLCJjb25zdHJ1Y3RvciIpJiZiLmNvbnN0cnVjdG9yLCJmdW5jdGlvbiI9PXR5cGVvZiBjJiZtLmNhbGwoYyk9PT1uKSl9LGlzRW1wdHlPYmplY3Q6ZnVuY3Rpb24oYSl7dmFyIGI7Zm9yKGIgaW4gYSlyZXR1cm4hMTtyZXR1cm4hMH0sdHlwZTpmdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09YT9hKyIiOiJvYmplY3QiPT10eXBlb2YgYXx8ImZ1bmN0aW9uIj09dHlwZW9mIGE/altrLmNhbGwoYSldfHwib2JqZWN0Ijp0eXBlb2YgYX0sZ2xvYmFsRXZhbDpmdW5jdGlvbihhKXtwKGEpfSxjYW1lbENhc2U6ZnVuY3Rpb24oYSl7cmV0dXJuIGEucmVwbGFjZSh0LCJtcy0iKS5yZXBsYWNlKHUsdil9LG5vZGVOYW1lOmZ1bmN0aW9uKGEsYil7cmV0dXJuIGEubm9kZU5hbWUmJmEubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PWIudG9Mb3dlckNhc2UoKX0sZWFjaDpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MDtpZih3KGEpKXtmb3IoYz1hLmxlbmd0aDtkPGM7ZCsrKWlmKGIuY2FsbChhW2RdLGQsYVtkXSk9PT0hMSlicmVha31lbHNlIGZvcihkIGluIGEpaWYoYi5jYWxsKGFbZF0sZCxhW2RdKT09PSExKWJyZWFrO3JldHVybiBhfSx0cmltOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsPT1hPyIiOihhKyIiKS5yZXBsYWNlKHMsIiIpfSxtYWtlQXJyYXk6ZnVuY3Rpb24oYSxiKXt2YXIgYz1ifHxbXTtyZXR1cm4gbnVsbCE9YSYmKHcoT2JqZWN0KGEpKT9yLm1lcmdlKGMsInN0cmluZyI9PXR5cGVvZiBhP1thXTphKTpoLmNhbGwoYyxhKSksY30saW5BcnJheTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIG51bGw9PWI/LTE6aS5jYWxsKGIsYSxjKX0sbWVyZ2U6ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9K2IubGVuZ3RoLGQ9MCxlPWEubGVuZ3RoO2Q8YztkKyspYVtlKytdPWJbZF07cmV0dXJuIGEubGVuZ3RoPWUsYX0sZ3JlcDpmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkLGU9W10sZj0wLGc9YS5sZW5ndGgsaD0hYztmPGc7ZisrKWQ9IWIoYVtmXSxmKSxkIT09aCYmZS5wdXNoKGFbZl0pO3JldHVybiBlfSxtYXA6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj0wLGg9W107aWYodyhhKSlmb3IoZD1hLmxlbmd0aDtmPGQ7ZisrKWU9YihhW2ZdLGYsYyksbnVsbCE9ZSYmaC5wdXNoKGUpO2Vsc2UgZm9yKGYgaW4gYSllPWIoYVtmXSxmLGMpLG51bGwhPWUmJmgucHVzaChlKTtyZXR1cm4gZy5hcHBseShbXSxoKX0sZ3VpZDoxLHByb3h5OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlO2lmKCJzdHJpbmciPT10eXBlb2YgYiYmKGM9YVtiXSxiPWEsYT1jKSxyLmlzRnVuY3Rpb24oYSkpcmV0dXJuIGQ9Zi5jYWxsKGFyZ3VtZW50cywyKSxlPWZ1bmN0aW9uKCl7cmV0dXJuIGEuYXBwbHkoYnx8dGhpcyxkLmNvbmNhdChmLmNhbGwoYXJndW1lbnRzKSkpfSxlLmd1aWQ9YS5ndWlkPWEuZ3VpZHx8ci5ndWlkKyssZX0sbm93OkRhdGUubm93LHN1cHBvcnQ6b30pLCJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihyLmZuW1N5bWJvbC5pdGVyYXRvcl09Y1tTeW1ib2wuaXRlcmF0b3JdKSxyLmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IgU3ltYm9sIi5zcGxpdCgiICIpLGZ1bmN0aW9uKGEsYil7alsiW29iamVjdCAiK2IrIl0iXT1iLnRvTG93ZXJDYXNlKCl9KTtmdW5jdGlvbiB3KGEpe3ZhciBiPSEhYSYmImxlbmd0aCJpbiBhJiZhLmxlbmd0aCxjPXIudHlwZShhKTtyZXR1cm4iZnVuY3Rpb24iIT09YyYmIXIuaXNXaW5kb3coYSkmJigiYXJyYXkiPT09Y3x8MD09PWJ8fCJudW1iZXIiPT10eXBlb2YgYiYmYj4wJiZiLTEgaW4gYSl9dmFyIHg9ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaSxqLGssbCxtLG4sbyxwLHEscixzLHQsdT0ic2l6emxlIisxKm5ldyBEYXRlLHY9YS5kb2N1bWVudCx3PTAseD0wLHk9aGEoKSx6PWhhKCksQT1oYSgpLEI9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT09PWImJihsPSEwKSwwfSxDPXt9Lmhhc093blByb3BlcnR5LEQ9W10sRT1ELnBvcCxGPUQucHVzaCxHPUQucHVzaCxIPUQuc2xpY2UsST1mdW5jdGlvbihhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylpZihhW2NdPT09YilyZXR1cm4gYztyZXR1cm4tMX0sSj0iY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLEs9IltcXHgyMFxcdFxcclxcblxcZl0iLEw9Iig/OlxcXFwufFtcXHctXXxbXlwwLVxceGEwXSkrIixNPSJcXFsiK0srIiooIitMKyIpKD86IitLKyIqKFsqXiR8IX5dPz0pIitLKyIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIrTCsiKSl8KSIrSysiKlxcXSIsTj0iOigiK0wrIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiK00rIikqKXwuKilcXCl8KSIsTz1uZXcgUmVnRXhwKEsrIisiLCJnIiksUD1uZXcgUmVnRXhwKCJeIitLKyIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiK0srIiskIiwiZyIpLFE9bmV3IFJlZ0V4cCgiXiIrSysiKiwiK0srIioiKSxSPW5ldyBSZWdFeHAoIl4iK0srIiooWz4rfl18IitLKyIpIitLKyIqIiksUz1uZXcgUmVnRXhwKCI9IitLKyIqKFteXFxdJ1wiXSo/KSIrSysiKlxcXSIsImciKSxUPW5ldyBSZWdFeHAoTiksVT1uZXcgUmVnRXhwKCJeIitMKyIkIiksVj17SUQ6bmV3IFJlZ0V4cCgiXiMoIitMKyIpIiksQ0xBU1M6bmV3IFJlZ0V4cCgiXlxcLigiK0wrIikiKSxUQUc6bmV3IFJlZ0V4cCgiXigiK0wrInxbKl0pIiksQVRUUjpuZXcgUmVnRXhwKCJeIitNKSxQU0VVRE86bmV3IFJlZ0V4cCgiXiIrTiksQ0hJTEQ6bmV3IFJlZ0V4cCgiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFwoIitLKyIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIitLKyIqKD86KFsrLV18KSIrSysiKihcXGQrKXwpKSIrSysiKlxcKXwpIiwiaSIpLGJvb2w6bmV3IFJlZ0V4cCgiXig/OiIrSisiKSQiLCJpIiksbmVlZHNDb250ZXh0Om5ldyBSZWdFeHAoIl4iK0srIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIrSysiKigoPzotXFxkKT9cXGQqKSIrSysiKlxcKXwpKD89W14tXXwkKSIsImkiKX0sVz0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLFg9L15oXGQkL2ksWT0vXltee10rXHtccypcW25hdGl2ZSBcdy8sWj0vXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLCQ9L1srfl0vLF89bmV3IFJlZ0V4cCgiXFxcXChbXFxkYS1mXXsxLDZ9IitLKyI/fCgiK0srIil8LikiLCJpZyIpLGFhPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD0iMHgiK2ItNjU1MzY7cmV0dXJuIGQhPT1kfHxjP2I6ZDwwP1N0cmluZy5mcm9tQ2hhckNvZGUoZCs2NTUzNik6U3RyaW5nLmZyb21DaGFyQ29kZShkPj4xMHw1NTI5NiwxMDIzJmR8NTYzMjApfSxiYT0vKFtcMC1ceDFmXHg3Zl18Xi0/XGQpfF4tJHxbXlwwLVx4MWZceDdmLVx1RkZGRlx3LV0vZyxjYT1mdW5jdGlvbihhLGIpe3JldHVybiBiPyJcMCI9PT1hPyJcdWZmZmQiOmEuc2xpY2UoMCwtMSkrIlxcIithLmNoYXJDb2RlQXQoYS5sZW5ndGgtMSkudG9TdHJpbmcoMTYpKyIgIjoiXFwiK2F9LGRhPWZ1bmN0aW9uKCl7bSgpfSxlYT10YShmdW5jdGlvbihhKXtyZXR1cm4gYS5kaXNhYmxlZD09PSEwJiYoImZvcm0iaW4gYXx8ImxhYmVsImluIGEpfSx7ZGlyOiJwYXJlbnROb2RlIixuZXh0OiJsZWdlbmQifSk7dHJ5e0cuYXBwbHkoRD1ILmNhbGwodi5jaGlsZE5vZGVzKSx2LmNoaWxkTm9kZXMpLERbdi5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZmEpe0c9e2FwcGx5OkQubGVuZ3RoP2Z1bmN0aW9uKGEsYil7Ri5hcHBseShhLEguY2FsbChiKSl9OmZ1bmN0aW9uKGEsYil7dmFyIGM9YS5sZW5ndGgsZD0wO3doaWxlKGFbYysrXT1iW2QrK10pO2EubGVuZ3RoPWMtMX19fWZ1bmN0aW9uIGdhKGEsYixkLGUpe3ZhciBmLGgsaixrLGwsbyxyLHM9YiYmYi5vd25lckRvY3VtZW50LHc9Yj9iLm5vZGVUeXBlOjk7aWYoZD1kfHxbXSwic3RyaW5nIiE9dHlwZW9mIGF8fCFhfHwxIT09dyYmOSE9PXcmJjExIT09dylyZXR1cm4gZDtpZighZSYmKChiP2Iub3duZXJEb2N1bWVudHx8Yjp2KSE9PW4mJm0oYiksYj1ifHxuLHApKXtpZigxMSE9PXcmJihsPVouZXhlYyhhKSkpaWYoZj1sWzFdKXtpZig5PT09dyl7aWYoIShqPWIuZ2V0RWxlbWVudEJ5SWQoZikpKXJldHVybiBkO2lmKGouaWQ9PT1mKXJldHVybiBkLnB1c2goaiksZH1lbHNlIGlmKHMmJihqPXMuZ2V0RWxlbWVudEJ5SWQoZikpJiZ0KGIsaikmJmouaWQ9PT1mKXJldHVybiBkLnB1c2goaiksZH1lbHNle2lmKGxbMl0pcmV0dXJuIEcuYXBwbHkoZCxiLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpKSxkO2lmKChmPWxbM10pJiZjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gRy5hcHBseShkLGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShmKSksZH1pZihjLnFzYSYmIUFbYSsiICJdJiYoIXF8fCFxLnRlc3QoYSkpKXtpZigxIT09dylzPWIscj1hO2Vsc2UgaWYoIm9iamVjdCIhPT1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpeyhrPWIuZ2V0QXR0cmlidXRlKCJpZCIpKT9rPWsucmVwbGFjZShiYSxjYSk6Yi5zZXRBdHRyaWJ1dGUoImlkIixrPXUpLG89ZyhhKSxoPW8ubGVuZ3RoO3doaWxlKGgtLSlvW2hdPSIjIitrKyIgIitzYShvW2hdKTtyPW8uam9pbigiLCIpLHM9JC50ZXN0KGEpJiZxYShiLnBhcmVudE5vZGUpfHxifWlmKHIpdHJ5e3JldHVybiBHLmFwcGx5KGQscy5xdWVyeVNlbGVjdG9yQWxsKHIpKSxkfWNhdGNoKHgpe31maW5hbGx5e2s9PT11JiZiLnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiBpKGEucmVwbGFjZShQLCIkMSIpLGIsZCxlKX1mdW5jdGlvbiBoYSgpe3ZhciBhPVtdO2Z1bmN0aW9uIGIoYyxlKXtyZXR1cm4gYS5wdXNoKGMrIiAiKT5kLmNhY2hlTGVuZ3RoJiZkZWxldGUgYlthLnNoaWZ0KCldLGJbYysiICJdPWV9cmV0dXJuIGJ9ZnVuY3Rpb24gaWEoYSl7cmV0dXJuIGFbdV09ITAsYX1mdW5jdGlvbiBqYShhKXt2YXIgYj1uLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0Iik7dHJ5e3JldHVybiEhYShiKX1jYXRjaChjKXtyZXR1cm4hMX1maW5hbGx5e2IucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGIpLGI9bnVsbH19ZnVuY3Rpb24ga2EoYSxiKXt2YXIgYz1hLnNwbGl0KCJ8IiksZT1jLmxlbmd0aDt3aGlsZShlLS0pZC5hdHRySGFuZGxlW2NbZV1dPWJ9ZnVuY3Rpb24gbGEoYSxiKXt2YXIgYz1iJiZhLGQ9YyYmMT09PWEubm9kZVR5cGUmJjE9PT1iLm5vZGVUeXBlJiZhLnNvdXJjZUluZGV4LWIuc291cmNlSW5kZXg7aWYoZClyZXR1cm4gZDtpZihjKXdoaWxlKGM9Yy5uZXh0U2libGluZylpZihjPT09YilyZXR1cm4tMTtyZXR1cm4gYT8xOi0xfWZ1bmN0aW9uIG1hKGEpe3JldHVybiBmdW5jdGlvbihiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuImlucHV0Ij09PWMmJmIudHlwZT09PWF9fWZ1bmN0aW9uIG5hKGEpe3JldHVybiBmdW5jdGlvbihiKXt2YXIgYz1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7cmV0dXJuKCJpbnB1dCI9PT1jfHwiYnV0dG9uIj09PWMpJiZiLnR5cGU9PT1hfX1mdW5jdGlvbiBvYShhKXtyZXR1cm4gZnVuY3Rpb24oYil7cmV0dXJuImZvcm0iaW4gYj9iLnBhcmVudE5vZGUmJmIuZGlzYWJsZWQ9PT0hMT8ibGFiZWwiaW4gYj8ibGFiZWwiaW4gYi5wYXJlbnROb2RlP2IucGFyZW50Tm9kZS5kaXNhYmxlZD09PWE6Yi5kaXNhYmxlZD09PWE6Yi5pc0Rpc2FibGVkPT09YXx8Yi5pc0Rpc2FibGVkIT09IWEmJmVhKGIpPT09YTpiLmRpc2FibGVkPT09YToibGFiZWwiaW4gYiYmYi5kaXNhYmxlZD09PWF9fWZ1bmN0aW9uIHBhKGEpe3JldHVybiBpYShmdW5jdGlvbihiKXtyZXR1cm4gYj0rYixpYShmdW5jdGlvbihjLGQpe3ZhciBlLGY9YShbXSxjLmxlbmd0aCxiKSxnPWYubGVuZ3RoO3doaWxlKGctLSljW2U9ZltnXV0mJihjW2VdPSEoZFtlXT1jW2VdKSl9KX0pfWZ1bmN0aW9uIHFhKGEpe3JldHVybiBhJiYidW5kZWZpbmVkIiE9dHlwZW9mIGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmF9Yz1nYS5zdXBwb3J0PXt9LGY9Z2EuaXNYTUw9ZnVuY3Rpb24oYSl7dmFyIGI9YSYmKGEub3duZXJEb2N1bWVudHx8YSkuZG9jdW1lbnRFbGVtZW50O3JldHVybiEhYiYmIkhUTUwiIT09Yi5ub2RlTmFtZX0sbT1nYS5zZXREb2N1bWVudD1mdW5jdGlvbihhKXt2YXIgYixlLGc9YT9hLm93bmVyRG9jdW1lbnR8fGE6djtyZXR1cm4gZyE9PW4mJjk9PT1nLm5vZGVUeXBlJiZnLmRvY3VtZW50RWxlbWVudD8obj1nLG89bi5kb2N1bWVudEVsZW1lbnQscD0hZihuKSx2IT09biYmKGU9bi5kZWZhdWx0VmlldykmJmUudG9wIT09ZSYmKGUuYWRkRXZlbnRMaXN0ZW5lcj9lLmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIsZGEsITEpOmUuYXR0YWNoRXZlbnQmJmUuYXR0YWNoRXZlbnQoIm9udW5sb2FkIixkYSkpLGMuYXR0cmlidXRlcz1qYShmdW5jdGlvbihhKXtyZXR1cm4gYS5jbGFzc05hbWU9ImkiLCFhLmdldEF0dHJpYnV0ZSgiY2xhc3NOYW1lIil9KSxjLmdldEVsZW1lbnRzQnlUYWdOYW1lPWphKGZ1bmN0aW9uKGEpe3JldHVybiBhLmFwcGVuZENoaWxkKG4uY3JlYXRlQ29tbWVudCgiIikpLCFhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RofSksYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lPVkudGVzdChuLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpLGMuZ2V0QnlJZD1qYShmdW5jdGlvbihhKXtyZXR1cm4gby5hcHBlbmRDaGlsZChhKS5pZD11LCFuLmdldEVsZW1lbnRzQnlOYW1lfHwhbi5nZXRFbGVtZW50c0J5TmFtZSh1KS5sZW5ndGh9KSxjLmdldEJ5SWQ/KGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShfLGFhKTtyZXR1cm4gZnVuY3Rpb24oYSl7cmV0dXJuIGEuZ2V0QXR0cmlidXRlKCJpZCIpPT09Yn19LGQuZmluZC5JRD1mdW5jdGlvbihhLGIpe2lmKCJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50QnlJZCYmcCl7dmFyIGM9Yi5nZXRFbGVtZW50QnlJZChhKTtyZXR1cm4gYz9bY106W119fSk6KGQuZmlsdGVyLklEPWZ1bmN0aW9uKGEpe3ZhciBiPWEucmVwbGFjZShfLGFhKTtyZXR1cm4gZnVuY3Rpb24oYSl7dmFyIGM9InVuZGVmaW5lZCIhPXR5cGVvZiBhLmdldEF0dHJpYnV0ZU5vZGUmJmEuZ2V0QXR0cmlidXRlTm9kZSgiaWQiKTtyZXR1cm4gYyYmYy52YWx1ZT09PWJ9fSxkLmZpbmQuSUQ9ZnVuY3Rpb24oYSxiKXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIGIuZ2V0RWxlbWVudEJ5SWQmJnApe3ZhciBjLGQsZSxmPWIuZ2V0RWxlbWVudEJ5SWQoYSk7aWYoZil7aWYoYz1mLmdldEF0dHJpYnV0ZU5vZGUoImlkIiksYyYmYy52YWx1ZT09PWEpcmV0dXJuW2ZdO2U9Yi5nZXRFbGVtZW50c0J5TmFtZShhKSxkPTA7d2hpbGUoZj1lW2QrK10paWYoYz1mLmdldEF0dHJpYnV0ZU5vZGUoImlkIiksYyYmYy52YWx1ZT09PWEpcmV0dXJuW2ZdfXJldHVybltdfX0pLGQuZmluZC5UQUc9Yy5nZXRFbGVtZW50c0J5VGFnTmFtZT9mdW5jdGlvbihhLGIpe3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgYi5nZXRFbGVtZW50c0J5VGFnTmFtZT9iLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpOmMucXNhP2IucXVlcnlTZWxlY3RvckFsbChhKTp2b2lkIDB9OmZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPTAsZj1iLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpO2lmKCIqIj09PWEpe3doaWxlKGM9ZltlKytdKTE9PT1jLm5vZGVUeXBlJiZkLnB1c2goYyk7cmV0dXJuIGR9cmV0dXJuIGZ9LGQuZmluZC5DTEFTUz1jLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJmZ1bmN0aW9uKGEsYil7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiBiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUmJnApcmV0dXJuIGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShhKX0scj1bXSxxPVtdLChjLnFzYT1ZLnRlc3Qobi5xdWVyeVNlbGVjdG9yQWxsKSkmJihqYShmdW5jdGlvbihhKXtvLmFwcGVuZENoaWxkKGEpLmlubmVySFRNTD0iPGEgaWQ9JyIrdSsiJz48L2E+PHNlbGVjdCBpZD0nIit1KyItXHJcXCcgbXNhbGxvd2NhcHR1cmU9Jyc+PG9wdGlvbiBzZWxlY3RlZD0nJz48L29wdGlvbj48L3NlbGVjdD4iLGEucXVlcnlTZWxlY3RvckFsbCgiW21zYWxsb3djYXB0dXJlXj0nJ10iKS5sZW5ndGgmJnEucHVzaCgiWypeJF09IitLKyIqKD86Jyd8XCJcIikiKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGh8fHEucHVzaCgiXFxbIitLKyIqKD86dmFsdWV8IitKKyIpIiksYS5xdWVyeVNlbGVjdG9yQWxsKCJbaWR+PSIrdSsiLV0iKS5sZW5ndGh8fHEucHVzaCgifj0iKSxhLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RofHxxLnB1c2goIjpjaGVja2VkIiksYS5xdWVyeVNlbGVjdG9yQWxsKCJhIyIrdSsiKyoiKS5sZW5ndGh8fHEucHVzaCgiLiMuK1srfl0iKX0pLGphKGZ1bmN0aW9uKGEpe2EuaW5uZXJIVE1MPSI8YSBocmVmPScnIGRpc2FibGVkPSdkaXNhYmxlZCc+PC9hPjxzZWxlY3QgZGlzYWJsZWQ9J2Rpc2FibGVkJz48b3B0aW9uLz48L3NlbGVjdD4iO3ZhciBiPW4uY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtiLnNldEF0dHJpYnV0ZSgidHlwZSIsImhpZGRlbiIpLGEuYXBwZW5kQ2hpbGQoYikuc2V0QXR0cmlidXRlKCJuYW1lIiwiRCIpLGEucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGgmJnEucHVzaCgibmFtZSIrSysiKlsqXiR8IX5dPz0iKSwyIT09YS5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aCYmcS5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLG8uYXBwZW5kQ2hpbGQoYSkuZGlzYWJsZWQ9ITAsMiE9PWEucXVlcnlTZWxlY3RvckFsbCgiOmRpc2FibGVkIikubGVuZ3RoJiZxLnB1c2goIjplbmFibGVkIiwiOmRpc2FibGVkIiksYS5xdWVyeVNlbGVjdG9yQWxsKCIqLDp4IikscS5wdXNoKCIsLio6Iil9KSksKGMubWF0Y2hlc1NlbGVjdG9yPVkudGVzdChzPW8ubWF0Y2hlc3x8by53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fG8ubW96TWF0Y2hlc1NlbGVjdG9yfHxvLm9NYXRjaGVzU2VsZWN0b3J8fG8ubXNNYXRjaGVzU2VsZWN0b3IpKSYmamEoZnVuY3Rpb24oYSl7Yy5kaXNjb25uZWN0ZWRNYXRjaD1zLmNhbGwoYSwiKiIpLHMuY2FsbChhLCJbcyE9JyddOngiKSxyLnB1c2goIiE9IixOKX0pLHE9cS5sZW5ndGgmJm5ldyBSZWdFeHAocS5qb2luKCJ8IikpLHI9ci5sZW5ndGgmJm5ldyBSZWdFeHAoci5qb2luKCJ8IikpLGI9WS50ZXN0KG8uY29tcGFyZURvY3VtZW50UG9zaXRpb24pLHQ9Ynx8WS50ZXN0KG8uY29udGFpbnMpP2Z1bmN0aW9uKGEsYil7dmFyIGM9OT09PWEubm9kZVR5cGU/YS5kb2N1bWVudEVsZW1lbnQ6YSxkPWImJmIucGFyZW50Tm9kZTtyZXR1cm4gYT09PWR8fCEoIWR8fDEhPT1kLm5vZGVUeXBlfHwhKGMuY29udGFpbnM/Yy5jb250YWlucyhkKTphLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiYxNiZhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGQpKSl9OmZ1bmN0aW9uKGEsYil7aWYoYil3aGlsZShiPWIucGFyZW50Tm9kZSlpZihiPT09YSlyZXR1cm4hMDtyZXR1cm4hMX0sQj1iP2Z1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgZD0hYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbi0hYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbjtyZXR1cm4gZD9kOihkPShhLm93bmVyRG9jdW1lbnR8fGEpPT09KGIub3duZXJEb2N1bWVudHx8Yik/YS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihiKToxLDEmZHx8IWMuc29ydERldGFjaGVkJiZiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGEpPT09ZD9hPT09bnx8YS5vd25lckRvY3VtZW50PT09diYmdCh2LGEpPy0xOmI9PT1ufHxiLm93bmVyRG9jdW1lbnQ9PT12JiZ0KHYsYik/MTprP0koayxhKS1JKGssYik6MDo0JmQ/LTE6MSl9OmZ1bmN0aW9uKGEsYil7aWYoYT09PWIpcmV0dXJuIGw9ITAsMDt2YXIgYyxkPTAsZT1hLnBhcmVudE5vZGUsZj1iLnBhcmVudE5vZGUsZz1bYV0saD1bYl07aWYoIWV8fCFmKXJldHVybiBhPT09bj8tMTpiPT09bj8xOmU/LTE6Zj8xOms/SShrLGEpLUkoayxiKTowO2lmKGU9PT1mKXJldHVybiBsYShhLGIpO2M9YTt3aGlsZShjPWMucGFyZW50Tm9kZSlnLnVuc2hpZnQoYyk7Yz1iO3doaWxlKGM9Yy5wYXJlbnROb2RlKWgudW5zaGlmdChjKTt3aGlsZShnW2RdPT09aFtkXSlkKys7cmV0dXJuIGQ/bGEoZ1tkXSxoW2RdKTpnW2RdPT09dj8tMTpoW2RdPT09dj8xOjB9LG4pOm59LGdhLm1hdGNoZXM9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gZ2EoYSxudWxsLG51bGwsYil9LGdhLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihhLGIpe2lmKChhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKSxiPWIucmVwbGFjZShTLCI9JyQxJ10iKSxjLm1hdGNoZXNTZWxlY3RvciYmcCYmIUFbYisiICJdJiYoIXJ8fCFyLnRlc3QoYikpJiYoIXF8fCFxLnRlc3QoYikpKXRyeXt2YXIgZD1zLmNhbGwoYSxiKTtpZihkfHxjLmRpc2Nvbm5lY3RlZE1hdGNofHxhLmRvY3VtZW50JiYxMSE9PWEuZG9jdW1lbnQubm9kZVR5cGUpcmV0dXJuIGR9Y2F0Y2goZSl7fXJldHVybiBnYShiLG4sbnVsbCxbYV0pLmxlbmd0aD4wfSxnYS5jb250YWlucz1mdW5jdGlvbihhLGIpe3JldHVybihhLm93bmVyRG9jdW1lbnR8fGEpIT09biYmbShhKSx0KGEsYil9LGdhLmF0dHI9ZnVuY3Rpb24oYSxiKXsoYS5vd25lckRvY3VtZW50fHxhKSE9PW4mJm0oYSk7dmFyIGU9ZC5hdHRySGFuZGxlW2IudG9Mb3dlckNhc2UoKV0sZj1lJiZDLmNhbGwoZC5hdHRySGFuZGxlLGIudG9Mb3dlckNhc2UoKSk/ZShhLGIsIXApOnZvaWQgMDtyZXR1cm4gdm9pZCAwIT09Zj9mOmMuYXR0cmlidXRlc3x8IXA/YS5nZXRBdHRyaWJ1dGUoYik6KGY9YS5nZXRBdHRyaWJ1dGVOb2RlKGIpKSYmZi5zcGVjaWZpZWQ/Zi52YWx1ZTpudWxsfSxnYS5lc2NhcGU9ZnVuY3Rpb24oYSl7cmV0dXJuKGErIiIpLnJlcGxhY2UoYmEsY2EpfSxnYS5lcnJvcj1mdW5jdGlvbihhKXt0aHJvdyBuZXcgRXJyb3IoIlN5bnRheCBlcnJvciwgdW5yZWNvZ25pemVkIGV4cHJlc3Npb246ICIrYSl9LGdhLnVuaXF1ZVNvcnQ9ZnVuY3Rpb24oYSl7dmFyIGIsZD1bXSxlPTAsZj0wO2lmKGw9IWMuZGV0ZWN0RHVwbGljYXRlcyxrPSFjLnNvcnRTdGFibGUmJmEuc2xpY2UoMCksYS5zb3J0KEIpLGwpe3doaWxlKGI9YVtmKytdKWI9PT1hW2ZdJiYoZT1kLnB1c2goZikpO3doaWxlKGUtLSlhLnNwbGljZShkW2VdLDEpfXJldHVybiBrPW51bGwsYX0sZT1nYS5nZXRUZXh0PWZ1bmN0aW9uKGEpe3ZhciBiLGM9IiIsZD0wLGY9YS5ub2RlVHlwZTtpZihmKXtpZigxPT09Znx8OT09PWZ8fDExPT09Zil7aWYoInN0cmluZyI9PXR5cGVvZiBhLnRleHRDb250ZW50KXJldHVybiBhLnRleHRDb250ZW50O2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZyljKz1lKGEpfWVsc2UgaWYoMz09PWZ8fDQ9PT1mKXJldHVybiBhLm5vZGVWYWx1ZX1lbHNlIHdoaWxlKGI9YVtkKytdKWMrPWUoYik7cmV0dXJuIGN9LGQ9Z2Euc2VsZWN0b3JzPXtjYWNoZUxlbmd0aDo1MCxjcmVhdGVQc2V1ZG86aWEsbWF0Y2g6VixhdHRySGFuZGxlOnt9LGZpbmQ6e30scmVsYXRpdmU6eyI+Ijp7ZGlyOiJwYXJlbnROb2RlIixmaXJzdDohMH0sIiAiOntkaXI6InBhcmVudE5vZGUifSwiKyI6e2RpcjoicHJldmlvdXNTaWJsaW5nIixmaXJzdDohMH0sIn4iOntkaXI6InByZXZpb3VzU2libGluZyJ9fSxwcmVGaWx0ZXI6e0FUVFI6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS5yZXBsYWNlKF8sYWEpLGFbM109KGFbM118fGFbNF18fGFbNV18fCIiKS5yZXBsYWNlKF8sYWEpLCJ+PSI9PT1hWzJdJiYoYVszXT0iICIrYVszXSsiICIpLGEuc2xpY2UoMCw0KX0sQ0hJTEQ6ZnVuY3Rpb24oYSl7cmV0dXJuIGFbMV09YVsxXS50b0xvd2VyQ2FzZSgpLCJudGgiPT09YVsxXS5zbGljZSgwLDMpPyhhWzNdfHxnYS5lcnJvcihhWzBdKSxhWzRdPSsoYVs0XT9hWzVdKyhhWzZdfHwxKToyKigiZXZlbiI9PT1hWzNdfHwib2RkIj09PWFbM10pKSxhWzVdPSsoYVs3XSthWzhdfHwib2RkIj09PWFbM10pKTphWzNdJiZnYS5lcnJvcihhWzBdKSxhfSxQU0VVRE86ZnVuY3Rpb24oYSl7dmFyIGIsYz0hYVs2XSYmYVsyXTtyZXR1cm4gVi5DSElMRC50ZXN0KGFbMF0pP251bGw6KGFbM10/YVsyXT1hWzRdfHxhWzVdfHwiIjpjJiZULnRlc3QoYykmJihiPWcoYywhMCkpJiYoYj1jLmluZGV4T2YoIikiLGMubGVuZ3RoLWIpLWMubGVuZ3RoKSYmKGFbMF09YVswXS5zbGljZSgwLGIpLGFbMl09Yy5zbGljZSgwLGIpKSxhLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oYSl7dmFyIGI9YS5yZXBsYWNlKF8sYWEpLnRvTG93ZXJDYXNlKCk7cmV0dXJuIioiPT09YT9mdW5jdGlvbigpe3JldHVybiEwfTpmdW5jdGlvbihhKXtyZXR1cm4gYS5ub2RlTmFtZSYmYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09Yn19LENMQVNTOmZ1bmN0aW9uKGEpe3ZhciBiPXlbYSsiICJdO3JldHVybiBifHwoYj1uZXcgUmVnRXhwKCIoXnwiK0srIikiK2ErIigiK0srInwkKSIpKSYmeShhLGZ1bmN0aW9uKGEpe3JldHVybiBiLnRlc3QoInN0cmluZyI9PXR5cGVvZiBhLmNsYXNzTmFtZSYmYS5jbGFzc05hbWV8fCJ1bmRlZmluZWQiIT10eXBlb2YgYS5nZXRBdHRyaWJ1dGUmJmEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIil9KX0sQVRUUjpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIGZ1bmN0aW9uKGQpe3ZhciBlPWdhLmF0dHIoZCxhKTtyZXR1cm4gbnVsbD09ZT8iIT0iPT09YjohYnx8KGUrPSIiLCI9Ij09PWI/ZT09PWM6IiE9Ij09PWI/ZSE9PWM6Il49Ij09PWI/YyYmMD09PWUuaW5kZXhPZihjKToiKj0iPT09Yj9jJiZlLmluZGV4T2YoYyk+LTE6IiQ9Ij09PWI/YyYmZS5zbGljZSgtYy5sZW5ndGgpPT09Yzoifj0iPT09Yj8oIiAiK2UucmVwbGFjZShPLCIgIikrIiAiKS5pbmRleE9mKGMpPi0xOiJ8PSI9PT1iJiYoZT09PWN8fGUuc2xpY2UoMCxjLmxlbmd0aCsxKT09PWMrIi0iKSl9fSxDSElMRDpmdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPSJudGgiIT09YS5zbGljZSgwLDMpLGc9Imxhc3QiIT09YS5zbGljZSgtNCksaD0ib2YtdHlwZSI9PT1iO3JldHVybiAxPT09ZCYmMD09PWU/ZnVuY3Rpb24oYSl7cmV0dXJuISFhLnBhcmVudE5vZGV9OmZ1bmN0aW9uKGIsYyxpKXt2YXIgaixrLGwsbSxuLG8scD1mIT09Zz8ibmV4dFNpYmxpbmciOiJwcmV2aW91c1NpYmxpbmciLHE9Yi5wYXJlbnROb2RlLHI9aCYmYi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLHM9IWkmJiFoLHQ9ITE7aWYocSl7aWYoZil7d2hpbGUocCl7bT1iO3doaWxlKG09bVtwXSlpZihoP20ubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PW0ubm9kZVR5cGUpcmV0dXJuITE7bz1wPSJvbmx5Ij09PWEmJiFvJiYibmV4dFNpYmxpbmcifXJldHVybiEwfWlmKG89W2c/cS5maXJzdENoaWxkOnEubGFzdENoaWxkXSxnJiZzKXttPXEsbD1tW3VdfHwobVt1XT17fSksaz1sW20udW5pcXVlSURdfHwobFttLnVuaXF1ZUlEXT17fSksaj1rW2FdfHxbXSxuPWpbMF09PT13JiZqWzFdLHQ9biYmalsyXSxtPW4mJnEuY2hpbGROb2Rlc1tuXTt3aGlsZShtPSsrbiYmbSYmbVtwXXx8KHQ9bj0wKXx8by5wb3AoKSlpZigxPT09bS5ub2RlVHlwZSYmKyt0JiZtPT09Yil7a1thXT1bdyxuLHRdO2JyZWFrfX1lbHNlIGlmKHMmJihtPWIsbD1tW3VdfHwobVt1XT17fSksaz1sW20udW5pcXVlSURdfHwobFttLnVuaXF1ZUlEXT17fSksaj1rW2FdfHxbXSxuPWpbMF09PT13JiZqWzFdLHQ9biksdD09PSExKXdoaWxlKG09KytuJiZtJiZtW3BdfHwodD1uPTApfHxvLnBvcCgpKWlmKChoP20ubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PXI6MT09PW0ubm9kZVR5cGUpJiYrK3QmJihzJiYobD1tW3VdfHwobVt1XT17fSksaz1sW20udW5pcXVlSURdfHwobFttLnVuaXF1ZUlEXT17fSksa1thXT1bdyx0XSksbT09PWIpKWJyZWFrO3JldHVybiB0LT1lLHQ9PT1kfHx0JWQ9PT0wJiZ0L2Q+PTB9fX0sUFNFVURPOmZ1bmN0aW9uKGEsYil7dmFyIGMsZT1kLnBzZXVkb3NbYV18fGQuc2V0RmlsdGVyc1thLnRvTG93ZXJDYXNlKCldfHxnYS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2EpO3JldHVybiBlW3VdP2UoYik6ZS5sZW5ndGg+MT8oYz1bYSxhLCIiLGJdLGQuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShhLnRvTG93ZXJDYXNlKCkpP2lhKGZ1bmN0aW9uKGEsYyl7dmFyIGQsZj1lKGEsYiksZz1mLmxlbmd0aDt3aGlsZShnLS0pZD1JKGEsZltnXSksYVtkXT0hKGNbZF09ZltnXSl9KTpmdW5jdGlvbihhKXtyZXR1cm4gZShhLDAsYyl9KTplfX0scHNldWRvczp7bm90OmlhKGZ1bmN0aW9uKGEpe3ZhciBiPVtdLGM9W10sZD1oKGEucmVwbGFjZShQLCIkMSIpKTtyZXR1cm4gZFt1XT9pYShmdW5jdGlvbihhLGIsYyxlKXt2YXIgZixnPWQoYSxudWxsLGUsW10pLGg9YS5sZW5ndGg7d2hpbGUoaC0tKShmPWdbaF0pJiYoYVtoXT0hKGJbaF09ZikpfSk6ZnVuY3Rpb24oYSxlLGYpe3JldHVybiBiWzBdPWEsZChiLG51bGwsZixjKSxiWzBdPW51bGwsIWMucG9wKCl9fSksaGFzOmlhKGZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbihiKXtyZXR1cm4gZ2EoYSxiKS5sZW5ndGg+MH19KSxjb250YWluczppYShmdW5jdGlvbihhKXtyZXR1cm4gYT1hLnJlcGxhY2UoXyxhYSksZnVuY3Rpb24oYil7cmV0dXJuKGIudGV4dENvbnRlbnR8fGIuaW5uZXJUZXh0fHxlKGIpKS5pbmRleE9mKGEpPi0xfX0pLGxhbmc6aWEoZnVuY3Rpb24oYSl7cmV0dXJuIFUudGVzdChhfHwiIil8fGdhLmVycm9yKCJ1bnN1cHBvcnRlZCBsYW5nOiAiK2EpLGE9YS5yZXBsYWNlKF8sYWEpLnRvTG93ZXJDYXNlKCksZnVuY3Rpb24oYil7dmFyIGM7ZG8gaWYoYz1wP2IubGFuZzpiLmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKXx8Yi5nZXRBdHRyaWJ1dGUoImxhbmciKSlyZXR1cm4gYz1jLnRvTG93ZXJDYXNlKCksYz09PWF8fDA9PT1jLmluZGV4T2YoYSsiLSIpO3doaWxlKChiPWIucGFyZW50Tm9kZSkmJjE9PT1iLm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24oYil7dmFyIGM9YS5sb2NhdGlvbiYmYS5sb2NhdGlvbi5oYXNoO3JldHVybiBjJiZjLnNsaWNlKDEpPT09Yi5pZH0scm9vdDpmdW5jdGlvbihhKXtyZXR1cm4gYT09PW99LGZvY3VzOmZ1bmN0aW9uKGEpe3JldHVybiBhPT09bi5hY3RpdmVFbGVtZW50JiYoIW4uaGFzRm9jdXN8fG4uaGFzRm9jdXMoKSkmJiEhKGEudHlwZXx8YS5ocmVmfHx+YS50YWJJbmRleCl9LGVuYWJsZWQ6b2EoITEpLGRpc2FibGVkOm9hKCEwKSxjaGVja2VkOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YiYmISFhLmNoZWNrZWR8fCJvcHRpb24iPT09YiYmISFhLnNlbGVjdGVkfSxzZWxlY3RlZDpmdW5jdGlvbihhKXtyZXR1cm4gYS5wYXJlbnROb2RlJiZhLnBhcmVudE5vZGUuc2VsZWN0ZWRJbmRleCxhLnNlbGVjdGVkPT09ITB9LGVtcHR5OmZ1bmN0aW9uKGEpe2ZvcihhPWEuZmlyc3RDaGlsZDthO2E9YS5uZXh0U2libGluZylpZihhLm5vZGVUeXBlPDYpcmV0dXJuITE7cmV0dXJuITB9LHBhcmVudDpmdW5jdGlvbihhKXtyZXR1cm4hZC5wc2V1ZG9zLmVtcHR5KGEpfSxoZWFkZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIFgudGVzdChhLm5vZGVOYW1lKX0saW5wdXQ6ZnVuY3Rpb24oYSl7cmV0dXJuIFcudGVzdChhLm5vZGVOYW1lKX0sYnV0dG9uOmZ1bmN0aW9uKGEpe3ZhciBiPWEubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtyZXR1cm4iaW5wdXQiPT09YiYmImJ1dHRvbiI9PT1hLnR5cGV8fCJidXR0b24iPT09Yn0sdGV4dDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4iaW5wdXQiPT09YS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpJiYidGV4dCI9PT1hLnR5cGUmJihudWxsPT0oYj1hLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09Yi50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6cGEoZnVuY3Rpb24oKXtyZXR1cm5bMF19KSxsYXN0OnBhKGZ1bmN0aW9uKGEsYil7cmV0dXJuW2ItMV19KSxlcTpwYShmdW5jdGlvbihhLGIsYyl7cmV0dXJuW2M8MD9jK2I6Y119KSxldmVuOnBhKGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTA7YzxiO2MrPTIpYS5wdXNoKGMpO3JldHVybiBhfSksb2RkOnBhKGZ1bmN0aW9uKGEsYil7Zm9yKHZhciBjPTE7YzxiO2MrPTIpYS5wdXNoKGMpO3JldHVybiBhfSksbHQ6cGEoZnVuY3Rpb24oYSxiLGMpe2Zvcih2YXIgZD1jPDA/YytiOmM7LS1kPj0wOylhLnB1c2goZCk7cmV0dXJuIGF9KSxndDpwYShmdW5jdGlvbihhLGIsYyl7Zm9yKHZhciBkPWM8MD9jK2I6YzsrK2Q8YjspYS5wdXNoKGQpO3JldHVybiBhfSl9fSxkLnBzZXVkb3MubnRoPWQucHNldWRvcy5lcTtmb3IoYiBpbntyYWRpbzohMCxjaGVja2JveDohMCxmaWxlOiEwLHBhc3N3b3JkOiEwLGltYWdlOiEwfSlkLnBzZXVkb3NbYl09bWEoYik7Zm9yKGIgaW57c3VibWl0OiEwLHJlc2V0OiEwfSlkLnBzZXVkb3NbYl09bmEoYik7ZnVuY3Rpb24gcmEoKXt9cmEucHJvdG90eXBlPWQuZmlsdGVycz1kLnBzZXVkb3MsZC5zZXRGaWx0ZXJzPW5ldyByYSxnPWdhLnRva2VuaXplPWZ1bmN0aW9uKGEsYil7dmFyIGMsZSxmLGcsaCxpLGosaz16W2ErIiAiXTtpZihrKXJldHVybiBiPzA6ay5zbGljZSgwKTtoPWEsaT1bXSxqPWQucHJlRmlsdGVyO3doaWxlKGgpe2MmJiEoZT1RLmV4ZWMoaCkpfHwoZSYmKGg9aC5zbGljZShlWzBdLmxlbmd0aCl8fGgpLGkucHVzaChmPVtdKSksYz0hMSwoZT1SLmV4ZWMoaCkpJiYoYz1lLnNoaWZ0KCksZi5wdXNoKHt2YWx1ZTpjLHR5cGU6ZVswXS5yZXBsYWNlKFAsIiAiKX0pLGg9aC5zbGljZShjLmxlbmd0aCkpO2ZvcihnIGluIGQuZmlsdGVyKSEoZT1WW2ddLmV4ZWMoaCkpfHxqW2ddJiYhKGU9altnXShlKSl8fChjPWUuc2hpZnQoKSxmLnB1c2goe3ZhbHVlOmMsdHlwZTpnLG1hdGNoZXM6ZX0pLGg9aC5zbGljZShjLmxlbmd0aCkpO2lmKCFjKWJyZWFrfXJldHVybiBiP2gubGVuZ3RoOmg/Z2EuZXJyb3IoYSk6eihhLGkpLnNsaWNlKDApfTtmdW5jdGlvbiBzYShhKXtmb3IodmFyIGI9MCxjPWEubGVuZ3RoLGQ9IiI7YjxjO2IrKylkKz1hW2JdLnZhbHVlO3JldHVybiBkfWZ1bmN0aW9uIHRhKGEsYixjKXt2YXIgZD1iLmRpcixlPWIubmV4dCxmPWV8fGQsZz1jJiYicGFyZW50Tm9kZSI9PT1mLGg9eCsrO3JldHVybiBiLmZpcnN0P2Z1bmN0aW9uKGIsYyxlKXt3aGlsZShiPWJbZF0paWYoMT09PWIubm9kZVR5cGV8fGcpcmV0dXJuIGEoYixjLGUpO3JldHVybiExfTpmdW5jdGlvbihiLGMsaSl7dmFyIGosayxsLG09W3csaF07aWYoaSl7d2hpbGUoYj1iW2RdKWlmKCgxPT09Yi5ub2RlVHlwZXx8ZykmJmEoYixjLGkpKXJldHVybiEwfWVsc2Ugd2hpbGUoYj1iW2RdKWlmKDE9PT1iLm5vZGVUeXBlfHxnKWlmKGw9Ylt1XXx8KGJbdV09e30pLGs9bFtiLnVuaXF1ZUlEXXx8KGxbYi51bmlxdWVJRF09e30pLGUmJmU9PT1iLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpYj1iW2RdfHxiO2Vsc2V7aWYoKGo9a1tmXSkmJmpbMF09PT13JiZqWzFdPT09aClyZXR1cm4gbVsyXT1qWzJdO2lmKGtbZl09bSxtWzJdPWEoYixjLGkpKXJldHVybiEwfXJldHVybiExfX1mdW5jdGlvbiB1YShhKXtyZXR1cm4gYS5sZW5ndGg+MT9mdW5jdGlvbihiLGMsZCl7dmFyIGU9YS5sZW5ndGg7d2hpbGUoZS0tKWlmKCFhW2VdKGIsYyxkKSlyZXR1cm4hMTtyZXR1cm4hMH06YVswXX1mdW5jdGlvbiB2YShhLGIsYyl7Zm9yKHZhciBkPTAsZT1iLmxlbmd0aDtkPGU7ZCsrKWdhKGEsYltkXSxjKTtyZXR1cm4gY31mdW5jdGlvbiB3YShhLGIsYyxkLGUpe2Zvcih2YXIgZixnPVtdLGg9MCxpPWEubGVuZ3RoLGo9bnVsbCE9YjtoPGk7aCsrKShmPWFbaF0pJiYoYyYmIWMoZixkLGUpfHwoZy5wdXNoKGYpLGomJmIucHVzaChoKSkpO3JldHVybiBnfWZ1bmN0aW9uIHhhKGEsYixjLGQsZSxmKXtyZXR1cm4gZCYmIWRbdV0mJihkPXhhKGQpKSxlJiYhZVt1XSYmKGU9eGEoZSxmKSksaWEoZnVuY3Rpb24oZixnLGgsaSl7dmFyIGosayxsLG09W10sbj1bXSxvPWcubGVuZ3RoLHA9Znx8dmEoYnx8IioiLGgubm9kZVR5cGU/W2hdOmgsW10pLHE9IWF8fCFmJiZiP3A6d2EocCxtLGEsaCxpKSxyPWM/ZXx8KGY/YTpvfHxkKT9bXTpnOnE7aWYoYyYmYyhxLHIsaCxpKSxkKXtqPXdhKHIsbiksZChqLFtdLGgsaSksaz1qLmxlbmd0aDt3aGlsZShrLS0pKGw9altrXSkmJihyW25ba11dPSEocVtuW2tdXT1sKSl9aWYoZil7aWYoZXx8YSl7aWYoZSl7aj1bXSxrPXIubGVuZ3RoO3doaWxlKGstLSkobD1yW2tdKSYmai5wdXNoKHFba109bCk7ZShudWxsLHI9W10saixpKX1rPXIubGVuZ3RoO3doaWxlKGstLSkobD1yW2tdKSYmKGo9ZT9JKGYsbCk6bVtrXSk+LTEmJihmW2pdPSEoZ1tqXT1sKSl9fWVsc2Ugcj13YShyPT09Zz9yLnNwbGljZShvLHIubGVuZ3RoKTpyKSxlP2UobnVsbCxnLHIsaSk6Ry5hcHBseShnLHIpfSl9ZnVuY3Rpb24geWEoYSl7Zm9yKHZhciBiLGMsZSxmPWEubGVuZ3RoLGc9ZC5yZWxhdGl2ZVthWzBdLnR5cGVdLGg9Z3x8ZC5yZWxhdGl2ZVsiICJdLGk9Zz8xOjAsaz10YShmdW5jdGlvbihhKXtyZXR1cm4gYT09PWJ9LGgsITApLGw9dGEoZnVuY3Rpb24oYSl7cmV0dXJuIEkoYixhKT4tMX0saCwhMCksbT1bZnVuY3Rpb24oYSxjLGQpe3ZhciBlPSFnJiYoZHx8YyE9PWopfHwoKGI9Yykubm9kZVR5cGU/ayhhLGMsZCk6bChhLGMsZCkpO3JldHVybiBiPW51bGwsZX1dO2k8ZjtpKyspaWYoYz1kLnJlbGF0aXZlW2FbaV0udHlwZV0pbT1bdGEodWEobSksYyldO2Vsc2V7aWYoYz1kLmZpbHRlclthW2ldLnR5cGVdLmFwcGx5KG51bGwsYVtpXS5tYXRjaGVzKSxjW3VdKXtmb3IoZT0rK2k7ZTxmO2UrKylpZihkLnJlbGF0aXZlW2FbZV0udHlwZV0pYnJlYWs7cmV0dXJuIHhhKGk+MSYmdWEobSksaT4xJiZzYShhLnNsaWNlKDAsaS0xKS5jb25jYXQoe3ZhbHVlOiIgIj09PWFbaS0yXS50eXBlPyIqIjoiIn0pKS5yZXBsYWNlKFAsIiQxIiksYyxpPGUmJnlhKGEuc2xpY2UoaSxlKSksZTxmJiZ5YShhPWEuc2xpY2UoZSkpLGU8ZiYmc2EoYSkpfW0ucHVzaChjKX1yZXR1cm4gdWEobSl9ZnVuY3Rpb24gemEoYSxiKXt2YXIgYz1iLmxlbmd0aD4wLGU9YS5sZW5ndGg+MCxmPWZ1bmN0aW9uKGYsZyxoLGksayl7dmFyIGwsbyxxLHI9MCxzPSIwIix0PWYmJltdLHU9W10sdj1qLHg9Znx8ZSYmZC5maW5kLlRBRygiKiIsaykseT13Kz1udWxsPT12PzE6TWF0aC5yYW5kb20oKXx8LjEsej14Lmxlbmd0aDtmb3IoayYmKGo9Zz09PW58fGd8fGspO3MhPT16JiZudWxsIT0obD14W3NdKTtzKyspe2lmKGUmJmwpe289MCxnfHxsLm93bmVyRG9jdW1lbnQ9PT1ufHwobShsKSxoPSFwKTt3aGlsZShxPWFbbysrXSlpZihxKGwsZ3x8bixoKSl7aS5wdXNoKGwpO2JyZWFrfWsmJih3PXkpfWMmJigobD0hcSYmbCkmJnItLSxmJiZ0LnB1c2gobCkpfWlmKHIrPXMsYyYmcyE9PXIpe289MDt3aGlsZShxPWJbbysrXSlxKHQsdSxnLGgpO2lmKGYpe2lmKHI+MCl3aGlsZShzLS0pdFtzXXx8dVtzXXx8KHVbc109RS5jYWxsKGkpKTt1PXdhKHUpfUcuYXBwbHkoaSx1KSxrJiYhZiYmdS5sZW5ndGg+MCYmcitiLmxlbmd0aD4xJiZnYS51bmlxdWVTb3J0KGkpfXJldHVybiBrJiYodz15LGo9diksdH07cmV0dXJuIGM/aWEoZik6Zn1yZXR1cm4gaD1nYS5jb21waWxlPWZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPVtdLGY9QVthKyIgIl07aWYoIWYpe2J8fChiPWcoYSkpLGM9Yi5sZW5ndGg7d2hpbGUoYy0tKWY9eWEoYltjXSksZlt1XT9kLnB1c2goZik6ZS5wdXNoKGYpO2Y9QShhLHphKGUsZCkpLGYuc2VsZWN0b3I9YX1yZXR1cm4gZn0saT1nYS5zZWxlY3Q9ZnVuY3Rpb24oYSxiLGMsZSl7dmFyIGYsaSxqLGssbCxtPSJmdW5jdGlvbiI9PXR5cGVvZiBhJiZhLG49IWUmJmcoYT1tLnNlbGVjdG9yfHxhKTtpZihjPWN8fFtdLDE9PT1uLmxlbmd0aCl7aWYoaT1uWzBdPW5bMF0uc2xpY2UoMCksaS5sZW5ndGg+MiYmIklEIj09PShqPWlbMF0pLnR5cGUmJjk9PT1iLm5vZGVUeXBlJiZwJiZkLnJlbGF0aXZlW2lbMV0udHlwZV0pe2lmKGI9KGQuZmluZC5JRChqLm1hdGNoZXNbMF0ucmVwbGFjZShfLGFhKSxiKXx8W10pWzBdLCFiKXJldHVybiBjO20mJihiPWIucGFyZW50Tm9kZSksYT1hLnNsaWNlKGkuc2hpZnQoKS52YWx1ZS5sZW5ndGgpfWY9Vi5uZWVkc0NvbnRleHQudGVzdChhKT8wOmkubGVuZ3RoO3doaWxlKGYtLSl7aWYoaj1pW2ZdLGQucmVsYXRpdmVbaz1qLnR5cGVdKWJyZWFrO2lmKChsPWQuZmluZFtrXSkmJihlPWwoai5tYXRjaGVzWzBdLnJlcGxhY2UoXyxhYSksJC50ZXN0KGlbMF0udHlwZSkmJnFhKGIucGFyZW50Tm9kZSl8fGIpKSl7aWYoaS5zcGxpY2UoZiwxKSxhPWUubGVuZ3RoJiZzYShpKSwhYSlyZXR1cm4gRy5hcHBseShjLGUpLGM7YnJlYWt9fX1yZXR1cm4obXx8aChhLG4pKShlLGIsIXAsYywhYnx8JC50ZXN0KGEpJiZxYShiLnBhcmVudE5vZGUpfHxiKSxjfSxjLnNvcnRTdGFibGU9dS5zcGxpdCgiIikuc29ydChCKS5qb2luKCIiKT09PXUsYy5kZXRlY3REdXBsaWNhdGVzPSEhbCxtKCksYy5zb3J0RGV0YWNoZWQ9amEoZnVuY3Rpb24oYSl7cmV0dXJuIDEmYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihuLmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0IikpfSksamEoZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5uZXJIVE1MPSI8YSBocmVmPScjJz48L2E+IiwiIyI9PT1hLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKCJocmVmIil9KXx8a2EoInR5cGV8aHJlZnxoZWlnaHR8d2lkdGgiLGZ1bmN0aW9uKGEsYixjKXtpZighYylyZXR1cm4gYS5nZXRBdHRyaWJ1dGUoYiwidHlwZSI9PT1iLnRvTG93ZXJDYXNlKCk/MToyKX0pLGMuYXR0cmlidXRlcyYmamEoZnVuY3Rpb24oYSl7cmV0dXJuIGEuaW5uZXJIVE1MPSI8aW5wdXQvPiIsYS5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSgidmFsdWUiLCIiKSwiIj09PWEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoInZhbHVlIil9KXx8a2EoInZhbHVlIixmdW5jdGlvbihhLGIsYyl7aWYoIWMmJiJpbnB1dCI9PT1hLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpcmV0dXJuIGEuZGVmYXVsdFZhbHVlfSksamEoZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWEuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpfSl8fGthKEosZnVuY3Rpb24oYSxiLGMpe3ZhciBkO2lmKCFjKXJldHVybiBhW2JdPT09ITA/Yi50b0xvd2VyQ2FzZSgpOihkPWEuZ2V0QXR0cmlidXRlTm9kZShiKSkmJmQuc3BlY2lmaWVkP2QudmFsdWU6bnVsbH0pLGdhfShhKTtyLmZpbmQ9eCxyLmV4cHI9eC5zZWxlY3RvcnMsci5leHByWyI6Il09ci5leHByLnBzZXVkb3Msci51bmlxdWVTb3J0PXIudW5pcXVlPXgudW5pcXVlU29ydCxyLnRleHQ9eC5nZXRUZXh0LHIuaXNYTUxEb2M9eC5pc1hNTCxyLmNvbnRhaW5zPXguY29udGFpbnMsci5lc2NhcGVTZWxlY3Rvcj14LmVzY2FwZTt2YXIgeT1mdW5jdGlvbihhLGIsYyl7dmFyIGQ9W10sZT12b2lkIDAhPT1jO3doaWxlKChhPWFbYl0pJiY5IT09YS5ub2RlVHlwZSlpZigxPT09YS5ub2RlVHlwZSl7aWYoZSYmcihhKS5pcyhjKSlicmVhaztkLnB1c2goYSl9cmV0dXJuIGR9LHo9ZnVuY3Rpb24oYSxiKXtmb3IodmFyIGM9W107YTthPWEubmV4dFNpYmxpbmcpMT09PWEubm9kZVR5cGUmJmEhPT1iJiZjLnB1c2goYSk7cmV0dXJuIGN9LEE9ci5leHByLm1hdGNoLm5lZWRzQ29udGV4dCxCPS9ePChbYS16XVteXC9cMD46XHgyMFx0XHJcblxmXSopW1x4MjBcdFxyXG5cZl0qXC8/Pig/OjxcL1wxPnwpJC9pLEM9L14uW146I1xbXC4sXSokLztmdW5jdGlvbiBEKGEsYixjKXtyZXR1cm4gci5pc0Z1bmN0aW9uKGIpP3IuZ3JlcChhLGZ1bmN0aW9uKGEsZCl7cmV0dXJuISFiLmNhbGwoYSxkLGEpIT09Y30pOmIubm9kZVR5cGU/ci5ncmVwKGEsZnVuY3Rpb24oYSl7cmV0dXJuIGE9PT1iIT09Y30pOiJzdHJpbmciIT10eXBlb2YgYj9yLmdyZXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gaS5jYWxsKGIsYSk+LTEhPT1jfSk6Qy50ZXN0KGIpP3IuZmlsdGVyKGIsYSxjKTooYj1yLmZpbHRlcihiLGEpLHIuZ3JlcChhLGZ1bmN0aW9uKGEpe3JldHVybiBpLmNhbGwoYixhKT4tMSE9PWMmJjE9PT1hLm5vZGVUeXBlfSkpfXIuZmlsdGVyPWZ1bmN0aW9uKGEsYixjKXt2YXIgZD1iWzBdO3JldHVybiBjJiYoYT0iOm5vdCgiK2ErIikiKSwxPT09Yi5sZW5ndGgmJjE9PT1kLm5vZGVUeXBlP3IuZmluZC5tYXRjaGVzU2VsZWN0b3IoZCxhKT9bZF06W106ci5maW5kLm1hdGNoZXMoYSxyLmdyZXAoYixmdW5jdGlvbihhKXtyZXR1cm4gMT09PWEubm9kZVR5cGV9KSl9LHIuZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZD10aGlzLmxlbmd0aCxlPXRoaXM7aWYoInN0cmluZyIhPXR5cGVvZiBhKXJldHVybiB0aGlzLnB1c2hTdGFjayhyKGEpLmZpbHRlcihmdW5jdGlvbigpe2ZvcihiPTA7YjxkO2IrKylpZihyLmNvbnRhaW5zKGVbYl0sdGhpcykpcmV0dXJuITB9KSk7Zm9yKGM9dGhpcy5wdXNoU3RhY2soW10pLGI9MDtiPGQ7YisrKXIuZmluZChhLGVbYl0sYyk7cmV0dXJuIGQ+MT9yLnVuaXF1ZVNvcnQoYyk6Y30sZmlsdGVyOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhEKHRoaXMsYXx8W10sITEpKX0sbm90OmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLnB1c2hTdGFjayhEKHRoaXMsYXx8W10sITApKX0saXM6ZnVuY3Rpb24oYSl7cmV0dXJuISFEKHRoaXMsInN0cmluZyI9PXR5cGVvZiBhJiZBLnRlc3QoYSk/cihhKTphfHxbXSwhMSkubGVuZ3RofX0pO3ZhciBFLEY9L14oPzpccyooPFtcd1xXXSs+KVtePl0qfCMoW1x3LV0rKSkkLyxHPXIuZm4uaW5pdD1mdW5jdGlvbihhLGIsYyl7dmFyIGUsZjtpZighYSlyZXR1cm4gdGhpcztpZihjPWN8fEUsInN0cmluZyI9PXR5cGVvZiBhKXtpZihlPSI8Ij09PWFbMF0mJiI+Ij09PWFbYS5sZW5ndGgtMV0mJmEubGVuZ3RoPj0zP1tudWxsLGEsbnVsbF06Ri5leGVjKGEpLCFlfHwhZVsxXSYmYilyZXR1cm4hYnx8Yi5qcXVlcnk/KGJ8fGMpLmZpbmQoYSk6dGhpcy5jb25zdHJ1Y3RvcihiKS5maW5kKGEpO2lmKGVbMV0pe2lmKGI9YiBpbnN0YW5jZW9mIHI/YlswXTpiLHIubWVyZ2UodGhpcyxyLnBhcnNlSFRNTChlWzFdLGImJmIubm9kZVR5cGU/Yi5vd25lckRvY3VtZW50fHxiOmQsITApKSxCLnRlc3QoZVsxXSkmJnIuaXNQbGFpbk9iamVjdChiKSlmb3IoZSBpbiBiKXIuaXNGdW5jdGlvbih0aGlzW2VdKT90aGlzW2VdKGJbZV0pOnRoaXMuYXR0cihlLGJbZV0pO3JldHVybiB0aGlzfXJldHVybiBmPWQuZ2V0RWxlbWVudEJ5SWQoZVsyXSksZiYmKHRoaXNbMF09Zix0aGlzLmxlbmd0aD0xKSx0aGlzfXJldHVybiBhLm5vZGVUeXBlPyh0aGlzWzBdPWEsdGhpcy5sZW5ndGg9MSx0aGlzKTpyLmlzRnVuY3Rpb24oYSk/dm9pZCAwIT09Yy5yZWFkeT9jLnJlYWR5KGEpOmEocik6ci5tYWtlQXJyYXkoYSx0aGlzKX07Ry5wcm90b3R5cGU9ci5mbixFPXIoZCk7dmFyIEg9L14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sST17Y2hpbGRyZW46ITAsY29udGVudHM6ITAsbmV4dDohMCxwcmV2OiEwfTtyLmZuLmV4dGVuZCh7aGFzOmZ1bmN0aW9uKGEpe3ZhciBiPXIoYSx0aGlzKSxjPWIubGVuZ3RoO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2Zvcih2YXIgYT0wO2E8YzthKyspaWYoci5jb250YWlucyh0aGlzLGJbYV0pKXJldHVybiEwfSl9LGNsb3Nlc3Q6ZnVuY3Rpb24oYSxiKXt2YXIgYyxkPTAsZT10aGlzLmxlbmd0aCxmPVtdLGc9InN0cmluZyIhPXR5cGVvZiBhJiZyKGEpO2lmKCFBLnRlc3QoYSkpZm9yKDtkPGU7ZCsrKWZvcihjPXRoaXNbZF07YyYmYyE9PWI7Yz1jLnBhcmVudE5vZGUpaWYoYy5ub2RlVHlwZTwxMSYmKGc/Zy5pbmRleChjKT4tMToxPT09Yy5ub2RlVHlwZSYmci5maW5kLm1hdGNoZXNTZWxlY3RvcihjLGEpKSl7Zi5wdXNoKGMpO2JyZWFrfXJldHVybiB0aGlzLnB1c2hTdGFjayhmLmxlbmd0aD4xP3IudW5pcXVlU29ydChmKTpmKX0saW5kZXg6ZnVuY3Rpb24oYSl7cmV0dXJuIGE/InN0cmluZyI9PXR5cGVvZiBhP2kuY2FsbChyKGEpLHRoaXNbMF0pOmkuY2FsbCh0aGlzLGEuanF1ZXJ5P2FbMF06YSk6dGhpc1swXSYmdGhpc1swXS5wYXJlbnROb2RlP3RoaXMuZmlyc3QoKS5wcmV2QWxsKCkubGVuZ3RoOi0xfSxhZGQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soci51bmlxdWVTb3J0KHIubWVyZ2UodGhpcy5nZXQoKSxyKGEsYikpKSl9LGFkZEJhY2s6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuYWRkKG51bGw9PWE/dGhpcy5wcmV2T2JqZWN0OnRoaXMucHJldk9iamVjdC5maWx0ZXIoYSkpfX0pO2Z1bmN0aW9uIEooYSxiKXt3aGlsZSgoYT1hW2JdKSYmMSE9PWEubm9kZVR5cGUpO3JldHVybiBhfXIuZWFjaCh7cGFyZW50OmZ1bmN0aW9uKGEpe3ZhciBiPWEucGFyZW50Tm9kZTtyZXR1cm4gYiYmMTEhPT1iLm5vZGVUeXBlP2I6bnVsbH0scGFyZW50czpmdW5jdGlvbihhKXtyZXR1cm4geShhLCJwYXJlbnROb2RlIil9LHBhcmVudHNVbnRpbDpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIHkoYSwicGFyZW50Tm9kZSIsYyl9LG5leHQ6ZnVuY3Rpb24oYSl7cmV0dXJuIEooYSwibmV4dFNpYmxpbmciKX0scHJldjpmdW5jdGlvbihhKXtyZXR1cm4gSihhLCJwcmV2aW91c1NpYmxpbmciKX0sbmV4dEFsbDpmdW5jdGlvbihhKXtyZXR1cm4geShhLCJuZXh0U2libGluZyIpfSxwcmV2QWxsOmZ1bmN0aW9uKGEpe3JldHVybiB5KGEsInByZXZpb3VzU2libGluZyIpfSxuZXh0VW50aWw6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB5KGEsIm5leHRTaWJsaW5nIixjKX0scHJldlVudGlsOmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4geShhLCJwcmV2aW91c1NpYmxpbmciLGMpfSxzaWJsaW5nczpmdW5jdGlvbihhKXtyZXR1cm4geigoYS5wYXJlbnROb2RlfHx7fSkuZmlyc3RDaGlsZCxhKX0sY2hpbGRyZW46ZnVuY3Rpb24oYSl7cmV0dXJuIHooYS5maXJzdENoaWxkKX0sY29udGVudHM6ZnVuY3Rpb24oYSl7cmV0dXJuIGEuY29udGVudERvY3VtZW50fHxyLm1lcmdlKFtdLGEuY2hpbGROb2Rlcyl9fSxmdW5jdGlvbihhLGIpe3IuZm5bYV09ZnVuY3Rpb24oYyxkKXt2YXIgZT1yLm1hcCh0aGlzLGIsYyk7cmV0dXJuIlVudGlsIiE9PWEuc2xpY2UoLTUpJiYoZD1jKSxkJiYic3RyaW5nIj09dHlwZW9mIGQmJihlPXIuZmlsdGVyKGQsZSkpLHRoaXMubGVuZ3RoPjEmJihJW2FdfHxyLnVuaXF1ZVNvcnQoZSksSC50ZXN0KGEpJiZlLnJldmVyc2UoKSksdGhpcy5wdXNoU3RhY2soZSl9fSk7dmFyIEs9L1teXHgyMFx0XHJcblxmXSsvZztmdW5jdGlvbiBMKGEpe3ZhciBiPXt9O3JldHVybiByLmVhY2goYS5tYXRjaChLKXx8W10sZnVuY3Rpb24oYSxjKXtiW2NdPSEwfSksYn1yLkNhbGxiYWNrcz1mdW5jdGlvbihhKXthPSJzdHJpbmciPT10eXBlb2YgYT9MKGEpOnIuZXh0ZW5kKHt9LGEpO3ZhciBiLGMsZCxlLGY9W10sZz1bXSxoPS0xLGk9ZnVuY3Rpb24oKXtmb3IoZT1hLm9uY2UsZD1iPSEwO2cubGVuZ3RoO2g9LTEpe2M9Zy5zaGlmdCgpO3doaWxlKCsraDxmLmxlbmd0aClmW2hdLmFwcGx5KGNbMF0sY1sxXSk9PT0hMSYmYS5zdG9wT25GYWxzZSYmKGg9Zi5sZW5ndGgsYz0hMSl9YS5tZW1vcnl8fChjPSExKSxiPSExLGUmJihmPWM/W106IiIpfSxqPXthZGQ6ZnVuY3Rpb24oKXtyZXR1cm4gZiYmKGMmJiFiJiYoaD1mLmxlbmd0aC0xLGcucHVzaChjKSksZnVuY3Rpb24gZChiKXtyLmVhY2goYixmdW5jdGlvbihiLGMpe3IuaXNGdW5jdGlvbihjKT9hLnVuaXF1ZSYmai5oYXMoYyl8fGYucHVzaChjKTpjJiZjLmxlbmd0aCYmInN0cmluZyIhPT1yLnR5cGUoYykmJmQoYyl9KX0oYXJndW1lbnRzKSxjJiYhYiYmaSgpKSx0aGlzfSxyZW1vdmU6ZnVuY3Rpb24oKXtyZXR1cm4gci5lYWNoKGFyZ3VtZW50cyxmdW5jdGlvbihhLGIpe3ZhciBjO3doaWxlKChjPXIuaW5BcnJheShiLGYsYykpPi0xKWYuc3BsaWNlKGMsMSksYzw9aCYmaC0tfSksdGhpc30saGFzOmZ1bmN0aW9uKGEpe3JldHVybiBhP3IuaW5BcnJheShhLGYpPi0xOmYubGVuZ3RoPjB9LGVtcHR5OmZ1bmN0aW9uKCl7cmV0dXJuIGYmJihmPVtdKSx0aGlzfSxkaXNhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGU9Zz1bXSxmPWM9IiIsdGhpc30sZGlzYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hZn0sbG9jazpmdW5jdGlvbigpe3JldHVybiBlPWc9W10sY3x8Ynx8KGY9Yz0iIiksdGhpc30sbG9ja2VkOmZ1bmN0aW9uKCl7cmV0dXJuISFlfSxmaXJlV2l0aDpmdW5jdGlvbihhLGMpe3JldHVybiBlfHwoYz1jfHxbXSxjPVthLGMuc2xpY2U/Yy5zbGljZSgpOmNdLGcucHVzaChjKSxifHxpKCkpLHRoaXN9LGZpcmU6ZnVuY3Rpb24oKXtyZXR1cm4gai5maXJlV2l0aCh0aGlzLGFyZ3VtZW50cyksdGhpc30sZmlyZWQ6ZnVuY3Rpb24oKXtyZXR1cm4hIWR9fTtyZXR1cm4gan07ZnVuY3Rpb24gTShhKXtyZXR1cm4gYX1mdW5jdGlvbiBOKGEpe3Rocm93IGF9ZnVuY3Rpb24gTyhhLGIsYyl7dmFyIGQ7dHJ5e2EmJnIuaXNGdW5jdGlvbihkPWEucHJvbWlzZSk/ZC5jYWxsKGEpLmRvbmUoYikuZmFpbChjKTphJiZyLmlzRnVuY3Rpb24oZD1hLnRoZW4pP2QuY2FsbChhLGIsYyk6Yi5jYWxsKHZvaWQgMCxhKX1jYXRjaChhKXtjLmNhbGwodm9pZCAwLGEpfX1yLmV4dGVuZCh7RGVmZXJyZWQ6ZnVuY3Rpb24oYil7dmFyIGM9W1sibm90aWZ5IiwicHJvZ3Jlc3MiLHIuQ2FsbGJhY2tzKCJtZW1vcnkiKSxyLkNhbGxiYWNrcygibWVtb3J5IiksMl0sWyJyZXNvbHZlIiwiZG9uZSIsci5DYWxsYmFja3MoIm9uY2UgbWVtb3J5Iiksci5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksMCwicmVzb2x2ZWQiXSxbInJlamVjdCIsImZhaWwiLHIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDEsInJlamVjdGVkIl1dLGQ9InBlbmRpbmciLGU9e3N0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGR9LGFsd2F5czpmdW5jdGlvbigpe3JldHVybiBmLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksdGhpc30sImNhdGNoIjpmdW5jdGlvbihhKXtyZXR1cm4gZS50aGVuKG51bGwsYSl9LHBpcGU6ZnVuY3Rpb24oKXt2YXIgYT1hcmd1bWVudHM7cmV0dXJuIHIuRGVmZXJyZWQoZnVuY3Rpb24oYil7ci5lYWNoKGMsZnVuY3Rpb24oYyxkKXt2YXIgZT1yLmlzRnVuY3Rpb24oYVtkWzRdXSkmJmFbZFs0XV07ZltkWzFdXShmdW5jdGlvbigpe3ZhciBhPWUmJmUuYXBwbHkodGhpcyxhcmd1bWVudHMpO2EmJnIuaXNGdW5jdGlvbihhLnByb21pc2UpP2EucHJvbWlzZSgpLnByb2dyZXNzKGIubm90aWZ5KS5kb25lKGIucmVzb2x2ZSkuZmFpbChiLnJlamVjdCk6YltkWzBdKyJXaXRoIl0odGhpcyxlP1thXTphcmd1bWVudHMpfSl9KSxhPW51bGx9KS5wcm9taXNlKCl9LHRoZW46ZnVuY3Rpb24oYixkLGUpe3ZhciBmPTA7ZnVuY3Rpb24gZyhiLGMsZCxlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgaD10aGlzLGk9YXJndW1lbnRzLGo9ZnVuY3Rpb24oKXt2YXIgYSxqO2lmKCEoYjxmKSl7aWYoYT1kLmFwcGx5KGgsaSksYT09PWMucHJvbWlzZSgpKXRocm93IG5ldyBUeXBlRXJyb3IoIlRoZW5hYmxlIHNlbGYtcmVzb2x1dGlvbiIpO2o9YSYmKCJvYmplY3QiPT10eXBlb2YgYXx8ImZ1bmN0aW9uIj09dHlwZW9mIGEpJiZhLnRoZW4sci5pc0Z1bmN0aW9uKGopP2U/ai5jYWxsKGEsZyhmLGMsTSxlKSxnKGYsYyxOLGUpKTooZisrLGouY2FsbChhLGcoZixjLE0sZSksZyhmLGMsTixlKSxnKGYsYyxNLGMubm90aWZ5V2l0aCkpKTooZCE9PU0mJihoPXZvaWQgMCxpPVthXSksKGV8fGMucmVzb2x2ZVdpdGgpKGgsaSkpfX0saz1lP2o6ZnVuY3Rpb24oKXt0cnl7aigpfWNhdGNoKGEpe3IuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayYmci5EZWZlcnJlZC5leGNlcHRpb25Ib29rKGEsay5zdGFja1RyYWNlKSxiKzE+PWYmJihkIT09TiYmKGg9dm9pZCAwLGk9W2FdKSxjLnJlamVjdFdpdGgoaCxpKSl9fTtiP2soKTooci5EZWZlcnJlZC5nZXRTdGFja0hvb2smJihrLnN0YWNrVHJhY2U9ci5EZWZlcnJlZC5nZXRTdGFja0hvb2soKSksYS5zZXRUaW1lb3V0KGspKX19cmV0dXJuIHIuRGVmZXJyZWQoZnVuY3Rpb24oYSl7Y1swXVszXS5hZGQoZygwLGEsci5pc0Z1bmN0aW9uKGUpP2U6TSxhLm5vdGlmeVdpdGgpKSxjWzFdWzNdLmFkZChnKDAsYSxyLmlzRnVuY3Rpb24oYik/YjpNKSksY1syXVszXS5hZGQoZygwLGEsci5pc0Z1bmN0aW9uKGQpP2Q6TikpfSkucHJvbWlzZSgpfSxwcm9taXNlOmZ1bmN0aW9uKGEpe3JldHVybiBudWxsIT1hP3IuZXh0ZW5kKGEsZSk6ZX19LGY9e307cmV0dXJuIHIuZWFjaChjLGZ1bmN0aW9uKGEsYil7dmFyIGc9YlsyXSxoPWJbNV07ZVtiWzFdXT1nLmFkZCxoJiZnLmFkZChmdW5jdGlvbigpe2Q9aH0sY1szLWFdWzJdLmRpc2FibGUsY1swXVsyXS5sb2NrKSxnLmFkZChiWzNdLmZpcmUpLGZbYlswXV09ZnVuY3Rpb24oKXtyZXR1cm4gZltiWzBdKyJXaXRoIl0odGhpcz09PWY/dm9pZCAwOnRoaXMsYXJndW1lbnRzKSx0aGlzfSxmW2JbMF0rIldpdGgiXT1nLmZpcmVXaXRofSksZS5wcm9taXNlKGYpLGImJmIuY2FsbChmLGYpLGZ9LHdoZW46ZnVuY3Rpb24oYSl7dmFyIGI9YXJndW1lbnRzLmxlbmd0aCxjPWIsZD1BcnJheShjKSxlPWYuY2FsbChhcmd1bWVudHMpLGc9ci5EZWZlcnJlZCgpLGg9ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMpe2RbYV09dGhpcyxlW2FdPWFyZ3VtZW50cy5sZW5ndGg+MT9mLmNhbGwoYXJndW1lbnRzKTpjLC0tYnx8Zy5yZXNvbHZlV2l0aChkLGUpfX07aWYoYjw9MSYmKE8oYSxnLmRvbmUoaChjKSkucmVzb2x2ZSxnLnJlamVjdCksInBlbmRpbmciPT09Zy5zdGF0ZSgpfHxyLmlzRnVuY3Rpb24oZVtjXSYmZVtjXS50aGVuKSkpcmV0dXJuIGcudGhlbigpO3doaWxlKGMtLSlPKGVbY10saChjKSxnLnJlamVjdCk7cmV0dXJuIGcucHJvbWlzZSgpfX0pO3ZhciBQPS9eKEV2YWx8SW50ZXJuYWx8UmFuZ2V8UmVmZXJlbmNlfFN5bnRheHxUeXBlfFVSSSlFcnJvciQvO3IuRGVmZXJyZWQuZXhjZXB0aW9uSG9vaz1mdW5jdGlvbihiLGMpe2EuY29uc29sZSYmYS5jb25zb2xlLndhcm4mJmImJlAudGVzdChiLm5hbWUpJiZhLmNvbnNvbGUud2FybigialF1ZXJ5LkRlZmVycmVkIGV4Y2VwdGlvbjogIitiLm1lc3NhZ2UsYi5zdGFjayxjKX0sci5yZWFkeUV4Y2VwdGlvbj1mdW5jdGlvbihiKXthLnNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aHJvdyBifSl9O3ZhciBRPXIuRGVmZXJyZWQoKTtyLmZuLnJlYWR5PWZ1bmN0aW9uKGEpe3JldHVybiBRLnRoZW4oYSlbImNhdGNoIl0oZnVuY3Rpb24oYSl7ci5yZWFkeUV4Y2VwdGlvbihhKX0pLHRoaXN9LHIuZXh0ZW5kKHtpc1JlYWR5OiExLHJlYWR5V2FpdDoxLGhvbGRSZWFkeTpmdW5jdGlvbihhKXthP3IucmVhZHlXYWl0Kys6ci5yZWFkeSghMCl9LHJlYWR5OmZ1bmN0aW9uKGEpeyhhPT09ITA/LS1yLnJlYWR5V2FpdDpyLmlzUmVhZHkpfHwoci5pc1JlYWR5PSEwLGEhPT0hMCYmLS1yLnJlYWR5V2FpdD4wfHxRLnJlc29sdmVXaXRoKGQsW3JdKSl9fSksci5yZWFkeS50aGVuPVEudGhlbjtmdW5jdGlvbiBSKCl7ZC5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixSKSwKYS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixSKSxyLnJlYWR5KCl9ImNvbXBsZXRlIj09PWQucmVhZHlTdGF0ZXx8ImxvYWRpbmciIT09ZC5yZWFkeVN0YXRlJiYhZC5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGw/YS5zZXRUaW1lb3V0KHIucmVhZHkpOihkLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLFIpLGEuYWRkRXZlbnRMaXN0ZW5lcigibG9hZCIsUikpO3ZhciBTPWZ1bmN0aW9uKGEsYixjLGQsZSxmLGcpe3ZhciBoPTAsaT1hLmxlbmd0aCxqPW51bGw9PWM7aWYoIm9iamVjdCI9PT1yLnR5cGUoYykpe2U9ITA7Zm9yKGggaW4gYylTKGEsYixoLGNbaF0sITAsZixnKX1lbHNlIGlmKHZvaWQgMCE9PWQmJihlPSEwLHIuaXNGdW5jdGlvbihkKXx8KGc9ITApLGomJihnPyhiLmNhbGwoYSxkKSxiPW51bGwpOihqPWIsYj1mdW5jdGlvbihhLGIsYyl7cmV0dXJuIGouY2FsbChyKGEpLGMpfSkpLGIpKWZvcig7aDxpO2grKyliKGFbaF0sYyxnP2Q6ZC5jYWxsKGFbaF0saCxiKGFbaF0sYykpKTtyZXR1cm4gZT9hOmo/Yi5jYWxsKGEpOmk/YihhWzBdLGMpOmZ9LFQ9ZnVuY3Rpb24oYSl7cmV0dXJuIDE9PT1hLm5vZGVUeXBlfHw5PT09YS5ub2RlVHlwZXx8ISthLm5vZGVUeXBlfTtmdW5jdGlvbiBVKCl7dGhpcy5leHBhbmRvPXIuZXhwYW5kbytVLnVpZCsrfVUudWlkPTEsVS5wcm90b3R5cGU9e2NhY2hlOmZ1bmN0aW9uKGEpe3ZhciBiPWFbdGhpcy5leHBhbmRvXTtyZXR1cm4gYnx8KGI9e30sVChhKSYmKGEubm9kZVR5cGU/YVt0aGlzLmV4cGFuZG9dPWI6T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsdGhpcy5leHBhbmRvLHt2YWx1ZTpiLGNvbmZpZ3VyYWJsZTohMH0pKSksYn0sc2V0OmZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlPXRoaXMuY2FjaGUoYSk7aWYoInN0cmluZyI9PXR5cGVvZiBiKWVbci5jYW1lbENhc2UoYildPWM7ZWxzZSBmb3IoZCBpbiBiKWVbci5jYW1lbENhc2UoZCldPWJbZF07cmV0dXJuIGV9LGdldDpmdW5jdGlvbihhLGIpe3JldHVybiB2b2lkIDA9PT1iP3RoaXMuY2FjaGUoYSk6YVt0aGlzLmV4cGFuZG9dJiZhW3RoaXMuZXhwYW5kb11bci5jYW1lbENhc2UoYildfSxhY2Nlc3M6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB2b2lkIDA9PT1ifHxiJiYic3RyaW5nIj09dHlwZW9mIGImJnZvaWQgMD09PWM/dGhpcy5nZXQoYSxiKToodGhpcy5zZXQoYSxiLGMpLHZvaWQgMCE9PWM/YzpiKX0scmVtb3ZlOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD1hW3RoaXMuZXhwYW5kb107aWYodm9pZCAwIT09ZCl7aWYodm9pZCAwIT09Yil7ci5pc0FycmF5KGIpP2I9Yi5tYXAoci5jYW1lbENhc2UpOihiPXIuY2FtZWxDYXNlKGIpLGI9YiBpbiBkP1tiXTpiLm1hdGNoKEspfHxbXSksYz1iLmxlbmd0aDt3aGlsZShjLS0pZGVsZXRlIGRbYltjXV19KHZvaWQgMD09PWJ8fHIuaXNFbXB0eU9iamVjdChkKSkmJihhLm5vZGVUeXBlP2FbdGhpcy5leHBhbmRvXT12b2lkIDA6ZGVsZXRlIGFbdGhpcy5leHBhbmRvXSl9fSxoYXNEYXRhOmZ1bmN0aW9uKGEpe3ZhciBiPWFbdGhpcy5leHBhbmRvXTtyZXR1cm4gdm9pZCAwIT09YiYmIXIuaXNFbXB0eU9iamVjdChiKX19O3ZhciBWPW5ldyBVLFc9bmV3IFUsWD0vXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLFk9L1tBLVpdL2c7ZnVuY3Rpb24gWihhKXtyZXR1cm4idHJ1ZSI9PT1hfHwiZmFsc2UiIT09YSYmKCJudWxsIj09PWE/bnVsbDphPT09K2ErIiI/K2E6WC50ZXN0KGEpP0pTT04ucGFyc2UoYSk6YSl9ZnVuY3Rpb24gJChhLGIsYyl7dmFyIGQ7aWYodm9pZCAwPT09YyYmMT09PWEubm9kZVR5cGUpaWYoZD0iZGF0YS0iK2IucmVwbGFjZShZLCItJCYiKS50b0xvd2VyQ2FzZSgpLGM9YS5nZXRBdHRyaWJ1dGUoZCksInN0cmluZyI9PXR5cGVvZiBjKXt0cnl7Yz1aKGMpfWNhdGNoKGUpe31XLnNldChhLGIsYyl9ZWxzZSBjPXZvaWQgMDtyZXR1cm4gY31yLmV4dGVuZCh7aGFzRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gVy5oYXNEYXRhKGEpfHxWLmhhc0RhdGEoYSl9LGRhdGE6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiBXLmFjY2VzcyhhLGIsYyl9LHJlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtXLnJlbW92ZShhLGIpfSxfZGF0YTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIFYuYWNjZXNzKGEsYixjKX0sX3JlbW92ZURhdGE6ZnVuY3Rpb24oYSxiKXtWLnJlbW92ZShhLGIpfX0pLHIuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGY9dGhpc1swXSxnPWYmJmYuYXR0cmlidXRlcztpZih2b2lkIDA9PT1hKXtpZih0aGlzLmxlbmd0aCYmKGU9Vy5nZXQoZiksMT09PWYubm9kZVR5cGUmJiFWLmdldChmLCJoYXNEYXRhQXR0cnMiKSkpe2M9Zy5sZW5ndGg7d2hpbGUoYy0tKWdbY10mJihkPWdbY10ubmFtZSwwPT09ZC5pbmRleE9mKCJkYXRhLSIpJiYoZD1yLmNhbWVsQ2FzZShkLnNsaWNlKDUpKSwkKGYsZCxlW2RdKSkpO1Yuc2V0KGYsImhhc0RhdGFBdHRycyIsITApfXJldHVybiBlfXJldHVybiJvYmplY3QiPT10eXBlb2YgYT90aGlzLmVhY2goZnVuY3Rpb24oKXtXLnNldCh0aGlzLGEpfSk6Uyh0aGlzLGZ1bmN0aW9uKGIpe3ZhciBjO2lmKGYmJnZvaWQgMD09PWIpe2lmKGM9Vy5nZXQoZixhKSx2b2lkIDAhPT1jKXJldHVybiBjO2lmKGM9JChmLGEpLHZvaWQgMCE9PWMpcmV0dXJuIGN9ZWxzZSB0aGlzLmVhY2goZnVuY3Rpb24oKXtXLnNldCh0aGlzLGEsYil9KX0sbnVsbCxiLGFyZ3VtZW50cy5sZW5ndGg+MSxudWxsLCEwKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Vy5yZW1vdmUodGhpcyxhKX0pfX0pLHIuZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQ7aWYoYSlyZXR1cm4gYj0oYnx8ImZ4IikrInF1ZXVlIixkPVYuZ2V0KGEsYiksYyYmKCFkfHxyLmlzQXJyYXkoYyk/ZD1WLmFjY2VzcyhhLGIsci5tYWtlQXJyYXkoYykpOmQucHVzaChjKSksZHx8W119LGRlcXVldWU6ZnVuY3Rpb24oYSxiKXtiPWJ8fCJmeCI7dmFyIGM9ci5xdWV1ZShhLGIpLGQ9Yy5sZW5ndGgsZT1jLnNoaWZ0KCksZj1yLl9xdWV1ZUhvb2tzKGEsYiksZz1mdW5jdGlvbigpe3IuZGVxdWV1ZShhLGIpfTsiaW5wcm9ncmVzcyI9PT1lJiYoZT1jLnNoaWZ0KCksZC0tKSxlJiYoImZ4Ij09PWImJmMudW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBmLnN0b3AsZS5jYWxsKGEsZyxmKSksIWQmJmYmJmYuZW1wdHkuZmlyZSgpfSxfcXVldWVIb29rczpmdW5jdGlvbihhLGIpe3ZhciBjPWIrInF1ZXVlSG9va3MiO3JldHVybiBWLmdldChhLGMpfHxWLmFjY2VzcyhhLGMse2VtcHR5OnIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe1YucmVtb3ZlKGEsW2IrInF1ZXVlIixjXSl9KX0pfX0pLHIuZm4uZXh0ZW5kKHtxdWV1ZTpmdW5jdGlvbihhLGIpe3ZhciBjPTI7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9ImZ4IixjLS0pLGFyZ3VtZW50cy5sZW5ndGg8Yz9yLnF1ZXVlKHRoaXNbMF0sYSk6dm9pZCAwPT09Yj90aGlzOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBjPXIucXVldWUodGhpcyxhLGIpO3IuX3F1ZXVlSG9va3ModGhpcyxhKSwiZngiPT09YSYmImlucHJvZ3Jlc3MiIT09Y1swXSYmci5kZXF1ZXVlKHRoaXMsYSl9KX0sZGVxdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7ci5kZXF1ZXVlKHRoaXMsYSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihhKXtyZXR1cm4gdGhpcy5xdWV1ZShhfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihhLGIpe3ZhciBjLGQ9MSxlPXIuRGVmZXJyZWQoKSxmPXRoaXMsZz10aGlzLmxlbmd0aCxoPWZ1bmN0aW9uKCl7LS1kfHxlLnJlc29sdmVXaXRoKGYsW2ZdKX07InN0cmluZyIhPXR5cGVvZiBhJiYoYj1hLGE9dm9pZCAwKSxhPWF8fCJmeCI7d2hpbGUoZy0tKWM9Vi5nZXQoZltnXSxhKyJxdWV1ZUhvb2tzIiksYyYmYy5lbXB0eSYmKGQrKyxjLmVtcHR5LmFkZChoKSk7cmV0dXJuIGgoKSxlLnByb21pc2UoYil9fSk7dmFyIF89L1srLV0/KD86XGQqXC58KVxkKyg/OltlRV1bKy1dP1xkK3wpLy5zb3VyY2UsYWE9bmV3IFJlZ0V4cCgiXig/OihbKy1dKT18KSgiK18rIikoW2EteiVdKikkIiwiaSIpLGJhPVsiVG9wIiwiUmlnaHQiLCJCb3R0b20iLCJMZWZ0Il0sY2E9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1ifHxhLCJub25lIj09PWEuc3R5bGUuZGlzcGxheXx8IiI9PT1hLnN0eWxlLmRpc3BsYXkmJnIuY29udGFpbnMoYS5vd25lckRvY3VtZW50LGEpJiYibm9uZSI9PT1yLmNzcyhhLCJkaXNwbGF5Iil9LGRhPWZ1bmN0aW9uKGEsYixjLGQpe3ZhciBlLGYsZz17fTtmb3IoZiBpbiBiKWdbZl09YS5zdHlsZVtmXSxhLnN0eWxlW2ZdPWJbZl07ZT1jLmFwcGx5KGEsZHx8W10pO2ZvcihmIGluIGIpYS5zdHlsZVtmXT1nW2ZdO3JldHVybiBlfTtmdW5jdGlvbiBlYShhLGIsYyxkKXt2YXIgZSxmPTEsZz0yMCxoPWQ/ZnVuY3Rpb24oKXtyZXR1cm4gZC5jdXIoKX06ZnVuY3Rpb24oKXtyZXR1cm4gci5jc3MoYSxiLCIiKX0saT1oKCksaj1jJiZjWzNdfHwoci5jc3NOdW1iZXJbYl0/IiI6InB4Iiksaz0oci5jc3NOdW1iZXJbYl18fCJweCIhPT1qJiYraSkmJmFhLmV4ZWMoci5jc3MoYSxiKSk7aWYoayYma1szXSE9PWope2o9anx8a1szXSxjPWN8fFtdLGs9K2l8fDE7ZG8gZj1mfHwiLjUiLGsvPWYsci5zdHlsZShhLGIsaytqKTt3aGlsZShmIT09KGY9aCgpL2kpJiYxIT09ZiYmLS1nKX1yZXR1cm4gYyYmKGs9K2t8fCtpfHwwLGU9Y1sxXT9rKyhjWzFdKzEpKmNbMl06K2NbMl0sZCYmKGQudW5pdD1qLGQuc3RhcnQ9ayxkLmVuZD1lKSksZX12YXIgZmE9e307ZnVuY3Rpb24gZ2EoYSl7dmFyIGIsYz1hLm93bmVyRG9jdW1lbnQsZD1hLm5vZGVOYW1lLGU9ZmFbZF07cmV0dXJuIGU/ZTooYj1jLmJvZHkuYXBwZW5kQ2hpbGQoYy5jcmVhdGVFbGVtZW50KGQpKSxlPXIuY3NzKGIsImRpc3BsYXkiKSxiLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoYiksIm5vbmUiPT09ZSYmKGU9ImJsb2NrIiksZmFbZF09ZSxlKX1mdW5jdGlvbiBoYShhLGIpe2Zvcih2YXIgYyxkLGU9W10sZj0wLGc9YS5sZW5ndGg7ZjxnO2YrKylkPWFbZl0sZC5zdHlsZSYmKGM9ZC5zdHlsZS5kaXNwbGF5LGI/KCJub25lIj09PWMmJihlW2ZdPVYuZ2V0KGQsImRpc3BsYXkiKXx8bnVsbCxlW2ZdfHwoZC5zdHlsZS5kaXNwbGF5PSIiKSksIiI9PT1kLnN0eWxlLmRpc3BsYXkmJmNhKGQpJiYoZVtmXT1nYShkKSkpOiJub25lIiE9PWMmJihlW2ZdPSJub25lIixWLnNldChkLCJkaXNwbGF5IixjKSkpO2ZvcihmPTA7ZjxnO2YrKyludWxsIT1lW2ZdJiYoYVtmXS5zdHlsZS5kaXNwbGF5PWVbZl0pO3JldHVybiBhfXIuZm4uZXh0ZW5kKHtzaG93OmZ1bmN0aW9uKCl7cmV0dXJuIGhhKHRoaXMsITApfSxoaWRlOmZ1bmN0aW9uKCl7cmV0dXJuIGhhKHRoaXMpfSx0b2dnbGU6ZnVuY3Rpb24oYSl7cmV0dXJuImJvb2xlYW4iPT10eXBlb2YgYT9hP3RoaXMuc2hvdygpOnRoaXMuaGlkZSgpOnRoaXMuZWFjaChmdW5jdGlvbigpe2NhKHRoaXMpP3IodGhpcykuc2hvdygpOnIodGhpcykuaGlkZSgpfSl9fSk7dmFyIGlhPS9eKD86Y2hlY2tib3h8cmFkaW8pJC9pLGphPS88KFthLXpdW15cL1wwPlx4MjBcdFxyXG5cZl0rKS9pLGthPS9eJHxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSxsYT17b3B0aW9uOlsxLCI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+IiwiPC9zZWxlY3Q+Il0sdGhlYWQ6WzEsIjx0YWJsZT4iLCI8L3RhYmxlPiJdLGNvbDpbMiwiPHRhYmxlPjxjb2xncm91cD4iLCI8L2NvbGdyb3VwPjwvdGFibGU+Il0sdHI6WzIsIjx0YWJsZT48dGJvZHk+IiwiPC90Ym9keT48L3RhYmxlPiJdLHRkOlszLCI8dGFibGU+PHRib2R5Pjx0cj4iLCI8L3RyPjwvdGJvZHk+PC90YWJsZT4iXSxfZGVmYXVsdDpbMCwiIiwiIl19O2xhLm9wdGdyb3VwPWxhLm9wdGlvbixsYS50Ym9keT1sYS50Zm9vdD1sYS5jb2xncm91cD1sYS5jYXB0aW9uPWxhLnRoZWFkLGxhLnRoPWxhLnRkO2Z1bmN0aW9uIG1hKGEsYil7dmFyIGM7cmV0dXJuIGM9InVuZGVmaW5lZCIhPXR5cGVvZiBhLmdldEVsZW1lbnRzQnlUYWdOYW1lP2EuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYnx8IioiKToidW5kZWZpbmVkIiE9dHlwZW9mIGEucXVlcnlTZWxlY3RvckFsbD9hLnF1ZXJ5U2VsZWN0b3JBbGwoYnx8IioiKTpbXSx2b2lkIDA9PT1ifHxiJiZyLm5vZGVOYW1lKGEsYik/ci5tZXJnZShbYV0sYyk6Y31mdW5jdGlvbiBuYShhLGIpe2Zvcih2YXIgYz0wLGQ9YS5sZW5ndGg7YzxkO2MrKylWLnNldChhW2NdLCJnbG9iYWxFdmFsIiwhYnx8Vi5nZXQoYltjXSwiZ2xvYmFsRXZhbCIpKX12YXIgb2E9Lzx8JiM/XHcrOy87ZnVuY3Rpb24gcGEoYSxiLGMsZCxlKXtmb3IodmFyIGYsZyxoLGksaixrLGw9Yi5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksbT1bXSxuPTAsbz1hLmxlbmd0aDtuPG87bisrKWlmKGY9YVtuXSxmfHwwPT09ZilpZigib2JqZWN0Ij09PXIudHlwZShmKSlyLm1lcmdlKG0sZi5ub2RlVHlwZT9bZl06Zik7ZWxzZSBpZihvYS50ZXN0KGYpKXtnPWd8fGwuYXBwZW5kQ2hpbGQoYi5jcmVhdGVFbGVtZW50KCJkaXYiKSksaD0oamEuZXhlYyhmKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKSxpPWxhW2hdfHxsYS5fZGVmYXVsdCxnLmlubmVySFRNTD1pWzFdK3IuaHRtbFByZWZpbHRlcihmKStpWzJdLGs9aVswXTt3aGlsZShrLS0pZz1nLmxhc3RDaGlsZDtyLm1lcmdlKG0sZy5jaGlsZE5vZGVzKSxnPWwuZmlyc3RDaGlsZCxnLnRleHRDb250ZW50PSIifWVsc2UgbS5wdXNoKGIuY3JlYXRlVGV4dE5vZGUoZikpO2wudGV4dENvbnRlbnQ9IiIsbj0wO3doaWxlKGY9bVtuKytdKWlmKGQmJnIuaW5BcnJheShmLGQpPi0xKWUmJmUucHVzaChmKTtlbHNlIGlmKGo9ci5jb250YWlucyhmLm93bmVyRG9jdW1lbnQsZiksZz1tYShsLmFwcGVuZENoaWxkKGYpLCJzY3JpcHQiKSxqJiZuYShnKSxjKXtrPTA7d2hpbGUoZj1nW2srK10pa2EudGVzdChmLnR5cGV8fCIiKSYmYy5wdXNoKGYpfXJldHVybiBsfSFmdW5jdGlvbigpe3ZhciBhPWQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLGI9YS5hcHBlbmRDaGlsZChkLmNyZWF0ZUVsZW1lbnQoImRpdiIpKSxjPWQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTtjLnNldEF0dHJpYnV0ZSgidHlwZSIsInJhZGlvIiksYy5zZXRBdHRyaWJ1dGUoImNoZWNrZWQiLCJjaGVja2VkIiksYy5zZXRBdHRyaWJ1dGUoIm5hbWUiLCJ0IiksYi5hcHBlbmRDaGlsZChjKSxvLmNoZWNrQ2xvbmU9Yi5jbG9uZU5vZGUoITApLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmNoZWNrZWQsYi5pbm5lckhUTUw9Ijx0ZXh0YXJlYT54PC90ZXh0YXJlYT4iLG8ubm9DbG9uZUNoZWNrZWQ9ISFiLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZX0oKTt2YXIgcWE9ZC5kb2N1bWVudEVsZW1lbnQscmE9L15rZXkvLHNhPS9eKD86bW91c2V8cG9pbnRlcnxjb250ZXh0bWVudXxkcmFnfGRyb3ApfGNsaWNrLyx0YT0vXihbXi5dKikoPzpcLiguKyl8KS87ZnVuY3Rpb24gdWEoKXtyZXR1cm4hMH1mdW5jdGlvbiB2YSgpe3JldHVybiExfWZ1bmN0aW9uIHdhKCl7dHJ5e3JldHVybiBkLmFjdGl2ZUVsZW1lbnR9Y2F0Y2goYSl7fX1mdW5jdGlvbiB4YShhLGIsYyxkLGUsZil7dmFyIGcsaDtpZigib2JqZWN0Ij09dHlwZW9mIGIpeyJzdHJpbmciIT10eXBlb2YgYyYmKGQ9ZHx8YyxjPXZvaWQgMCk7Zm9yKGggaW4gYil4YShhLGgsYyxkLGJbaF0sZik7cmV0dXJuIGF9aWYobnVsbD09ZCYmbnVsbD09ZT8oZT1jLGQ9Yz12b2lkIDApOm51bGw9PWUmJigic3RyaW5nIj09dHlwZW9mIGM/KGU9ZCxkPXZvaWQgMCk6KGU9ZCxkPWMsYz12b2lkIDApKSxlPT09ITEpZT12YTtlbHNlIGlmKCFlKXJldHVybiBhO3JldHVybiAxPT09ZiYmKGc9ZSxlPWZ1bmN0aW9uKGEpe3JldHVybiByKCkub2ZmKGEpLGcuYXBwbHkodGhpcyxhcmd1bWVudHMpfSxlLmd1aWQ9Zy5ndWlkfHwoZy5ndWlkPXIuZ3VpZCsrKSksYS5lYWNoKGZ1bmN0aW9uKCl7ci5ldmVudC5hZGQodGhpcyxiLGUsZCxjKX0pfXIuZXZlbnQ9e2dsb2JhbDp7fSxhZGQ6ZnVuY3Rpb24oYSxiLGMsZCxlKXt2YXIgZixnLGgsaSxqLGssbCxtLG4sbyxwLHE9Vi5nZXQoYSk7aWYocSl7Yy5oYW5kbGVyJiYoZj1jLGM9Zi5oYW5kbGVyLGU9Zi5zZWxlY3RvciksZSYmci5maW5kLm1hdGNoZXNTZWxlY3RvcihxYSxlKSxjLmd1aWR8fChjLmd1aWQ9ci5ndWlkKyspLChpPXEuZXZlbnRzKXx8KGk9cS5ldmVudHM9e30pLChnPXEuaGFuZGxlKXx8KGc9cS5oYW5kbGU9ZnVuY3Rpb24oYil7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiByJiZyLmV2ZW50LnRyaWdnZXJlZCE9PWIudHlwZT9yLmV2ZW50LmRpc3BhdGNoLmFwcGx5KGEsYXJndW1lbnRzKTp2b2lkIDB9KSxiPShifHwiIikubWF0Y2goSyl8fFsiIl0saj1iLmxlbmd0aDt3aGlsZShqLS0paD10YS5leGVjKGJbal0pfHxbXSxuPXA9aFsxXSxvPShoWzJdfHwiIikuc3BsaXQoIi4iKS5zb3J0KCksbiYmKGw9ci5ldmVudC5zcGVjaWFsW25dfHx7fSxuPShlP2wuZGVsZWdhdGVUeXBlOmwuYmluZFR5cGUpfHxuLGw9ci5ldmVudC5zcGVjaWFsW25dfHx7fSxrPXIuZXh0ZW5kKHt0eXBlOm4sb3JpZ1R5cGU6cCxkYXRhOmQsaGFuZGxlcjpjLGd1aWQ6Yy5ndWlkLHNlbGVjdG9yOmUsbmVlZHNDb250ZXh0OmUmJnIuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQudGVzdChlKSxuYW1lc3BhY2U6by5qb2luKCIuIil9LGYpLChtPWlbbl0pfHwobT1pW25dPVtdLG0uZGVsZWdhdGVDb3VudD0wLGwuc2V0dXAmJmwuc2V0dXAuY2FsbChhLGQsbyxnKSE9PSExfHxhLmFkZEV2ZW50TGlzdGVuZXImJmEuYWRkRXZlbnRMaXN0ZW5lcihuLGcpKSxsLmFkZCYmKGwuYWRkLmNhbGwoYSxrKSxrLmhhbmRsZXIuZ3VpZHx8KGsuaGFuZGxlci5ndWlkPWMuZ3VpZCkpLGU/bS5zcGxpY2UobS5kZWxlZ2F0ZUNvdW50KyssMCxrKTptLnB1c2goayksci5ldmVudC5nbG9iYWxbbl09ITApfX0scmVtb3ZlOmZ1bmN0aW9uKGEsYixjLGQsZSl7dmFyIGYsZyxoLGksaixrLGwsbSxuLG8scCxxPVYuaGFzRGF0YShhKSYmVi5nZXQoYSk7aWYocSYmKGk9cS5ldmVudHMpKXtiPShifHwiIikubWF0Y2goSyl8fFsiIl0saj1iLmxlbmd0aDt3aGlsZShqLS0paWYoaD10YS5leGVjKGJbal0pfHxbXSxuPXA9aFsxXSxvPShoWzJdfHwiIikuc3BsaXQoIi4iKS5zb3J0KCksbil7bD1yLmV2ZW50LnNwZWNpYWxbbl18fHt9LG49KGQ/bC5kZWxlZ2F0ZVR5cGU6bC5iaW5kVHlwZSl8fG4sbT1pW25dfHxbXSxoPWhbMl0mJm5ldyBSZWdFeHAoIihefFxcLikiK28uam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIiksZz1mPW0ubGVuZ3RoO3doaWxlKGYtLSlrPW1bZl0sIWUmJnAhPT1rLm9yaWdUeXBlfHxjJiZjLmd1aWQhPT1rLmd1aWR8fGgmJiFoLnRlc3Qoay5uYW1lc3BhY2UpfHxkJiZkIT09ay5zZWxlY3RvciYmKCIqKiIhPT1kfHwhay5zZWxlY3Rvcil8fChtLnNwbGljZShmLDEpLGsuc2VsZWN0b3ImJm0uZGVsZWdhdGVDb3VudC0tLGwucmVtb3ZlJiZsLnJlbW92ZS5jYWxsKGEsaykpO2cmJiFtLmxlbmd0aCYmKGwudGVhcmRvd24mJmwudGVhcmRvd24uY2FsbChhLG8scS5oYW5kbGUpIT09ITF8fHIucmVtb3ZlRXZlbnQoYSxuLHEuaGFuZGxlKSxkZWxldGUgaVtuXSl9ZWxzZSBmb3IobiBpbiBpKXIuZXZlbnQucmVtb3ZlKGEsbitiW2pdLGMsZCwhMCk7ci5pc0VtcHR5T2JqZWN0KGkpJiZWLnJlbW92ZShhLCJoYW5kbGUgZXZlbnRzIil9fSxkaXNwYXRjaDpmdW5jdGlvbihhKXt2YXIgYj1yLmV2ZW50LmZpeChhKSxjLGQsZSxmLGcsaCxpPW5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKSxqPShWLmdldCh0aGlzLCJldmVudHMiKXx8e30pW2IudHlwZV18fFtdLGs9ci5ldmVudC5zcGVjaWFsW2IudHlwZV18fHt9O2ZvcihpWzBdPWIsYz0xO2M8YXJndW1lbnRzLmxlbmd0aDtjKyspaVtjXT1hcmd1bWVudHNbY107aWYoYi5kZWxlZ2F0ZVRhcmdldD10aGlzLCFrLnByZURpc3BhdGNofHxrLnByZURpc3BhdGNoLmNhbGwodGhpcyxiKSE9PSExKXtoPXIuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLGIsaiksYz0wO3doaWxlKChmPWhbYysrXSkmJiFiLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe2IuY3VycmVudFRhcmdldD1mLmVsZW0sZD0wO3doaWxlKChnPWYuaGFuZGxlcnNbZCsrXSkmJiFiLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpYi5ybmFtZXNwYWNlJiYhYi5ybmFtZXNwYWNlLnRlc3QoZy5uYW1lc3BhY2UpfHwoYi5oYW5kbGVPYmo9ZyxiLmRhdGE9Zy5kYXRhLGU9KChyLmV2ZW50LnNwZWNpYWxbZy5vcmlnVHlwZV18fHt9KS5oYW5kbGV8fGcuaGFuZGxlcikuYXBwbHkoZi5lbGVtLGkpLHZvaWQgMCE9PWUmJihiLnJlc3VsdD1lKT09PSExJiYoYi5wcmV2ZW50RGVmYXVsdCgpLGIuc3RvcFByb3BhZ2F0aW9uKCkpKX1yZXR1cm4gay5wb3N0RGlzcGF0Y2gmJmsucG9zdERpc3BhdGNoLmNhbGwodGhpcyxiKSxiLnJlc3VsdH19LGhhbmRsZXJzOmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlLGYsZyxoPVtdLGk9Yi5kZWxlZ2F0ZUNvdW50LGo9YS50YXJnZXQ7aWYoaSYmai5ub2RlVHlwZSYmISgiY2xpY2siPT09YS50eXBlJiZhLmJ1dHRvbj49MSkpZm9yKDtqIT09dGhpcztqPWoucGFyZW50Tm9kZXx8dGhpcylpZigxPT09ai5ub2RlVHlwZSYmKCJjbGljayIhPT1hLnR5cGV8fGouZGlzYWJsZWQhPT0hMCkpe2ZvcihmPVtdLGc9e30sYz0wO2M8aTtjKyspZD1iW2NdLGU9ZC5zZWxlY3RvcisiICIsdm9pZCAwPT09Z1tlXSYmKGdbZV09ZC5uZWVkc0NvbnRleHQ/cihlLHRoaXMpLmluZGV4KGopPi0xOnIuZmluZChlLHRoaXMsbnVsbCxbal0pLmxlbmd0aCksZ1tlXSYmZi5wdXNoKGQpO2YubGVuZ3RoJiZoLnB1c2goe2VsZW06aixoYW5kbGVyczpmfSl9cmV0dXJuIGo9dGhpcyxpPGIubGVuZ3RoJiZoLnB1c2goe2VsZW06aixoYW5kbGVyczpiLnNsaWNlKGkpfSksaH0sYWRkUHJvcDpmdW5jdGlvbihhLGIpe09iamVjdC5kZWZpbmVQcm9wZXJ0eShyLkV2ZW50LnByb3RvdHlwZSxhLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCxnZXQ6ci5pc0Z1bmN0aW9uKGIpP2Z1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiBiKHRoaXMub3JpZ2luYWxFdmVudCl9OmZ1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiB0aGlzLm9yaWdpbmFsRXZlbnRbYV19LHNldDpmdW5jdGlvbihiKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyxhLHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTpifSl9fSl9LGZpeDpmdW5jdGlvbihhKXtyZXR1cm4gYVtyLmV4cGFuZG9dP2E6bmV3IHIuRXZlbnQoYSl9LHNwZWNpYWw6e2xvYWQ6e25vQnViYmxlOiEwfSxmb2N1czp7dHJpZ2dlcjpmdW5jdGlvbigpe2lmKHRoaXMhPT13YSgpJiZ0aGlzLmZvY3VzKXJldHVybiB0aGlzLmZvY3VzKCksITF9LGRlbGVnYXRlVHlwZToiZm9jdXNpbiJ9LGJsdXI6e3RyaWdnZXI6ZnVuY3Rpb24oKXtpZih0aGlzPT09d2EoKSYmdGhpcy5ibHVyKXJldHVybiB0aGlzLmJsdXIoKSwhMX0sZGVsZWdhdGVUeXBlOiJmb2N1c291dCJ9LGNsaWNrOnt0cmlnZ2VyOmZ1bmN0aW9uKCl7aWYoImNoZWNrYm94Ij09PXRoaXMudHlwZSYmdGhpcy5jbGljayYmci5ub2RlTmFtZSh0aGlzLCJpbnB1dCIpKXJldHVybiB0aGlzLmNsaWNrKCksITF9LF9kZWZhdWx0OmZ1bmN0aW9uKGEpe3JldHVybiByLm5vZGVOYW1lKGEudGFyZ2V0LCJhIil9fSxiZWZvcmV1bmxvYWQ6e3Bvc3REaXNwYXRjaDpmdW5jdGlvbihhKXt2b2lkIDAhPT1hLnJlc3VsdCYmYS5vcmlnaW5hbEV2ZW50JiYoYS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlPWEucmVzdWx0KX19fX0sci5yZW1vdmVFdmVudD1mdW5jdGlvbihhLGIsYyl7YS5yZW1vdmVFdmVudExpc3RlbmVyJiZhLnJlbW92ZUV2ZW50TGlzdGVuZXIoYixjKX0sci5FdmVudD1mdW5jdGlvbihhLGIpe3JldHVybiB0aGlzIGluc3RhbmNlb2Ygci5FdmVudD8oYSYmYS50eXBlPyh0aGlzLm9yaWdpbmFsRXZlbnQ9YSx0aGlzLnR5cGU9YS50eXBlLHRoaXMuaXNEZWZhdWx0UHJldmVudGVkPWEuZGVmYXVsdFByZXZlbnRlZHx8dm9pZCAwPT09YS5kZWZhdWx0UHJldmVudGVkJiZhLnJldHVyblZhbHVlPT09ITE/dWE6dmEsdGhpcy50YXJnZXQ9YS50YXJnZXQmJjM9PT1hLnRhcmdldC5ub2RlVHlwZT9hLnRhcmdldC5wYXJlbnROb2RlOmEudGFyZ2V0LHRoaXMuY3VycmVudFRhcmdldD1hLmN1cnJlbnRUYXJnZXQsdGhpcy5yZWxhdGVkVGFyZ2V0PWEucmVsYXRlZFRhcmdldCk6dGhpcy50eXBlPWEsYiYmci5leHRlbmQodGhpcyxiKSx0aGlzLnRpbWVTdGFtcD1hJiZhLnRpbWVTdGFtcHx8ci5ub3coKSx2b2lkKHRoaXNbci5leHBhbmRvXT0hMCkpOm5ldyByLkV2ZW50KGEsYil9LHIuRXZlbnQucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpyLkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDp2YSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDp2YSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDp2YSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBhPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD11YSxhJiYhdGhpcy5pc1NpbXVsYXRlZCYmYS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD11YSxhJiYhdGhpcy5pc1NpbXVsYXRlZCYmYS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGE9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9dWEsYSYmIXRoaXMuaXNTaW11bGF0ZWQmJmEuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LHIuZWFjaCh7YWx0S2V5OiEwLGJ1YmJsZXM6ITAsY2FuY2VsYWJsZTohMCxjaGFuZ2VkVG91Y2hlczohMCxjdHJsS2V5OiEwLGRldGFpbDohMCxldmVudFBoYXNlOiEwLG1ldGFLZXk6ITAscGFnZVg6ITAscGFnZVk6ITAsc2hpZnRLZXk6ITAsdmlldzohMCwiY2hhciI6ITAsY2hhckNvZGU6ITAsa2V5OiEwLGtleUNvZGU6ITAsYnV0dG9uOiEwLGJ1dHRvbnM6ITAsY2xpZW50WDohMCxjbGllbnRZOiEwLG9mZnNldFg6ITAsb2Zmc2V0WTohMCxwb2ludGVySWQ6ITAscG9pbnRlclR5cGU6ITAsc2NyZWVuWDohMCxzY3JlZW5ZOiEwLHRhcmdldFRvdWNoZXM6ITAsdG9FbGVtZW50OiEwLHRvdWNoZXM6ITAsd2hpY2g6ZnVuY3Rpb24oYSl7dmFyIGI9YS5idXR0b247cmV0dXJuIG51bGw9PWEud2hpY2gmJnJhLnRlc3QoYS50eXBlKT9udWxsIT1hLmNoYXJDb2RlP2EuY2hhckNvZGU6YS5rZXlDb2RlOiFhLndoaWNoJiZ2b2lkIDAhPT1iJiZzYS50ZXN0KGEudHlwZSk/MSZiPzE6MiZiPzM6NCZiPzI6MDphLndoaWNofX0sci5ldmVudC5hZGRQcm9wKSxyLmVhY2goe21vdXNlZW50ZXI6Im1vdXNlb3ZlciIsbW91c2VsZWF2ZToibW91c2VvdXQiLHBvaW50ZXJlbnRlcjoicG9pbnRlcm92ZXIiLHBvaW50ZXJsZWF2ZToicG9pbnRlcm91dCJ9LGZ1bmN0aW9uKGEsYil7ci5ldmVudC5zcGVjaWFsW2FdPXtkZWxlZ2F0ZVR5cGU6YixiaW5kVHlwZTpiLGhhbmRsZTpmdW5jdGlvbihhKXt2YXIgYyxkPXRoaXMsZT1hLnJlbGF0ZWRUYXJnZXQsZj1hLmhhbmRsZU9iajtyZXR1cm4gZSYmKGU9PT1kfHxyLmNvbnRhaW5zKGQsZSkpfHwoYS50eXBlPWYub3JpZ1R5cGUsYz1mLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGEudHlwZT1iKSxjfX19KSxyLmZuLmV4dGVuZCh7b246ZnVuY3Rpb24oYSxiLGMsZCl7cmV0dXJuIHhhKHRoaXMsYSxiLGMsZCl9LG9uZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4geGEodGhpcyxhLGIsYyxkLDEpfSxvZmY6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGU7aWYoYSYmYS5wcmV2ZW50RGVmYXVsdCYmYS5oYW5kbGVPYmopcmV0dXJuIGQ9YS5oYW5kbGVPYmoscihhLmRlbGVnYXRlVGFyZ2V0KS5vZmYoZC5uYW1lc3BhY2U/ZC5vcmlnVHlwZSsiLiIrZC5uYW1lc3BhY2U6ZC5vcmlnVHlwZSxkLnNlbGVjdG9yLGQuaGFuZGxlciksdGhpcztpZigib2JqZWN0Ij09dHlwZW9mIGEpe2ZvcihlIGluIGEpdGhpcy5vZmYoZSxiLGFbZV0pO3JldHVybiB0aGlzfXJldHVybiBiIT09ITEmJiJmdW5jdGlvbiIhPXR5cGVvZiBifHwoYz1iLGI9dm9pZCAwKSxjPT09ITEmJihjPXZhKSx0aGlzLmVhY2goZnVuY3Rpb24oKXtyLmV2ZW50LnJlbW92ZSh0aGlzLGEsYyxiKX0pfX0pO3ZhciB5YT0vPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKilbXj5dKilcLz4vZ2ksemE9LzxzY3JpcHR8PHN0eWxlfDxsaW5rL2ksQWE9L2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4pL2ksQmE9L150cnVlXC8oLiopLyxDYT0vXlxzKjwhKD86XFtDREFUQVxbfC0tKXwoPzpcXVxdfC0tKT5ccyokL2c7ZnVuY3Rpb24gRGEoYSxiKXtyZXR1cm4gci5ub2RlTmFtZShhLCJ0YWJsZSIpJiZyLm5vZGVOYW1lKDExIT09Yi5ub2RlVHlwZT9iOmIuZmlyc3RDaGlsZCwidHIiKT9hLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpWzBdfHxhOmF9ZnVuY3Rpb24gRWEoYSl7cmV0dXJuIGEudHlwZT0obnVsbCE9PWEuZ2V0QXR0cmlidXRlKCJ0eXBlIikpKyIvIithLnR5cGUsYX1mdW5jdGlvbiBGYShhKXt2YXIgYj1CYS5leGVjKGEudHlwZSk7cmV0dXJuIGI/YS50eXBlPWJbMV06YS5yZW1vdmVBdHRyaWJ1dGUoInR5cGUiKSxhfWZ1bmN0aW9uIEdhKGEsYil7dmFyIGMsZCxlLGYsZyxoLGksajtpZigxPT09Yi5ub2RlVHlwZSl7aWYoVi5oYXNEYXRhKGEpJiYoZj1WLmFjY2VzcyhhKSxnPVYuc2V0KGIsZiksaj1mLmV2ZW50cykpe2RlbGV0ZSBnLmhhbmRsZSxnLmV2ZW50cz17fTtmb3IoZSBpbiBqKWZvcihjPTAsZD1qW2VdLmxlbmd0aDtjPGQ7YysrKXIuZXZlbnQuYWRkKGIsZSxqW2VdW2NdKX1XLmhhc0RhdGEoYSkmJihoPVcuYWNjZXNzKGEpLGk9ci5leHRlbmQoe30saCksVy5zZXQoYixpKSl9fWZ1bmN0aW9uIEhhKGEsYil7dmFyIGM9Yi5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOyJpbnB1dCI9PT1jJiZpYS50ZXN0KGEudHlwZSk/Yi5jaGVja2VkPWEuY2hlY2tlZDoiaW5wdXQiIT09YyYmInRleHRhcmVhIiE9PWN8fChiLmRlZmF1bHRWYWx1ZT1hLmRlZmF1bHRWYWx1ZSl9ZnVuY3Rpb24gSWEoYSxiLGMsZCl7Yj1nLmFwcGx5KFtdLGIpO3ZhciBlLGYsaCxpLGosayxsPTAsbT1hLmxlbmd0aCxuPW0tMSxxPWJbMF0scz1yLmlzRnVuY3Rpb24ocSk7aWYoc3x8bT4xJiYic3RyaW5nIj09dHlwZW9mIHEmJiFvLmNoZWNrQ2xvbmUmJkFhLnRlc3QocSkpcmV0dXJuIGEuZWFjaChmdW5jdGlvbihlKXt2YXIgZj1hLmVxKGUpO3MmJihiWzBdPXEuY2FsbCh0aGlzLGUsZi5odG1sKCkpKSxJYShmLGIsYyxkKX0pO2lmKG0mJihlPXBhKGIsYVswXS5vd25lckRvY3VtZW50LCExLGEsZCksZj1lLmZpcnN0Q2hpbGQsMT09PWUuY2hpbGROb2Rlcy5sZW5ndGgmJihlPWYpLGZ8fGQpKXtmb3IoaD1yLm1hcChtYShlLCJzY3JpcHQiKSxFYSksaT1oLmxlbmd0aDtsPG07bCsrKWo9ZSxsIT09biYmKGo9ci5jbG9uZShqLCEwLCEwKSxpJiZyLm1lcmdlKGgsbWEoaiwic2NyaXB0IikpKSxjLmNhbGwoYVtsXSxqLGwpO2lmKGkpZm9yKGs9aFtoLmxlbmd0aC0xXS5vd25lckRvY3VtZW50LHIubWFwKGgsRmEpLGw9MDtsPGk7bCsrKWo9aFtsXSxrYS50ZXN0KGoudHlwZXx8IiIpJiYhVi5hY2Nlc3MoaiwiZ2xvYmFsRXZhbCIpJiZyLmNvbnRhaW5zKGssaikmJihqLnNyYz9yLl9ldmFsVXJsJiZyLl9ldmFsVXJsKGouc3JjKTpwKGoudGV4dENvbnRlbnQucmVwbGFjZShDYSwiIiksaykpfXJldHVybiBhfWZ1bmN0aW9uIEphKGEsYixjKXtmb3IodmFyIGQsZT1iP3IuZmlsdGVyKGIsYSk6YSxmPTA7bnVsbCE9KGQ9ZVtmXSk7ZisrKWN8fDEhPT1kLm5vZGVUeXBlfHxyLmNsZWFuRGF0YShtYShkKSksZC5wYXJlbnROb2RlJiYoYyYmci5jb250YWlucyhkLm93bmVyRG9jdW1lbnQsZCkmJm5hKG1hKGQsInNjcmlwdCIpKSxkLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZCkpO3JldHVybiBhfXIuZXh0ZW5kKHtodG1sUHJlZmlsdGVyOmZ1bmN0aW9uKGEpe3JldHVybiBhLnJlcGxhY2UoeWEsIjwkMT48LyQyPiIpfSxjbG9uZTpmdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLmNsb25lTm9kZSghMCksaT1yLmNvbnRhaW5zKGEub3duZXJEb2N1bWVudCxhKTtpZighKG8ubm9DbG9uZUNoZWNrZWR8fDEhPT1hLm5vZGVUeXBlJiYxMSE9PWEubm9kZVR5cGV8fHIuaXNYTUxEb2MoYSkpKWZvcihnPW1hKGgpLGY9bWEoYSksZD0wLGU9Zi5sZW5ndGg7ZDxlO2QrKylIYShmW2RdLGdbZF0pO2lmKGIpaWYoYylmb3IoZj1mfHxtYShhKSxnPWd8fG1hKGgpLGQ9MCxlPWYubGVuZ3RoO2Q8ZTtkKyspR2EoZltkXSxnW2RdKTtlbHNlIEdhKGEsaCk7cmV0dXJuIGc9bWEoaCwic2NyaXB0IiksZy5sZW5ndGg+MCYmbmEoZywhaSYmbWEoYSwic2NyaXB0IikpLGh9LGNsZWFuRGF0YTpmdW5jdGlvbihhKXtmb3IodmFyIGIsYyxkLGU9ci5ldmVudC5zcGVjaWFsLGY9MDt2b2lkIDAhPT0oYz1hW2ZdKTtmKyspaWYoVChjKSl7aWYoYj1jW1YuZXhwYW5kb10pe2lmKGIuZXZlbnRzKWZvcihkIGluIGIuZXZlbnRzKWVbZF0/ci5ldmVudC5yZW1vdmUoYyxkKTpyLnJlbW92ZUV2ZW50KGMsZCxiLmhhbmRsZSk7Y1tWLmV4cGFuZG9dPXZvaWQgMH1jW1cuZXhwYW5kb10mJihjW1cuZXhwYW5kb109dm9pZCAwKX19fSksci5mbi5leHRlbmQoe2RldGFjaDpmdW5jdGlvbihhKXtyZXR1cm4gSmEodGhpcyxhLCEwKX0scmVtb3ZlOmZ1bmN0aW9uKGEpe3JldHVybiBKYSh0aGlzLGEpfSx0ZXh0OmZ1bmN0aW9uKGEpe3JldHVybiBTKHRoaXMsZnVuY3Rpb24oYSl7cmV0dXJuIHZvaWQgMD09PWE/ci50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCl7MSE9PXRoaXMubm9kZVR5cGUmJjExIT09dGhpcy5ub2RlVHlwZSYmOSE9PXRoaXMubm9kZVR5cGV8fCh0aGlzLnRleHRDb250ZW50PWEpfSl9LG51bGwsYSxhcmd1bWVudHMubGVuZ3RoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuIElhKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGEpe2lmKDE9PT10aGlzLm5vZGVUeXBlfHwxMT09PXRoaXMubm9kZVR5cGV8fDk9PT10aGlzLm5vZGVUeXBlKXt2YXIgYj1EYSh0aGlzLGEpO2IuYXBwZW5kQ2hpbGQoYSl9fSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gSWEodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oYSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciBiPURhKHRoaXMsYSk7Yi5pbnNlcnRCZWZvcmUoYSxiLmZpcnN0Q2hpbGQpfX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtyZXR1cm4gSWEodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcyl9KX0sYWZ0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gSWEodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oYSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGEsdGhpcy5uZXh0U2libGluZyl9KX0sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGEsYj0wO251bGwhPShhPXRoaXNbYl0pO2IrKykxPT09YS5ub2RlVHlwZSYmKHIuY2xlYW5EYXRhKG1hKGEsITEpKSxhLnRleHRDb250ZW50PSIiKTtyZXR1cm4gdGhpc30sY2xvbmU6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYT1udWxsIT1hJiZhLGI9bnVsbD09Yj9hOmIsdGhpcy5tYXAoZnVuY3Rpb24oKXtyZXR1cm4gci5jbG9uZSh0aGlzLGEsYil9KX0saHRtbDpmdW5jdGlvbihhKXtyZXR1cm4gUyh0aGlzLGZ1bmN0aW9uKGEpe3ZhciBiPXRoaXNbMF18fHt9LGM9MCxkPXRoaXMubGVuZ3RoO2lmKHZvaWQgMD09PWEmJjE9PT1iLm5vZGVUeXBlKXJldHVybiBiLmlubmVySFRNTDtpZigic3RyaW5nIj09dHlwZW9mIGEmJiF6YS50ZXN0KGEpJiYhbGFbKGphLmV4ZWMoYSl8fFsiIiwiIl0pWzFdLnRvTG93ZXJDYXNlKCldKXthPXIuaHRtbFByZWZpbHRlcihhKTt0cnl7Zm9yKDtjPGQ7YysrKWI9dGhpc1tjXXx8e30sMT09PWIubm9kZVR5cGUmJihyLmNsZWFuRGF0YShtYShiLCExKSksYi5pbm5lckhUTUw9YSk7Yj0wfWNhdGNoKGUpe319YiYmdGhpcy5lbXB0eSgpLmFwcGVuZChhKX0sbnVsbCxhLGFyZ3VtZW50cy5sZW5ndGgpfSxyZXBsYWNlV2l0aDpmdW5jdGlvbigpe3ZhciBhPVtdO3JldHVybiBJYSh0aGlzLGFyZ3VtZW50cyxmdW5jdGlvbihiKXt2YXIgYz10aGlzLnBhcmVudE5vZGU7ci5pbkFycmF5KHRoaXMsYSk8MCYmKHIuY2xlYW5EYXRhKG1hKHRoaXMpKSxjJiZjLnJlcGxhY2VDaGlsZChiLHRoaXMpKX0sYSl9fSksci5lYWNoKHthcHBlbmRUbzoiYXBwZW5kIixwcmVwZW5kVG86InByZXBlbmQiLGluc2VydEJlZm9yZToiYmVmb3JlIixpbnNlcnRBZnRlcjoiYWZ0ZXIiLHJlcGxhY2VBbGw6InJlcGxhY2VXaXRoIn0sZnVuY3Rpb24oYSxiKXtyLmZuW2FdPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYyxkPVtdLGU9cihhKSxmPWUubGVuZ3RoLTEsZz0wO2c8PWY7ZysrKWM9Zz09PWY/dGhpczp0aGlzLmNsb25lKCEwKSxyKGVbZ10pW2JdKGMpLGguYXBwbHkoZCxjLmdldCgpKTtyZXR1cm4gdGhpcy5wdXNoU3RhY2soZCl9fSk7dmFyIEthPS9ebWFyZ2luLyxMYT1uZXcgUmVnRXhwKCJeKCIrXysiKSg/IXB4KVthLXolXSskIiwiaSIpLE1hPWZ1bmN0aW9uKGIpe3ZhciBjPWIub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztyZXR1cm4gYyYmYy5vcGVuZXJ8fChjPWEpLGMuZ2V0Q29tcHV0ZWRTdHlsZShiKX07IWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYigpe2lmKGkpe2kuc3R5bGUuY3NzVGV4dD0iYm94LXNpemluZzpib3JkZXItYm94O3Bvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7bWFyZ2luOmF1dG87Ym9yZGVyOjFweDtwYWRkaW5nOjFweDt0b3A6MSU7d2lkdGg6NTAlIixpLmlubmVySFRNTD0iIixxYS5hcHBlbmRDaGlsZChoKTt2YXIgYj1hLmdldENvbXB1dGVkU3R5bGUoaSk7Yz0iMSUiIT09Yi50b3AsZz0iMnB4Ij09PWIubWFyZ2luTGVmdCxlPSI0cHgiPT09Yi53aWR0aCxpLnN0eWxlLm1hcmdpblJpZ2h0PSI1MCUiLGY9IjRweCI9PT1iLm1hcmdpblJpZ2h0LHFhLnJlbW92ZUNoaWxkKGgpLGk9bnVsbH19dmFyIGMsZSxmLGcsaD1kLmNyZWF0ZUVsZW1lbnQoImRpdiIpLGk9ZC5jcmVhdGVFbGVtZW50KCJkaXYiKTtpLnN0eWxlJiYoaS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iY29udGVudC1ib3giLGkuY2xvbmVOb2RlKCEwKS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcD0iIixvLmNsZWFyQ2xvbmVTdHlsZT0iY29udGVudC1ib3giPT09aS5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCxoLnN0eWxlLmNzc1RleHQ9ImJvcmRlcjowO3dpZHRoOjhweDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHg7cGFkZGluZzowO21hcmdpbi10b3A6MXB4O3Bvc2l0aW9uOmFic29sdXRlIixoLmFwcGVuZENoaWxkKGkpLHIuZXh0ZW5kKG8se3BpeGVsUG9zaXRpb246ZnVuY3Rpb24oKXtyZXR1cm4gYigpLGN9LGJveFNpemluZ1JlbGlhYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGIoKSxlfSxwaXhlbE1hcmdpblJpZ2h0OmZ1bmN0aW9uKCl7cmV0dXJuIGIoKSxmfSxyZWxpYWJsZU1hcmdpbkxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gYigpLGd9fSkpfSgpO2Z1bmN0aW9uIE5hKGEsYixjKXt2YXIgZCxlLGYsZyxoPWEuc3R5bGU7cmV0dXJuIGM9Y3x8TWEoYSksYyYmKGc9Yy5nZXRQcm9wZXJ0eVZhbHVlKGIpfHxjW2JdLCIiIT09Z3x8ci5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsYSl8fChnPXIuc3R5bGUoYSxiKSksIW8ucGl4ZWxNYXJnaW5SaWdodCgpJiZMYS50ZXN0KGcpJiZLYS50ZXN0KGIpJiYoZD1oLndpZHRoLGU9aC5taW5XaWR0aCxmPWgubWF4V2lkdGgsaC5taW5XaWR0aD1oLm1heFdpZHRoPWgud2lkdGg9ZyxnPWMud2lkdGgsaC53aWR0aD1kLGgubWluV2lkdGg9ZSxoLm1heFdpZHRoPWYpKSx2b2lkIDAhPT1nP2crIiI6Z31mdW5jdGlvbiBPYShhLGIpe3JldHVybntnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gYSgpP3ZvaWQgZGVsZXRlIHRoaXMuZ2V0Oih0aGlzLmdldD1iKS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9fX12YXIgUGE9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLFFhPXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxSYT17bGV0dGVyU3BhY2luZzoiMCIsZm9udFdlaWdodDoiNDAwIn0sU2E9WyJXZWJraXQiLCJNb3oiLCJtcyJdLFRhPWQuY3JlYXRlRWxlbWVudCgiZGl2Iikuc3R5bGU7ZnVuY3Rpb24gVWEoYSl7aWYoYSBpbiBUYSlyZXR1cm4gYTt2YXIgYj1hWzBdLnRvVXBwZXJDYXNlKCkrYS5zbGljZSgxKSxjPVNhLmxlbmd0aDt3aGlsZShjLS0paWYoYT1TYVtjXStiLGEgaW4gVGEpcmV0dXJuIGF9ZnVuY3Rpb24gVmEoYSxiLGMpe3ZhciBkPWFhLmV4ZWMoYik7cmV0dXJuIGQ/TWF0aC5tYXgoMCxkWzJdLShjfHwwKSkrKGRbM118fCJweCIpOmJ9ZnVuY3Rpb24gV2EoYSxiLGMsZCxlKXt2YXIgZixnPTA7Zm9yKGY9Yz09PShkPyJib3JkZXIiOiJjb250ZW50Iik/NDoid2lkdGgiPT09Yj8xOjA7Zjw0O2YrPTIpIm1hcmdpbiI9PT1jJiYoZys9ci5jc3MoYSxjK2JhW2ZdLCEwLGUpKSxkPygiY29udGVudCI9PT1jJiYoZy09ci5jc3MoYSwicGFkZGluZyIrYmFbZl0sITAsZSkpLCJtYXJnaW4iIT09YyYmKGctPXIuY3NzKGEsImJvcmRlciIrYmFbZl0rIldpZHRoIiwhMCxlKSkpOihnKz1yLmNzcyhhLCJwYWRkaW5nIitiYVtmXSwhMCxlKSwicGFkZGluZyIhPT1jJiYoZys9ci5jc3MoYSwiYm9yZGVyIitiYVtmXSsiV2lkdGgiLCEwLGUpKSk7cmV0dXJuIGd9ZnVuY3Rpb24gWGEoYSxiLGMpe3ZhciBkLGU9ITAsZj1NYShhKSxnPSJib3JkZXItYm94Ij09PXIuY3NzKGEsImJveFNpemluZyIsITEsZik7aWYoYS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCYmKGQ9YS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVtiXSksZDw9MHx8bnVsbD09ZCl7aWYoZD1OYShhLGIsZiksKGQ8MHx8bnVsbD09ZCkmJihkPWEuc3R5bGVbYl0pLExhLnRlc3QoZCkpcmV0dXJuIGQ7ZT1nJiYoby5ib3hTaXppbmdSZWxpYWJsZSgpfHxkPT09YS5zdHlsZVtiXSksZD1wYXJzZUZsb2F0KGQpfHwwfXJldHVybiBkK1dhKGEsYixjfHwoZz8iYm9yZGVyIjoiY29udGVudCIpLGUsZikrInB4In1yLmV4dGVuZCh7Y3NzSG9va3M6e29wYWNpdHk6e2dldDpmdW5jdGlvbihhLGIpe2lmKGIpe3ZhciBjPU5hKGEsIm9wYWNpdHkiKTtyZXR1cm4iIj09PWM/IjEiOmN9fX19LGNzc051bWJlcjp7YW5pbWF0aW9uSXRlcmF0aW9uQ291bnQ6ITAsY29sdW1uQ291bnQ6ITAsZmlsbE9wYWNpdHk6ITAsZmxleEdyb3c6ITAsZmxleFNocmluazohMCxmb250V2VpZ2h0OiEwLGxpbmVIZWlnaHQ6ITAsb3BhY2l0eTohMCxvcmRlcjohMCxvcnBoYW5zOiEwLHdpZG93czohMCx6SW5kZXg6ITAsem9vbTohMH0sY3NzUHJvcHM6eyJmbG9hdCI6ImNzc0Zsb2F0In0sc3R5bGU6ZnVuY3Rpb24oYSxiLGMsZCl7aWYoYSYmMyE9PWEubm9kZVR5cGUmJjghPT1hLm5vZGVUeXBlJiZhLnN0eWxlKXt2YXIgZSxmLGcsaD1yLmNhbWVsQ2FzZShiKSxpPWEuc3R5bGU7cmV0dXJuIGI9ci5jc3NQcm9wc1toXXx8KHIuY3NzUHJvcHNbaF09VWEoaCl8fGgpLGc9ci5jc3NIb29rc1tiXXx8ci5jc3NIb29rc1toXSx2b2lkIDA9PT1jP2cmJiJnZXQiaW4gZyYmdm9pZCAwIT09KGU9Zy5nZXQoYSwhMSxkKSk/ZTppW2JdOihmPXR5cGVvZiBjLCJzdHJpbmciPT09ZiYmKGU9YWEuZXhlYyhjKSkmJmVbMV0mJihjPWVhKGEsYixlKSxmPSJudW1iZXIiKSxudWxsIT1jJiZjPT09YyYmKCJudW1iZXIiPT09ZiYmKGMrPWUmJmVbM118fChyLmNzc051bWJlcltoXT8iIjoicHgiKSksby5jbGVhckNsb25lU3R5bGV8fCIiIT09Y3x8MCE9PWIuaW5kZXhPZigiYmFja2dyb3VuZCIpfHwoaVtiXT0iaW5oZXJpdCIpLGcmJiJzZXQiaW4gZyYmdm9pZCAwPT09KGM9Zy5zZXQoYSxjLGQpKXx8KGlbYl09YykpLHZvaWQgMCl9fSxjc3M6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGUsZixnLGg9ci5jYW1lbENhc2UoYik7cmV0dXJuIGI9ci5jc3NQcm9wc1toXXx8KHIuY3NzUHJvcHNbaF09VWEoaCl8fGgpLGc9ci5jc3NIb29rc1tiXXx8ci5jc3NIb29rc1toXSxnJiYiZ2V0ImluIGcmJihlPWcuZ2V0KGEsITAsYykpLHZvaWQgMD09PWUmJihlPU5hKGEsYixkKSksIm5vcm1hbCI9PT1lJiZiIGluIFJhJiYoZT1SYVtiXSksIiI9PT1jfHxjPyhmPXBhcnNlRmxvYXQoZSksYz09PSEwfHxpc0Zpbml0ZShmKT9mfHwwOmUpOmV9fSksci5lYWNoKFsiaGVpZ2h0Iiwid2lkdGgiXSxmdW5jdGlvbihhLGIpe3IuY3NzSG9va3NbYl09e2dldDpmdW5jdGlvbihhLGMsZCl7aWYoYylyZXR1cm4hUGEudGVzdChyLmNzcyhhLCJkaXNwbGF5IikpfHxhLmdldENsaWVudFJlY3RzKCkubGVuZ3RoJiZhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLndpZHRoP1hhKGEsYixkKTpkYShhLFFhLGZ1bmN0aW9uKCl7cmV0dXJuIFhhKGEsYixkKX0pfSxzZXQ6ZnVuY3Rpb24oYSxjLGQpe3ZhciBlLGY9ZCYmTWEoYSksZz1kJiZXYShhLGIsZCwiYm9yZGVyLWJveCI9PT1yLmNzcyhhLCJib3hTaXppbmciLCExLGYpLGYpO3JldHVybiBnJiYoZT1hYS5leGVjKGMpKSYmInB4IiE9PShlWzNdfHwicHgiKSYmKGEuc3R5bGVbYl09YyxjPXIuY3NzKGEsYikpLFZhKGEsYyxnKX19fSksci5jc3NIb29rcy5tYXJnaW5MZWZ0PU9hKG8ucmVsaWFibGVNYXJnaW5MZWZ0LGZ1bmN0aW9uKGEsYil7aWYoYilyZXR1cm4ocGFyc2VGbG9hdChOYShhLCJtYXJnaW5MZWZ0IikpfHxhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQtZGEoYSx7bWFyZ2luTGVmdDowfSxmdW5jdGlvbigpe3JldHVybiBhLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnR9KSkrInB4In0pLHIuZWFjaCh7bWFyZ2luOiIiLHBhZGRpbmc6IiIsYm9yZGVyOiJXaWR0aCJ9LGZ1bmN0aW9uKGEsYil7ci5jc3NIb29rc1thK2JdPXtleHBhbmQ6ZnVuY3Rpb24oYyl7Zm9yKHZhciBkPTAsZT17fSxmPSJzdHJpbmciPT10eXBlb2YgYz9jLnNwbGl0KCIgIik6W2NdO2Q8NDtkKyspZVthK2JhW2RdK2JdPWZbZF18fGZbZC0yXXx8ZlswXTtyZXR1cm4gZX19LEthLnRlc3QoYSl8fChyLmNzc0hvb2tzW2ErYl0uc2V0PVZhKX0pLHIuZm4uZXh0ZW5kKHtjc3M6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gUyh0aGlzLGZ1bmN0aW9uKGEsYixjKXt2YXIgZCxlLGY9e30sZz0wO2lmKHIuaXNBcnJheShiKSl7Zm9yKGQ9TWEoYSksZT1iLmxlbmd0aDtnPGU7ZysrKWZbYltnXV09ci5jc3MoYSxiW2ddLCExLGQpO3JldHVybiBmfXJldHVybiB2b2lkIDAhPT1jP3Iuc3R5bGUoYSxiLGMpOnIuY3NzKGEsYil9LGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfX0pO2Z1bmN0aW9uIFlhKGEsYixjLGQsZSl7cmV0dXJuIG5ldyBZYS5wcm90b3R5cGUuaW5pdChhLGIsYyxkLGUpfXIuVHdlZW49WWEsWWEucHJvdG90eXBlPXtjb25zdHJ1Y3RvcjpZYSxpbml0OmZ1bmN0aW9uKGEsYixjLGQsZSxmKXt0aGlzLmVsZW09YSx0aGlzLnByb3A9Yyx0aGlzLmVhc2luZz1lfHxyLmVhc2luZy5fZGVmYXVsdCx0aGlzLm9wdGlvbnM9Yix0aGlzLnN0YXJ0PXRoaXMubm93PXRoaXMuY3VyKCksdGhpcy5lbmQ9ZCx0aGlzLnVuaXQ9Znx8KHIuY3NzTnVtYmVyW2NdPyIiOiJweCIpfSxjdXI6ZnVuY3Rpb24oKXt2YXIgYT1ZYS5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gYSYmYS5nZXQ/YS5nZXQodGhpcyk6WWEucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKX0scnVuOmZ1bmN0aW9uKGEpe3ZhciBiLGM9WWEucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIHRoaXMub3B0aW9ucy5kdXJhdGlvbj90aGlzLnBvcz1iPXIuZWFzaW5nW3RoaXMuZWFzaW5nXShhLHRoaXMub3B0aW9ucy5kdXJhdGlvbiphLDAsMSx0aGlzLm9wdGlvbnMuZHVyYXRpb24pOnRoaXMucG9zPWI9YSx0aGlzLm5vdz0odGhpcy5lbmQtdGhpcy5zdGFydCkqYit0aGlzLnN0YXJ0LHRoaXMub3B0aW9ucy5zdGVwJiZ0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSx0aGlzLm5vdyx0aGlzKSxjJiZjLnNldD9jLnNldCh0aGlzKTpZYS5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KHRoaXMpLHRoaXN9fSxZYS5wcm90b3R5cGUuaW5pdC5wcm90b3R5cGU9WWEucHJvdG90eXBlLFlhLnByb3BIb29rcz17X2RlZmF1bHQ6e2dldDpmdW5jdGlvbihhKXt2YXIgYjtyZXR1cm4gMSE9PWEuZWxlbS5ub2RlVHlwZXx8bnVsbCE9YS5lbGVtW2EucHJvcF0mJm51bGw9PWEuZWxlbS5zdHlsZVthLnByb3BdP2EuZWxlbVthLnByb3BdOihiPXIuY3NzKGEuZWxlbSxhLnByb3AsIiIpLGImJiJhdXRvIiE9PWI/YjowKX0sc2V0OmZ1bmN0aW9uKGEpe3IuZnguc3RlcFthLnByb3BdP3IuZnguc3RlcFthLnByb3BdKGEpOjEhPT1hLmVsZW0ubm9kZVR5cGV8fG51bGw9PWEuZWxlbS5zdHlsZVtyLmNzc1Byb3BzW2EucHJvcF1dJiYhci5jc3NIb29rc1thLnByb3BdP2EuZWxlbVthLnByb3BdPWEubm93OnIuc3R5bGUoYS5lbGVtLGEucHJvcCxhLm5vdythLnVuaXQpfX19LFlhLnByb3BIb29rcy5zY3JvbGxUb3A9WWEucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihhKXthLmVsZW0ubm9kZVR5cGUmJmEuZWxlbS5wYXJlbnROb2RlJiYoYS5lbGVtW2EucHJvcF09YS5ub3cpfX0sci5lYXNpbmc9e2xpbmVhcjpmdW5jdGlvbihhKXtyZXR1cm4gYX0sc3dpbmc6ZnVuY3Rpb24oYSl7cmV0dXJuLjUtTWF0aC5jb3MoYSpNYXRoLlBJKS8yfSxfZGVmYXVsdDoic3dpbmcifSxyLmZ4PVlhLnByb3RvdHlwZS5pbml0LHIuZnguc3RlcD17fTt2YXIgWmEsJGEsX2E9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLGFiPS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gYmIoKXskYSYmKGEucmVxdWVzdEFuaW1hdGlvbkZyYW1lKGJiKSxyLmZ4LnRpY2soKSl9ZnVuY3Rpb24gY2IoKXtyZXR1cm4gYS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7WmE9dm9pZCAwfSksWmE9ci5ub3coKX1mdW5jdGlvbiBkYihhLGIpe3ZhciBjLGQ9MCxlPXtoZWlnaHQ6YX07Zm9yKGI9Yj8xOjA7ZDw0O2QrPTItYiljPWJhW2RdLGVbIm1hcmdpbiIrY109ZVsicGFkZGluZyIrY109YTtyZXR1cm4gYiYmKGUub3BhY2l0eT1lLndpZHRoPWEpLGV9ZnVuY3Rpb24gZWIoYSxiLGMpe2Zvcih2YXIgZCxlPShoYi50d2VlbmVyc1tiXXx8W10pLmNvbmNhdChoYi50d2VlbmVyc1siKiJdKSxmPTAsZz1lLmxlbmd0aDtmPGc7ZisrKWlmKGQ9ZVtmXS5jYWxsKGMsYixhKSlyZXR1cm4gZH1mdW5jdGlvbiBmYihhLGIsYyl7dmFyIGQsZSxmLGcsaCxpLGosayxsPSJ3aWR0aCJpbiBifHwiaGVpZ2h0ImluIGIsbT10aGlzLG49e30sbz1hLnN0eWxlLHA9YS5ub2RlVHlwZSYmY2EoYSkscT1WLmdldChhLCJmeHNob3ciKTtjLnF1ZXVlfHwoZz1yLl9xdWV1ZUhvb2tzKGEsImZ4IiksbnVsbD09Zy51bnF1ZXVlZCYmKGcudW5xdWV1ZWQ9MCxoPWcuZW1wdHkuZmlyZSxnLmVtcHR5LmZpcmU9ZnVuY3Rpb24oKXtnLnVucXVldWVkfHxoKCl9KSxnLnVucXVldWVkKyssbS5hbHdheXMoZnVuY3Rpb24oKXttLmFsd2F5cyhmdW5jdGlvbigpe2cudW5xdWV1ZWQtLSxyLnF1ZXVlKGEsImZ4IikubGVuZ3RofHxnLmVtcHR5LmZpcmUoKX0pfSkpO2ZvcihkIGluIGIpaWYoZT1iW2RdLF9hLnRlc3QoZSkpe2lmKGRlbGV0ZSBiW2RdLGY9Znx8InRvZ2dsZSI9PT1lLGU9PT0ocD8iaGlkZSI6InNob3ciKSl7aWYoInNob3ciIT09ZXx8IXF8fHZvaWQgMD09PXFbZF0pY29udGludWU7cD0hMH1uW2RdPXEmJnFbZF18fHIuc3R5bGUoYSxkKX1pZihpPSFyLmlzRW1wdHlPYmplY3QoYiksaXx8IXIuaXNFbXB0eU9iamVjdChuKSl7bCYmMT09PWEubm9kZVR5cGUmJihjLm92ZXJmbG93PVtvLm92ZXJmbG93LG8ub3ZlcmZsb3dYLG8ub3ZlcmZsb3dZXSxqPXEmJnEuZGlzcGxheSxudWxsPT1qJiYoaj1WLmdldChhLCJkaXNwbGF5IikpLGs9ci5jc3MoYSwiZGlzcGxheSIpLCJub25lIj09PWsmJihqP2s9ajooaGEoW2FdLCEwKSxqPWEuc3R5bGUuZGlzcGxheXx8aixrPXIuY3NzKGEsImRpc3BsYXkiKSxoYShbYV0pKSksKCJpbmxpbmUiPT09a3x8ImlubGluZS1ibG9jayI9PT1rJiZudWxsIT1qKSYmIm5vbmUiPT09ci5jc3MoYSwiZmxvYXQiKSYmKGl8fChtLmRvbmUoZnVuY3Rpb24oKXtvLmRpc3BsYXk9an0pLG51bGw9PWomJihrPW8uZGlzcGxheSxqPSJub25lIj09PWs/IiI6aykpLG8uZGlzcGxheT0iaW5saW5lLWJsb2NrIikpLGMub3ZlcmZsb3cmJihvLm92ZXJmbG93PSJoaWRkZW4iLG0uYWx3YXlzKGZ1bmN0aW9uKCl7by5vdmVyZmxvdz1jLm92ZXJmbG93WzBdLG8ub3ZlcmZsb3dYPWMub3ZlcmZsb3dbMV0sby5vdmVyZmxvd1k9Yy5vdmVyZmxvd1syXX0pKSxpPSExO2ZvcihkIGluIG4paXx8KHE/ImhpZGRlbiJpbiBxJiYocD1xLmhpZGRlbik6cT1WLmFjY2VzcyhhLCJmeHNob3ciLHtkaXNwbGF5Omp9KSxmJiYocS5oaWRkZW49IXApLHAmJmhhKFthXSwhMCksbS5kb25lKGZ1bmN0aW9uKCl7cHx8aGEoW2FdKSxWLnJlbW92ZShhLCJmeHNob3ciKTtmb3IoZCBpbiBuKXIuc3R5bGUoYSxkLG5bZF0pfSkpLGk9ZWIocD9xW2RdOjAsZCxtKSxkIGluIHF8fChxW2RdPWkuc3RhcnQscCYmKGkuZW5kPWkuc3RhcnQsaS5zdGFydD0wKSl9fWZ1bmN0aW9uIGdiKGEsYil7dmFyIGMsZCxlLGYsZztmb3IoYyBpbiBhKWlmKGQ9ci5jYW1lbENhc2UoYyksZT1iW2RdLGY9YVtjXSxyLmlzQXJyYXkoZikmJihlPWZbMV0sZj1hW2NdPWZbMF0pLGMhPT1kJiYoYVtkXT1mLGRlbGV0ZSBhW2NdKSxnPXIuY3NzSG9va3NbZF0sZyYmImV4cGFuZCJpbiBnKXtmPWcuZXhwYW5kKGYpLGRlbGV0ZSBhW2RdO2ZvcihjIGluIGYpYyBpbiBhfHwoYVtjXT1mW2NdLGJbY109ZSl9ZWxzZSBiW2RdPWV9ZnVuY3Rpb24gaGIoYSxiLGMpe3ZhciBkLGUsZj0wLGc9aGIucHJlZmlsdGVycy5sZW5ndGgsaD1yLkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIGkuZWxlbX0pLGk9ZnVuY3Rpb24oKXtpZihlKXJldHVybiExO2Zvcih2YXIgYj1aYXx8Y2IoKSxjPU1hdGgubWF4KDAsai5zdGFydFRpbWUrai5kdXJhdGlvbi1iKSxkPWMvai5kdXJhdGlvbnx8MCxmPTEtZCxnPTAsaT1qLnR3ZWVucy5sZW5ndGg7ZzxpO2crKylqLnR3ZWVuc1tnXS5ydW4oZik7cmV0dXJuIGgubm90aWZ5V2l0aChhLFtqLGYsY10pLGY8MSYmaT9jOihoLnJlc29sdmVXaXRoKGEsW2pdKSwhMSl9LGo9aC5wcm9taXNlKHtlbGVtOmEscHJvcHM6ci5leHRlbmQoe30sYiksb3B0czpyLmV4dGVuZCghMCx7c3BlY2lhbEVhc2luZzp7fSxlYXNpbmc6ci5lYXNpbmcuX2RlZmF1bHR9LGMpLG9yaWdpbmFsUHJvcGVydGllczpiLG9yaWdpbmFsT3B0aW9uczpjLHN0YXJ0VGltZTpaYXx8Y2IoKSxkdXJhdGlvbjpjLmR1cmF0aW9uLHR3ZWVuczpbXSxjcmVhdGVUd2VlbjpmdW5jdGlvbihiLGMpe3ZhciBkPXIuVHdlZW4oYSxqLm9wdHMsYixjLGoub3B0cy5zcGVjaWFsRWFzaW5nW2JdfHxqLm9wdHMuZWFzaW5nKTtyZXR1cm4gai50d2VlbnMucHVzaChkKSxkfSxzdG9wOmZ1bmN0aW9uKGIpe3ZhciBjPTAsZD1iP2oudHdlZW5zLmxlbmd0aDowO2lmKGUpcmV0dXJuIHRoaXM7Zm9yKGU9ITA7YzxkO2MrKylqLnR3ZWVuc1tjXS5ydW4oMSk7cmV0dXJuIGI/KGgubm90aWZ5V2l0aChhLFtqLDEsMF0pLGgucmVzb2x2ZVdpdGgoYSxbaixiXSkpOmgucmVqZWN0V2l0aChhLFtqLGJdKSx0aGlzfX0pLGs9ai5wcm9wcztmb3IoZ2IoayxqLm9wdHMuc3BlY2lhbEVhc2luZyk7ZjxnO2YrKylpZihkPWhiLnByZWZpbHRlcnNbZl0uY2FsbChqLGEsayxqLm9wdHMpKXJldHVybiByLmlzRnVuY3Rpb24oZC5zdG9wKSYmKHIuX3F1ZXVlSG9va3Moai5lbGVtLGoub3B0cy5xdWV1ZSkuc3RvcD1yLnByb3h5KGQuc3RvcCxkKSksZDtyZXR1cm4gci5tYXAoayxlYixqKSxyLmlzRnVuY3Rpb24oai5vcHRzLnN0YXJ0KSYmai5vcHRzLnN0YXJ0LmNhbGwoYSxqKSxyLmZ4LnRpbWVyKHIuZXh0ZW5kKGkse2VsZW06YSxhbmltOmoscXVldWU6ai5vcHRzLnF1ZXVlfSkpLGoucHJvZ3Jlc3Moai5vcHRzLnByb2dyZXNzKS5kb25lKGoub3B0cy5kb25lLGoub3B0cy5jb21wbGV0ZSkuZmFpbChqLm9wdHMuZmFpbCkuYWx3YXlzKGoub3B0cy5hbHdheXMpfXIuQW5pbWF0aW9uPXIuZXh0ZW5kKGhiLHt0d2VlbmVyczp7IioiOltmdW5jdGlvbihhLGIpe3ZhciBjPXRoaXMuY3JlYXRlVHdlZW4oYSxiKTtyZXR1cm4gZWEoYy5lbGVtLGEsYWEuZXhlYyhiKSxjKSxjfV19LHR3ZWVuZXI6ZnVuY3Rpb24oYSxiKXtyLmlzRnVuY3Rpb24oYSk/KGI9YSxhPVsiKiJdKTphPWEubWF0Y2goSyk7Zm9yKHZhciBjLGQ9MCxlPWEubGVuZ3RoO2Q8ZTtkKyspYz1hW2RdLGhiLnR3ZWVuZXJzW2NdPWhiLnR3ZWVuZXJzW2NdfHxbXSxoYi50d2VlbmVyc1tjXS51bnNoaWZ0KGIpfSxwcmVmaWx0ZXJzOltmYl0scHJlZmlsdGVyOmZ1bmN0aW9uKGEsYil7Yj9oYi5wcmVmaWx0ZXJzLnVuc2hpZnQoYSk6aGIucHJlZmlsdGVycy5wdXNoKGEpfX0pLHIuc3BlZWQ9ZnVuY3Rpb24oYSxiLGMpe3ZhciBlPWEmJiJvYmplY3QiPT10eXBlb2YgYT9yLmV4dGVuZCh7fSxhKTp7Y29tcGxldGU6Y3x8IWMmJmJ8fHIuaXNGdW5jdGlvbihhKSYmYSxkdXJhdGlvbjphLGVhc2luZzpjJiZifHxiJiYhci5pc0Z1bmN0aW9uKGIpJiZifTtyZXR1cm4gci5meC5vZmZ8fGQuaGlkZGVuP2UuZHVyYXRpb249MDoibnVtYmVyIiE9dHlwZW9mIGUuZHVyYXRpb24mJihlLmR1cmF0aW9uIGluIHIuZnguc3BlZWRzP2UuZHVyYXRpb249ci5meC5zcGVlZHNbZS5kdXJhdGlvbl06ZS5kdXJhdGlvbj1yLmZ4LnNwZWVkcy5fZGVmYXVsdCksbnVsbCE9ZS5xdWV1ZSYmZS5xdWV1ZSE9PSEwfHwoZS5xdWV1ZT0iZngiKSxlLm9sZD1lLmNvbXBsZXRlLGUuY29tcGxldGU9ZnVuY3Rpb24oKXtyLmlzRnVuY3Rpb24oZS5vbGQpJiZlLm9sZC5jYWxsKHRoaXMpLGUucXVldWUmJnIuZGVxdWV1ZSh0aGlzLGUucXVldWUpfSxlfSxyLmZuLmV4dGVuZCh7ZmFkZVRvOmZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmZpbHRlcihjYSkuY3NzKCJvcGFjaXR5IiwwKS5zaG93KCkuZW5kKCkuYW5pbWF0ZSh7b3BhY2l0eTpifSxhLGMsZCl9LGFuaW1hdGU6ZnVuY3Rpb24oYSxiLGMsZCl7dmFyIGU9ci5pc0VtcHR5T2JqZWN0KGEpLGY9ci5zcGVlZChiLGMsZCksZz1mdW5jdGlvbigpe3ZhciBiPWhiKHRoaXMsci5leHRlbmQoe30sYSksZik7KGV8fFYuZ2V0KHRoaXMsImZpbmlzaCIpKSYmYi5zdG9wKCEwKX07cmV0dXJuIGcuZmluaXNoPWcsZXx8Zi5xdWV1ZT09PSExP3RoaXMuZWFjaChnKTp0aGlzLnF1ZXVlKGYucXVldWUsZyl9LHN0b3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkPWZ1bmN0aW9uKGEpe3ZhciBiPWEuc3RvcDtkZWxldGUgYS5zdG9wLGIoYyl9O3JldHVybiJzdHJpbmciIT10eXBlb2YgYSYmKGM9YixiPWEsYT12b2lkIDApLGImJmEhPT0hMSYmdGhpcy5xdWV1ZShhfHwiZngiLFtdKSx0aGlzLmVhY2goZnVuY3Rpb24oKXt2YXIgYj0hMCxlPW51bGwhPWEmJmErInF1ZXVlSG9va3MiLGY9ci50aW1lcnMsZz1WLmdldCh0aGlzKTtpZihlKWdbZV0mJmdbZV0uc3RvcCYmZChnW2VdKTtlbHNlIGZvcihlIGluIGcpZ1tlXSYmZ1tlXS5zdG9wJiZhYi50ZXN0KGUpJiZkKGdbZV0pO2ZvcihlPWYubGVuZ3RoO2UtLTspZltlXS5lbGVtIT09dGhpc3x8bnVsbCE9YSYmZltlXS5xdWV1ZSE9PWF8fChmW2VdLmFuaW0uc3RvcChjKSxiPSExLGYuc3BsaWNlKGUsMSkpOyFiJiZjfHxyLmRlcXVldWUodGhpcyxhKX0pfSxmaW5pc2g6ZnVuY3Rpb24oYSl7cmV0dXJuIGEhPT0hMSYmKGE9YXx8ImZ4IiksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGIsYz1WLmdldCh0aGlzKSxkPWNbYSsicXVldWUiXSxlPWNbYSsicXVldWVIb29rcyJdLGY9ci50aW1lcnMsZz1kP2QubGVuZ3RoOjA7Zm9yKGMuZmluaXNoPSEwLHIucXVldWUodGhpcyxhLFtdKSxlJiZlLnN0b3AmJmUuc3RvcC5jYWxsKHRoaXMsITApLGI9Zi5sZW5ndGg7Yi0tOylmW2JdLmVsZW09PT10aGlzJiZmW2JdLnF1ZXVlPT09YSYmKGZbYl0uYW5pbS5zdG9wKCEwKSxmLnNwbGljZShiLDEpKTtmb3IoYj0wO2I8ZztiKyspZFtiXSYmZFtiXS5maW5pc2gmJmRbYl0uZmluaXNoLmNhbGwodGhpcyk7ZGVsZXRlIGMuZmluaXNofSl9fSksci5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihhLGIpe3ZhciBjPXIuZm5bYl07ci5mbltiXT1mdW5jdGlvbihhLGQsZSl7cmV0dXJuIG51bGw9PWF8fCJib29sZWFuIj09dHlwZW9mIGE/Yy5hcHBseSh0aGlzLGFyZ3VtZW50cyk6dGhpcy5hbmltYXRlKGRiKGIsITApLGEsZCxlKX19KSxyLmVhY2goe3NsaWRlRG93bjpkYigic2hvdyIpLHNsaWRlVXA6ZGIoImhpZGUiKSxzbGlkZVRvZ2dsZTpkYigidG9nZ2xlIiksZmFkZUluOntvcGFjaXR5OiJzaG93In0sZmFkZU91dDp7b3BhY2l0eToiaGlkZSJ9LGZhZGVUb2dnbGU6e29wYWNpdHk6InRvZ2dsZSJ9fSxmdW5jdGlvbihhLGIpe3IuZm5bYV09ZnVuY3Rpb24oYSxjLGQpe3JldHVybiB0aGlzLmFuaW1hdGUoYixhLGMsZCl9fSksci50aW1lcnM9W10sci5meC50aWNrPWZ1bmN0aW9uKCl7dmFyIGEsYj0wLGM9ci50aW1lcnM7Zm9yKFphPXIubm93KCk7YjxjLmxlbmd0aDtiKyspYT1jW2JdLGEoKXx8Y1tiXSE9PWF8fGMuc3BsaWNlKGItLSwxKTtjLmxlbmd0aHx8ci5meC5zdG9wKCksWmE9dm9pZCAwfSxyLmZ4LnRpbWVyPWZ1bmN0aW9uKGEpe3IudGltZXJzLnB1c2goYSksYSgpP3IuZnguc3RhcnQoKTpyLnRpbWVycy5wb3AoKX0sci5meC5pbnRlcnZhbD0xMyxyLmZ4LnN0YXJ0PWZ1bmN0aW9uKCl7JGF8fCgkYT1hLnJlcXVlc3RBbmltYXRpb25GcmFtZT9hLnJlcXVlc3RBbmltYXRpb25GcmFtZShiYik6YS5zZXRJbnRlcnZhbChyLmZ4LnRpY2ssci5meC5pbnRlcnZhbCkpfSxyLmZ4LnN0b3A9ZnVuY3Rpb24oKXthLmNhbmNlbEFuaW1hdGlvbkZyYW1lP2EuY2FuY2VsQW5pbWF0aW9uRnJhbWUoJGEpOmEuY2xlYXJJbnRlcnZhbCgkYSksJGE9bnVsbH0sci5meC5zcGVlZHM9e3Nsb3c6NjAwLGZhc3Q6MjAwLF9kZWZhdWx0OjQwMH0sci5mbi5kZWxheT1mdW5jdGlvbihiLGMpe3JldHVybiBiPXIuZng/ci5meC5zcGVlZHNbYl18fGI6YixjPWN8fCJmeCIsdGhpcy5xdWV1ZShjLGZ1bmN0aW9uKGMsZCl7dmFyIGU9YS5zZXRUaW1lb3V0KGMsYik7ZC5zdG9wPWZ1bmN0aW9uKCl7YS5jbGVhclRpbWVvdXQoZSl9fSl9LGZ1bmN0aW9uKCl7dmFyIGE9ZC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLGI9ZC5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKSxjPWIuYXBwZW5kQ2hpbGQoZC5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSk7YS50eXBlPSJjaGVja2JveCIsby5jaGVja09uPSIiIT09YS52YWx1ZSxvLm9wdFNlbGVjdGVkPWMuc2VsZWN0ZWQsYT1kLmNyZWF0ZUVsZW1lbnQoImlucHV0IiksYS52YWx1ZT0idCIsYS50eXBlPSJyYWRpbyIsby5yYWRpb1ZhbHVlPSJ0Ij09PWEudmFsdWV9KCk7dmFyIGliLGpiPXIuZXhwci5hdHRySGFuZGxlO3IuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIFModGhpcyxyLmF0dHIsYSxiLGFyZ3VtZW50cy5sZW5ndGg+MSl9LHJlbW92ZUF0dHI6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3IucmVtb3ZlQXR0cih0aGlzLGEpfSl9fSksci5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1hLm5vZGVUeXBlO2lmKDMhPT1mJiY4IT09ZiYmMiE9PWYpcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBhLmdldEF0dHJpYnV0ZT9yLnByb3AoYSxiLGMpOigxPT09ZiYmci5pc1hNTERvYyhhKXx8KGU9ci5hdHRySG9va3NbYi50b0xvd2VyQ2FzZSgpXXx8KHIuZXhwci5tYXRjaC5ib29sLnRlc3QoYik/aWI6dm9pZCAwKSksCnZvaWQgMCE9PWM/bnVsbD09PWM/dm9pZCByLnJlbW92ZUF0dHIoYSxiKTplJiYic2V0ImluIGUmJnZvaWQgMCE9PShkPWUuc2V0KGEsYyxiKSk/ZDooYS5zZXRBdHRyaWJ1dGUoYixjKyIiKSxjKTplJiYiZ2V0ImluIGUmJm51bGwhPT0oZD1lLmdldChhLGIpKT9kOihkPXIuZmluZC5hdHRyKGEsYiksbnVsbD09ZD92b2lkIDA6ZCkpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihhLGIpe2lmKCFvLnJhZGlvVmFsdWUmJiJyYWRpbyI9PT1iJiZyLm5vZGVOYW1lKGEsImlucHV0Iikpe3ZhciBjPWEudmFsdWU7cmV0dXJuIGEuc2V0QXR0cmlidXRlKCJ0eXBlIixiKSxjJiYoYS52YWx1ZT1jKSxifX19fSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGEsYil7dmFyIGMsZD0wLGU9YiYmYi5tYXRjaChLKTtpZihlJiYxPT09YS5ub2RlVHlwZSl3aGlsZShjPWVbZCsrXSlhLnJlbW92ZUF0dHJpYnV0ZShjKX19KSxpYj17c2V0OmZ1bmN0aW9uKGEsYixjKXtyZXR1cm4gYj09PSExP3IucmVtb3ZlQXR0cihhLGMpOmEuc2V0QXR0cmlidXRlKGMsYyksY319LHIuZWFjaChyLmV4cHIubWF0Y2guYm9vbC5zb3VyY2UubWF0Y2goL1x3Ky9nKSxmdW5jdGlvbihhLGIpe3ZhciBjPWpiW2JdfHxyLmZpbmQuYXR0cjtqYltiXT1mdW5jdGlvbihhLGIsZCl7dmFyIGUsZixnPWIudG9Mb3dlckNhc2UoKTtyZXR1cm4gZHx8KGY9amJbZ10samJbZ109ZSxlPW51bGwhPWMoYSxiLGQpP2c6bnVsbCxqYltnXT1mKSxlfX0pO3ZhciBrYj0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLGxiPS9eKD86YXxhcmVhKSQvaTtyLmZuLmV4dGVuZCh7cHJvcDpmdW5jdGlvbihhLGIpe3JldHVybiBTKHRoaXMsci5wcm9wLGEsYixhcmd1bWVudHMubGVuZ3RoPjEpfSxyZW1vdmVQcm9wOmZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtkZWxldGUgdGhpc1tyLnByb3BGaXhbYV18fGFdfSl9fSksci5leHRlbmQoe3Byb3A6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZj1hLm5vZGVUeXBlO2lmKDMhPT1mJiY4IT09ZiYmMiE9PWYpcmV0dXJuIDE9PT1mJiZyLmlzWE1MRG9jKGEpfHwoYj1yLnByb3BGaXhbYl18fGIsZT1yLnByb3BIb29rc1tiXSksdm9pZCAwIT09Yz9lJiYic2V0ImluIGUmJnZvaWQgMCE9PShkPWUuc2V0KGEsYyxiKSk/ZDphW2JdPWM6ZSYmImdldCJpbiBlJiZudWxsIT09KGQ9ZS5nZXQoYSxiKSk/ZDphW2JdfSxwcm9wSG9va3M6e3RhYkluZGV4OntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9ci5maW5kLmF0dHIoYSwidGFiaW5kZXgiKTtyZXR1cm4gYj9wYXJzZUludChiLDEwKTprYi50ZXN0KGEubm9kZU5hbWUpfHxsYi50ZXN0KGEubm9kZU5hbWUpJiZhLmhyZWY/MDotMX19fSxwcm9wRml4OnsiZm9yIjoiaHRtbEZvciIsImNsYXNzIjoiY2xhc3NOYW1lIn19KSxvLm9wdFNlbGVjdGVkfHwoci5wcm9wSG9va3Muc2VsZWN0ZWQ9e2dldDpmdW5jdGlvbihhKXt2YXIgYj1hLnBhcmVudE5vZGU7cmV0dXJuIGImJmIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsbnVsbH0sc2V0OmZ1bmN0aW9uKGEpe3ZhciBiPWEucGFyZW50Tm9kZTtiJiYoYi5zZWxlY3RlZEluZGV4LGIucGFyZW50Tm9kZSYmYi5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgpfX0pLHIuZWFjaChbInRhYkluZGV4IiwicmVhZE9ubHkiLCJtYXhMZW5ndGgiLCJjZWxsU3BhY2luZyIsImNlbGxQYWRkaW5nIiwicm93U3BhbiIsImNvbFNwYW4iLCJ1c2VNYXAiLCJmcmFtZUJvcmRlciIsImNvbnRlbnRFZGl0YWJsZSJdLGZ1bmN0aW9uKCl7ci5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV09dGhpc30pO2Z1bmN0aW9uIG1iKGEpe3ZhciBiPWEubWF0Y2goSyl8fFtdO3JldHVybiBiLmpvaW4oIiAiKX1mdW5jdGlvbiBuYihhKXtyZXR1cm4gYS5nZXRBdHRyaWJ1dGUmJmEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpfHwiIn1yLmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24oYSl7dmFyIGIsYyxkLGUsZixnLGgsaT0wO2lmKHIuaXNGdW5jdGlvbihhKSlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKGIpe3IodGhpcykuYWRkQ2xhc3MoYS5jYWxsKHRoaXMsYixuYih0aGlzKSkpfSk7aWYoInN0cmluZyI9PXR5cGVvZiBhJiZhKXtiPWEubWF0Y2goSyl8fFtdO3doaWxlKGM9dGhpc1tpKytdKWlmKGU9bmIoYyksZD0xPT09Yy5ub2RlVHlwZSYmIiAiK21iKGUpKyIgIil7Zz0wO3doaWxlKGY9YltnKytdKWQuaW5kZXhPZigiICIrZisiICIpPDAmJihkKz1mKyIgIik7aD1tYihkKSxlIT09aCYmYy5zZXRBdHRyaWJ1dGUoImNsYXNzIixoKX19cmV0dXJuIHRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlLGYsZyxoLGk9MDtpZihyLmlzRnVuY3Rpb24oYSkpcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihiKXtyKHRoaXMpLnJlbW92ZUNsYXNzKGEuY2FsbCh0aGlzLGIsbmIodGhpcykpKX0pO2lmKCFhcmd1bWVudHMubGVuZ3RoKXJldHVybiB0aGlzLmF0dHIoImNsYXNzIiwiIik7aWYoInN0cmluZyI9PXR5cGVvZiBhJiZhKXtiPWEubWF0Y2goSyl8fFtdO3doaWxlKGM9dGhpc1tpKytdKWlmKGU9bmIoYyksZD0xPT09Yy5ub2RlVHlwZSYmIiAiK21iKGUpKyIgIil7Zz0wO3doaWxlKGY9YltnKytdKXdoaWxlKGQuaW5kZXhPZigiICIrZisiICIpPi0xKWQ9ZC5yZXBsYWNlKCIgIitmKyIgIiwiICIpO2g9bWIoZCksZSE9PWgmJmMuc2V0QXR0cmlidXRlKCJjbGFzcyIsaCl9fXJldHVybiB0aGlzfSx0b2dnbGVDbGFzczpmdW5jdGlvbihhLGIpe3ZhciBjPXR5cGVvZiBhO3JldHVybiJib29sZWFuIj09dHlwZW9mIGImJiJzdHJpbmciPT09Yz9iP3RoaXMuYWRkQ2xhc3MoYSk6dGhpcy5yZW1vdmVDbGFzcyhhKTpyLmlzRnVuY3Rpb24oYSk/dGhpcy5lYWNoKGZ1bmN0aW9uKGMpe3IodGhpcykudG9nZ2xlQ2xhc3MoYS5jYWxsKHRoaXMsYyxuYih0aGlzKSxiKSxiKX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBiLGQsZSxmO2lmKCJzdHJpbmciPT09Yyl7ZD0wLGU9cih0aGlzKSxmPWEubWF0Y2goSyl8fFtdO3doaWxlKGI9ZltkKytdKWUuaGFzQ2xhc3MoYik/ZS5yZW1vdmVDbGFzcyhiKTplLmFkZENsYXNzKGIpfWVsc2Ugdm9pZCAwIT09YSYmImJvb2xlYW4iIT09Y3x8KGI9bmIodGhpcyksYiYmVi5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsYiksdGhpcy5zZXRBdHRyaWJ1dGUmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsYnx8YT09PSExPyIiOlYuZ2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiIpKX0pfSxoYXNDbGFzczpmdW5jdGlvbihhKXt2YXIgYixjLGQ9MDtiPSIgIithKyIgIjt3aGlsZShjPXRoaXNbZCsrXSlpZigxPT09Yy5ub2RlVHlwZSYmKCIgIittYihuYihjKSkrIiAiKS5pbmRleE9mKGIpPi0xKXJldHVybiEwO3JldHVybiExfX0pO3ZhciBvYj0vXHIvZztyLmZuLmV4dGVuZCh7dmFsOmZ1bmN0aW9uKGEpe3ZhciBiLGMsZCxlPXRoaXNbMF07e2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIGQ9ci5pc0Z1bmN0aW9uKGEpLHRoaXMuZWFjaChmdW5jdGlvbihjKXt2YXIgZTsxPT09dGhpcy5ub2RlVHlwZSYmKGU9ZD9hLmNhbGwodGhpcyxjLHIodGhpcykudmFsKCkpOmEsbnVsbD09ZT9lPSIiOiJudW1iZXIiPT10eXBlb2YgZT9lKz0iIjpyLmlzQXJyYXkoZSkmJihlPXIubWFwKGUsZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWE/IiI6YSsiIn0pKSxiPXIudmFsSG9va3NbdGhpcy50eXBlXXx8ci52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJiJzZXQiaW4gYiYmdm9pZCAwIT09Yi5zZXQodGhpcyxlLCJ2YWx1ZSIpfHwodGhpcy52YWx1ZT1lKSl9KTtpZihlKXJldHVybiBiPXIudmFsSG9va3NbZS50eXBlXXx8ci52YWxIb29rc1tlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldLGImJiJnZXQiaW4gYiYmdm9pZCAwIT09KGM9Yi5nZXQoZSwidmFsdWUiKSk/YzooYz1lLnZhbHVlLCJzdHJpbmciPT10eXBlb2YgYz9jLnJlcGxhY2Uob2IsIiIpOm51bGw9PWM/IiI6Yyl9fX0pLHIuZXh0ZW5kKHt2YWxIb29rczp7b3B0aW9uOntnZXQ6ZnVuY3Rpb24oYSl7dmFyIGI9ci5maW5kLmF0dHIoYSwidmFsdWUiKTtyZXR1cm4gbnVsbCE9Yj9iOm1iKHIudGV4dChhKSl9fSxzZWxlY3Q6e2dldDpmdW5jdGlvbihhKXt2YXIgYixjLGQsZT1hLm9wdGlvbnMsZj1hLnNlbGVjdGVkSW5kZXgsZz0ic2VsZWN0LW9uZSI9PT1hLnR5cGUsaD1nP251bGw6W10saT1nP2YrMTplLmxlbmd0aDtmb3IoZD1mPDA/aTpnP2Y6MDtkPGk7ZCsrKWlmKGM9ZVtkXSwoYy5zZWxlY3RlZHx8ZD09PWYpJiYhYy5kaXNhYmxlZCYmKCFjLnBhcmVudE5vZGUuZGlzYWJsZWR8fCFyLm5vZGVOYW1lKGMucGFyZW50Tm9kZSwib3B0Z3JvdXAiKSkpe2lmKGI9cihjKS52YWwoKSxnKXJldHVybiBiO2gucHVzaChiKX1yZXR1cm4gaH0sc2V0OmZ1bmN0aW9uKGEsYil7dmFyIGMsZCxlPWEub3B0aW9ucyxmPXIubWFrZUFycmF5KGIpLGc9ZS5sZW5ndGg7d2hpbGUoZy0tKWQ9ZVtnXSwoZC5zZWxlY3RlZD1yLmluQXJyYXkoci52YWxIb29rcy5vcHRpb24uZ2V0KGQpLGYpPi0xKSYmKGM9ITApO3JldHVybiBjfHwoYS5zZWxlY3RlZEluZGV4PS0xKSxmfX19fSksci5lYWNoKFsicmFkaW8iLCJjaGVja2JveCJdLGZ1bmN0aW9uKCl7ci52YWxIb29rc1t0aGlzXT17c2V0OmZ1bmN0aW9uKGEsYil7aWYoci5pc0FycmF5KGIpKXJldHVybiBhLmNoZWNrZWQ9ci5pbkFycmF5KHIoYSkudmFsKCksYik+LTF9fSxvLmNoZWNrT258fChyLnZhbEhvb2tzW3RoaXNdLmdldD1mdW5jdGlvbihhKXtyZXR1cm4gbnVsbD09PWEuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpPyJvbiI6YS52YWx1ZX0pfSk7dmFyIHBiPS9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLztyLmV4dGVuZChyLmV2ZW50LHt0cmlnZ2VyOmZ1bmN0aW9uKGIsYyxlLGYpe3ZhciBnLGgsaSxqLGssbSxuLG89W2V8fGRdLHA9bC5jYWxsKGIsInR5cGUiKT9iLnR5cGU6YixxPWwuY2FsbChiLCJuYW1lc3BhY2UiKT9iLm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKGg9aT1lPWV8fGQsMyE9PWUubm9kZVR5cGUmJjghPT1lLm5vZGVUeXBlJiYhcGIudGVzdChwK3IuZXZlbnQudHJpZ2dlcmVkKSYmKHAuaW5kZXhPZigiLiIpPi0xJiYocT1wLnNwbGl0KCIuIikscD1xLnNoaWZ0KCkscS5zb3J0KCkpLGs9cC5pbmRleE9mKCI6Iik8MCYmIm9uIitwLGI9YltyLmV4cGFuZG9dP2I6bmV3IHIuRXZlbnQocCwib2JqZWN0Ij09dHlwZW9mIGImJmIpLGIuaXNUcmlnZ2VyPWY/MjozLGIubmFtZXNwYWNlPXEuam9pbigiLiIpLGIucm5hbWVzcGFjZT1iLm5hbWVzcGFjZT9uZXcgUmVnRXhwKCIoXnxcXC4pIitxLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpOm51bGwsYi5yZXN1bHQ9dm9pZCAwLGIudGFyZ2V0fHwoYi50YXJnZXQ9ZSksYz1udWxsPT1jP1tiXTpyLm1ha2VBcnJheShjLFtiXSksbj1yLmV2ZW50LnNwZWNpYWxbcF18fHt9LGZ8fCFuLnRyaWdnZXJ8fG4udHJpZ2dlci5hcHBseShlLGMpIT09ITEpKXtpZighZiYmIW4ubm9CdWJibGUmJiFyLmlzV2luZG93KGUpKXtmb3Ioaj1uLmRlbGVnYXRlVHlwZXx8cCxwYi50ZXN0KGorcCl8fChoPWgucGFyZW50Tm9kZSk7aDtoPWgucGFyZW50Tm9kZSlvLnB1c2goaCksaT1oO2k9PT0oZS5vd25lckRvY3VtZW50fHxkKSYmby5wdXNoKGkuZGVmYXVsdFZpZXd8fGkucGFyZW50V2luZG93fHxhKX1nPTA7d2hpbGUoKGg9b1tnKytdKSYmIWIuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSliLnR5cGU9Zz4xP2o6bi5iaW5kVHlwZXx8cCxtPShWLmdldChoLCJldmVudHMiKXx8e30pW2IudHlwZV0mJlYuZ2V0KGgsImhhbmRsZSIpLG0mJm0uYXBwbHkoaCxjKSxtPWsmJmhba10sbSYmbS5hcHBseSYmVChoKSYmKGIucmVzdWx0PW0uYXBwbHkoaCxjKSxiLnJlc3VsdD09PSExJiZiLnByZXZlbnREZWZhdWx0KCkpO3JldHVybiBiLnR5cGU9cCxmfHxiLmlzRGVmYXVsdFByZXZlbnRlZCgpfHxuLl9kZWZhdWx0JiZuLl9kZWZhdWx0LmFwcGx5KG8ucG9wKCksYykhPT0hMXx8IVQoZSl8fGsmJnIuaXNGdW5jdGlvbihlW3BdKSYmIXIuaXNXaW5kb3coZSkmJihpPWVba10saSYmKGVba109bnVsbCksci5ldmVudC50cmlnZ2VyZWQ9cCxlW3BdKCksci5ldmVudC50cmlnZ2VyZWQ9dm9pZCAwLGkmJihlW2tdPWkpKSxiLnJlc3VsdH19LHNpbXVsYXRlOmZ1bmN0aW9uKGEsYixjKXt2YXIgZD1yLmV4dGVuZChuZXcgci5FdmVudCxjLHt0eXBlOmEsaXNTaW11bGF0ZWQ6ITB9KTtyLmV2ZW50LnRyaWdnZXIoZCxudWxsLGIpfX0pLHIuZm4uZXh0ZW5kKHt0cmlnZ2VyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe3IuZXZlbnQudHJpZ2dlcihhLGIsdGhpcyl9KX0sdHJpZ2dlckhhbmRsZXI6ZnVuY3Rpb24oYSxiKXt2YXIgYz10aGlzWzBdO2lmKGMpcmV0dXJuIHIuZXZlbnQudHJpZ2dlcihhLGIsYywhMCl9fSksci5lYWNoKCJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgcmVzaXplIHNjcm9sbCBjbGljayBkYmxjbGljayBtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSBjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGNvbnRleHRtZW51Ii5zcGxpdCgiICIpLGZ1bmN0aW9uKGEsYil7ci5mbltiXT1mdW5jdGlvbihhLGMpe3JldHVybiBhcmd1bWVudHMubGVuZ3RoPjA/dGhpcy5vbihiLG51bGwsYSxjKTp0aGlzLnRyaWdnZXIoYil9fSksci5mbi5leHRlbmQoe2hvdmVyOmZ1bmN0aW9uKGEsYil7cmV0dXJuIHRoaXMubW91c2VlbnRlcihhKS5tb3VzZWxlYXZlKGJ8fGEpfX0pLG8uZm9jdXNpbj0ib25mb2N1c2luImluIGEsby5mb2N1c2lufHxyLmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKGEsYil7dmFyIGM9ZnVuY3Rpb24oYSl7ci5ldmVudC5zaW11bGF0ZShiLGEudGFyZ2V0LHIuZXZlbnQuZml4KGEpKX07ci5ldmVudC5zcGVjaWFsW2JdPXtzZXR1cDpmdW5jdGlvbigpe3ZhciBkPXRoaXMub3duZXJEb2N1bWVudHx8dGhpcyxlPVYuYWNjZXNzKGQsYik7ZXx8ZC5hZGRFdmVudExpc3RlbmVyKGEsYywhMCksVi5hY2Nlc3MoZCxiLChlfHwwKSsxKX0sdGVhcmRvd246ZnVuY3Rpb24oKXt2YXIgZD10aGlzLm93bmVyRG9jdW1lbnR8fHRoaXMsZT1WLmFjY2VzcyhkLGIpLTE7ZT9WLmFjY2VzcyhkLGIsZSk6KGQucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGMsITApLFYucmVtb3ZlKGQsYikpfX19KTt2YXIgcWI9YS5sb2NhdGlvbixyYj1yLm5vdygpLHNiPS9cPy87ci5wYXJzZVhNTD1mdW5jdGlvbihiKXt2YXIgYztpZighYnx8InN0cmluZyIhPXR5cGVvZiBiKXJldHVybiBudWxsO3RyeXtjPShuZXcgYS5ET01QYXJzZXIpLnBhcnNlRnJvbVN0cmluZyhiLCJ0ZXh0L3htbCIpfWNhdGNoKGQpe2M9dm9pZCAwfXJldHVybiBjJiYhYy5nZXRFbGVtZW50c0J5VGFnTmFtZSgicGFyc2VyZXJyb3IiKS5sZW5ndGh8fHIuZXJyb3IoIkludmFsaWQgWE1MOiAiK2IpLGN9O3ZhciB0Yj0vXFtcXSQvLHViPS9ccj9cbi9nLHZiPS9eKD86c3VibWl0fGJ1dHRvbnxpbWFnZXxyZXNldHxmaWxlKSQvaSx3Yj0vXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7ZnVuY3Rpb24geGIoYSxiLGMsZCl7dmFyIGU7aWYoci5pc0FycmF5KGIpKXIuZWFjaChiLGZ1bmN0aW9uKGIsZSl7Y3x8dGIudGVzdChhKT9kKGEsZSk6eGIoYSsiWyIrKCJvYmplY3QiPT10eXBlb2YgZSYmbnVsbCE9ZT9iOiIiKSsiXSIsZSxjLGQpfSk7ZWxzZSBpZihjfHwib2JqZWN0IiE9PXIudHlwZShiKSlkKGEsYik7ZWxzZSBmb3IoZSBpbiBiKXhiKGErIlsiK2UrIl0iLGJbZV0sYyxkKX1yLnBhcmFtPWZ1bmN0aW9uKGEsYil7dmFyIGMsZD1bXSxlPWZ1bmN0aW9uKGEsYil7dmFyIGM9ci5pc0Z1bmN0aW9uKGIpP2IoKTpiO2RbZC5sZW5ndGhdPWVuY29kZVVSSUNvbXBvbmVudChhKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KG51bGw9PWM/IiI6Yyl9O2lmKHIuaXNBcnJheShhKXx8YS5qcXVlcnkmJiFyLmlzUGxhaW5PYmplY3QoYSkpci5lYWNoKGEsZnVuY3Rpb24oKXtlKHRoaXMubmFtZSx0aGlzLnZhbHVlKX0pO2Vsc2UgZm9yKGMgaW4gYSl4YihjLGFbY10sYixlKTtyZXR1cm4gZC5qb2luKCImIil9LHIuZm4uZXh0ZW5kKHtzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gci5wYXJhbSh0aGlzLnNlcmlhbGl6ZUFycmF5KCkpfSxzZXJpYWxpemVBcnJheTpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBhPXIucHJvcCh0aGlzLCJlbGVtZW50cyIpO3JldHVybiBhP3IubWFrZUFycmF5KGEpOnRoaXN9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgYT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIXIodGhpcykuaXMoIjpkaXNhYmxlZCIpJiZ3Yi50ZXN0KHRoaXMubm9kZU5hbWUpJiYhdmIudGVzdChhKSYmKHRoaXMuY2hlY2tlZHx8IWlhLnRlc3QoYSkpfSkubWFwKGZ1bmN0aW9uKGEsYil7dmFyIGM9cih0aGlzKS52YWwoKTtyZXR1cm4gbnVsbD09Yz9udWxsOnIuaXNBcnJheShjKT9yLm1hcChjLGZ1bmN0aW9uKGEpe3JldHVybntuYW1lOmIubmFtZSx2YWx1ZTphLnJlcGxhY2UodWIsIlxyXG4iKX19KTp7bmFtZTpiLm5hbWUsdmFsdWU6Yy5yZXBsYWNlKHViLCJcclxuIil9fSkuZ2V0KCl9fSk7dmFyIHliPS8lMjAvZyx6Yj0vIy4qJC8sQWI9LyhbPyZdKV89W14mXSovLEJiPS9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKSQvZ20sQ2I9L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sRGI9L14oPzpHRVR8SEVBRCkkLyxFYj0vXlwvXC8vLEZiPXt9LEdiPXt9LEhiPSIqLyIuY29uY2F0KCIqIiksSWI9ZC5jcmVhdGVFbGVtZW50KCJhIik7SWIuaHJlZj1xYi5ocmVmO2Z1bmN0aW9uIEpiKGEpe3JldHVybiBmdW5jdGlvbihiLGMpeyJzdHJpbmciIT10eXBlb2YgYiYmKGM9YixiPSIqIik7dmFyIGQsZT0wLGY9Yi50b0xvd2VyQ2FzZSgpLm1hdGNoKEspfHxbXTtpZihyLmlzRnVuY3Rpb24oYykpd2hpbGUoZD1mW2UrK10pIisiPT09ZFswXT8oZD1kLnNsaWNlKDEpfHwiKiIsKGFbZF09YVtkXXx8W10pLnVuc2hpZnQoYykpOihhW2RdPWFbZF18fFtdKS5wdXNoKGMpfX1mdW5jdGlvbiBLYihhLGIsYyxkKXt2YXIgZT17fSxmPWE9PT1HYjtmdW5jdGlvbiBnKGgpe3ZhciBpO3JldHVybiBlW2hdPSEwLHIuZWFjaChhW2hdfHxbXSxmdW5jdGlvbihhLGgpe3ZhciBqPWgoYixjLGQpO3JldHVybiJzdHJpbmciIT10eXBlb2Yganx8Znx8ZVtqXT9mPyEoaT1qKTp2b2lkIDA6KGIuZGF0YVR5cGVzLnVuc2hpZnQoaiksZyhqKSwhMSl9KSxpfXJldHVybiBnKGIuZGF0YVR5cGVzWzBdKXx8IWVbIioiXSYmZygiKiIpfWZ1bmN0aW9uIExiKGEsYil7dmFyIGMsZCxlPXIuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IoYyBpbiBiKXZvaWQgMCE9PWJbY10mJigoZVtjXT9hOmR8fChkPXt9KSlbY109YltjXSk7cmV0dXJuIGQmJnIuZXh0ZW5kKCEwLGEsZCksYX1mdW5jdGlvbiBNYihhLGIsYyl7dmFyIGQsZSxmLGcsaD1hLmNvbnRlbnRzLGk9YS5kYXRhVHlwZXM7d2hpbGUoIioiPT09aVswXSlpLnNoaWZ0KCksdm9pZCAwPT09ZCYmKGQ9YS5taW1lVHlwZXx8Yi5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1UeXBlIikpO2lmKGQpZm9yKGUgaW4gaClpZihoW2VdJiZoW2VdLnRlc3QoZCkpe2kudW5zaGlmdChlKTticmVha31pZihpWzBdaW4gYylmPWlbMF07ZWxzZXtmb3IoZSBpbiBjKXtpZighaVswXXx8YS5jb252ZXJ0ZXJzW2UrIiAiK2lbMF1dKXtmPWU7YnJlYWt9Z3x8KGc9ZSl9Zj1mfHxnfWlmKGYpcmV0dXJuIGYhPT1pWzBdJiZpLnVuc2hpZnQoZiksY1tmXX1mdW5jdGlvbiBOYihhLGIsYyxkKXt2YXIgZSxmLGcsaCxpLGo9e30saz1hLmRhdGFUeXBlcy5zbGljZSgpO2lmKGtbMV0pZm9yKGcgaW4gYS5jb252ZXJ0ZXJzKWpbZy50b0xvd2VyQ2FzZSgpXT1hLmNvbnZlcnRlcnNbZ107Zj1rLnNoaWZ0KCk7d2hpbGUoZilpZihhLnJlc3BvbnNlRmllbGRzW2ZdJiYoY1thLnJlc3BvbnNlRmllbGRzW2ZdXT1iKSwhaSYmZCYmYS5kYXRhRmlsdGVyJiYoYj1hLmRhdGFGaWx0ZXIoYixhLmRhdGFUeXBlKSksaT1mLGY9ay5zaGlmdCgpKWlmKCIqIj09PWYpZj1pO2Vsc2UgaWYoIioiIT09aSYmaSE9PWYpe2lmKGc9altpKyIgIitmXXx8alsiKiAiK2ZdLCFnKWZvcihlIGluIGopaWYoaD1lLnNwbGl0KCIgIiksaFsxXT09PWYmJihnPWpbaSsiICIraFswXV18fGpbIiogIitoWzBdXSkpe2c9PT0hMD9nPWpbZV06altlXSE9PSEwJiYoZj1oWzBdLGsudW5zaGlmdChoWzFdKSk7YnJlYWt9aWYoZyE9PSEwKWlmKGcmJmFbInRocm93cyJdKWI9ZyhiKTtlbHNlIHRyeXtiPWcoYil9Y2F0Y2gobCl7cmV0dXJue3N0YXRlOiJwYXJzZXJlcnJvciIsZXJyb3I6Zz9sOiJObyBjb252ZXJzaW9uIGZyb20gIitpKyIgdG8gIitmfX19cmV0dXJue3N0YXRlOiJzdWNjZXNzIixkYXRhOmJ9fXIuZXh0ZW5kKHthY3RpdmU6MCxsYXN0TW9kaWZpZWQ6e30sZXRhZzp7fSxhamF4U2V0dGluZ3M6e3VybDpxYi5ocmVmLHR5cGU6IkdFVCIsaXNMb2NhbDpDYi50ZXN0KHFiLnByb3RvY29sKSxnbG9iYWw6ITAscHJvY2Vzc0RhdGE6ITAsYXN5bmM6ITAsY29udGVudFR5cGU6ImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCIsYWNjZXB0czp7IioiOkhiLHRleHQ6InRleHQvcGxhaW4iLGh0bWw6InRleHQvaHRtbCIseG1sOiJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIixqc29uOiJhcHBsaWNhdGlvbi9qc29uLCB0ZXh0L2phdmFzY3JpcHQifSxjb250ZW50czp7eG1sOi9cYnhtbFxiLyxodG1sOi9cYmh0bWwvLGpzb246L1xianNvblxiL30scmVzcG9uc2VGaWVsZHM6e3htbDoicmVzcG9uc2VYTUwiLHRleHQ6InJlc3BvbnNlVGV4dCIsanNvbjoicmVzcG9uc2VKU09OIn0sY29udmVydGVyczp7IiogdGV4dCI6U3RyaW5nLCJ0ZXh0IGh0bWwiOiEwLCJ0ZXh0IGpzb24iOkpTT04ucGFyc2UsInRleHQgeG1sIjpyLnBhcnNlWE1MfSxmbGF0T3B0aW9uczp7dXJsOiEwLGNvbnRleHQ6ITB9fSxhamF4U2V0dXA6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gYj9MYihMYihhLHIuYWpheFNldHRpbmdzKSxiKTpMYihyLmFqYXhTZXR0aW5ncyxhKX0sYWpheFByZWZpbHRlcjpKYihGYiksYWpheFRyYW5zcG9ydDpKYihHYiksYWpheDpmdW5jdGlvbihiLGMpeyJvYmplY3QiPT10eXBlb2YgYiYmKGM9YixiPXZvaWQgMCksYz1jfHx7fTt2YXIgZSxmLGcsaCxpLGosayxsLG0sbixvPXIuYWpheFNldHVwKHt9LGMpLHA9by5jb250ZXh0fHxvLHE9by5jb250ZXh0JiYocC5ub2RlVHlwZXx8cC5qcXVlcnkpP3IocCk6ci5ldmVudCxzPXIuRGVmZXJyZWQoKSx0PXIuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHU9by5zdGF0dXNDb2RlfHx7fSx2PXt9LHc9e30seD0iY2FuY2VsZWQiLHk9e3JlYWR5U3RhdGU6MCxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihhKXt2YXIgYjtpZihrKXtpZighaCl7aD17fTt3aGlsZShiPUJiLmV4ZWMoZykpaFtiWzFdLnRvTG93ZXJDYXNlKCldPWJbMl19Yj1oW2EudG9Mb3dlckNhc2UoKV19cmV0dXJuIG51bGw9PWI/bnVsbDpifSxnZXRBbGxSZXNwb25zZUhlYWRlcnM6ZnVuY3Rpb24oKXtyZXR1cm4gaz9nOm51bGx9LHNldFJlcXVlc3RIZWFkZXI6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbnVsbD09ayYmKGE9d1thLnRvTG93ZXJDYXNlKCldPXdbYS50b0xvd2VyQ2FzZSgpXXx8YSx2W2FdPWIpLHRoaXN9LG92ZXJyaWRlTWltZVR5cGU6ZnVuY3Rpb24oYSl7cmV0dXJuIG51bGw9PWsmJihvLm1pbWVUeXBlPWEpLHRoaXN9LHN0YXR1c0NvZGU6ZnVuY3Rpb24oYSl7dmFyIGI7aWYoYSlpZihrKXkuYWx3YXlzKGFbeS5zdGF0dXNdKTtlbHNlIGZvcihiIGluIGEpdVtiXT1bdVtiXSxhW2JdXTtyZXR1cm4gdGhpc30sYWJvcnQ6ZnVuY3Rpb24oYSl7dmFyIGI9YXx8eDtyZXR1cm4gZSYmZS5hYm9ydChiKSxBKDAsYiksdGhpc319O2lmKHMucHJvbWlzZSh5KSxvLnVybD0oKGJ8fG8udXJsfHxxYi5ocmVmKSsiIikucmVwbGFjZShFYixxYi5wcm90b2NvbCsiLy8iKSxvLnR5cGU9Yy5tZXRob2R8fGMudHlwZXx8by5tZXRob2R8fG8udHlwZSxvLmRhdGFUeXBlcz0oby5kYXRhVHlwZXx8IioiKS50b0xvd2VyQ2FzZSgpLm1hdGNoKEspfHxbIiJdLG51bGw9PW8uY3Jvc3NEb21haW4pe2o9ZC5jcmVhdGVFbGVtZW50KCJhIik7dHJ5e2ouaHJlZj1vLnVybCxqLmhyZWY9ai5ocmVmLG8uY3Jvc3NEb21haW49SWIucHJvdG9jb2wrIi8vIitJYi5ob3N0IT1qLnByb3RvY29sKyIvLyIrai5ob3N0fWNhdGNoKHope28uY3Jvc3NEb21haW49ITB9fWlmKG8uZGF0YSYmby5wcm9jZXNzRGF0YSYmInN0cmluZyIhPXR5cGVvZiBvLmRhdGEmJihvLmRhdGE9ci5wYXJhbShvLmRhdGEsby50cmFkaXRpb25hbCkpLEtiKEZiLG8sYyx5KSxrKXJldHVybiB5O2w9ci5ldmVudCYmby5nbG9iYWwsbCYmMD09PXIuYWN0aXZlKysmJnIuZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0Iiksby50eXBlPW8udHlwZS50b1VwcGVyQ2FzZSgpLG8uaGFzQ29udGVudD0hRGIudGVzdChvLnR5cGUpLGY9by51cmwucmVwbGFjZSh6YiwiIiksby5oYXNDb250ZW50P28uZGF0YSYmby5wcm9jZXNzRGF0YSYmMD09PShvLmNvbnRlbnRUeXBlfHwiIikuaW5kZXhPZigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIikmJihvLmRhdGE9by5kYXRhLnJlcGxhY2UoeWIsIisiKSk6KG49by51cmwuc2xpY2UoZi5sZW5ndGgpLG8uZGF0YSYmKGYrPShzYi50ZXN0KGYpPyImIjoiPyIpK28uZGF0YSxkZWxldGUgby5kYXRhKSxvLmNhY2hlPT09ITEmJihmPWYucmVwbGFjZShBYiwiJDEiKSxuPShzYi50ZXN0KGYpPyImIjoiPyIpKyJfPSIrcmIrKyArbiksby51cmw9ZituKSxvLmlmTW9kaWZpZWQmJihyLmxhc3RNb2RpZmllZFtmXSYmeS5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Nb2RpZmllZC1TaW5jZSIsci5sYXN0TW9kaWZpZWRbZl0pLHIuZXRhZ1tmXSYmeS5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Ob25lLU1hdGNoIixyLmV0YWdbZl0pKSwoby5kYXRhJiZvLmhhc0NvbnRlbnQmJm8uY29udGVudFR5cGUhPT0hMXx8Yy5jb250ZW50VHlwZSkmJnkuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIixvLmNvbnRlbnRUeXBlKSx5LnNldFJlcXVlc3RIZWFkZXIoIkFjY2VwdCIsby5kYXRhVHlwZXNbMF0mJm8uYWNjZXB0c1tvLmRhdGFUeXBlc1swXV0/by5hY2NlcHRzW28uZGF0YVR5cGVzWzBdXSsoIioiIT09by5kYXRhVHlwZXNbMF0/IiwgIitIYisiOyBxPTAuMDEiOiIiKTpvLmFjY2VwdHNbIioiXSk7Zm9yKG0gaW4gby5oZWFkZXJzKXkuc2V0UmVxdWVzdEhlYWRlcihtLG8uaGVhZGVyc1ttXSk7aWYoby5iZWZvcmVTZW5kJiYoby5iZWZvcmVTZW5kLmNhbGwocCx5LG8pPT09ITF8fGspKXJldHVybiB5LmFib3J0KCk7aWYoeD0iYWJvcnQiLHQuYWRkKG8uY29tcGxldGUpLHkuZG9uZShvLnN1Y2Nlc3MpLHkuZmFpbChvLmVycm9yKSxlPUtiKEdiLG8sYyx5KSl7aWYoeS5yZWFkeVN0YXRlPTEsbCYmcS50cmlnZ2VyKCJhamF4U2VuZCIsW3ksb10pLGspcmV0dXJuIHk7by5hc3luYyYmby50aW1lb3V0PjAmJihpPWEuc2V0VGltZW91dChmdW5jdGlvbigpe3kuYWJvcnQoInRpbWVvdXQiKX0sby50aW1lb3V0KSk7dHJ5e2s9ITEsZS5zZW5kKHYsQSl9Y2F0Y2goeil7aWYoayl0aHJvdyB6O0EoLTEseil9fWVsc2UgQSgtMSwiTm8gVHJhbnNwb3J0Iik7ZnVuY3Rpb24gQShiLGMsZCxoKXt2YXIgaixtLG4sdix3LHg9YztrfHwoaz0hMCxpJiZhLmNsZWFyVGltZW91dChpKSxlPXZvaWQgMCxnPWh8fCIiLHkucmVhZHlTdGF0ZT1iPjA/NDowLGo9Yj49MjAwJiZiPDMwMHx8MzA0PT09YixkJiYodj1NYihvLHksZCkpLHY9TmIobyx2LHksaiksaj8oby5pZk1vZGlmaWVkJiYodz15LmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIiksdyYmKHIubGFzdE1vZGlmaWVkW2ZdPXcpLHc9eS5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpLHcmJihyLmV0YWdbZl09dykpLDIwND09PWJ8fCJIRUFEIj09PW8udHlwZT94PSJub2NvbnRlbnQiOjMwND09PWI/eD0ibm90bW9kaWZpZWQiOih4PXYuc3RhdGUsbT12LmRhdGEsbj12LmVycm9yLGo9IW4pKToobj14LCFiJiZ4fHwoeD0iZXJyb3IiLGI8MCYmKGI9MCkpKSx5LnN0YXR1cz1iLHkuc3RhdHVzVGV4dD0oY3x8eCkrIiIsaj9zLnJlc29sdmVXaXRoKHAsW20seCx5XSk6cy5yZWplY3RXaXRoKHAsW3kseCxuXSkseS5zdGF0dXNDb2RlKHUpLHU9dm9pZCAwLGwmJnEudHJpZ2dlcihqPyJhamF4U3VjY2VzcyI6ImFqYXhFcnJvciIsW3ksbyxqP206bl0pLHQuZmlyZVdpdGgocCxbeSx4XSksbCYmKHEudHJpZ2dlcigiYWpheENvbXBsZXRlIixbeSxvXSksLS1yLmFjdGl2ZXx8ci5ldmVudC50cmlnZ2VyKCJhamF4U3RvcCIpKSl9cmV0dXJuIHl9LGdldEpTT046ZnVuY3Rpb24oYSxiLGMpe3JldHVybiByLmdldChhLGIsYywianNvbiIpfSxnZXRTY3JpcHQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gci5nZXQoYSx2b2lkIDAsYiwic2NyaXB0Iil9fSksci5lYWNoKFsiZ2V0IiwicG9zdCJdLGZ1bmN0aW9uKGEsYil7cltiXT1mdW5jdGlvbihhLGMsZCxlKXtyZXR1cm4gci5pc0Z1bmN0aW9uKGMpJiYoZT1lfHxkLGQ9YyxjPXZvaWQgMCksci5hamF4KHIuZXh0ZW5kKHt1cmw6YSx0eXBlOmIsZGF0YVR5cGU6ZSxkYXRhOmMsc3VjY2VzczpkfSxyLmlzUGxhaW5PYmplY3QoYSkmJmEpKX19KSxyLl9ldmFsVXJsPWZ1bmN0aW9uKGEpe3JldHVybiByLmFqYXgoe3VybDphLHR5cGU6IkdFVCIsZGF0YVR5cGU6InNjcmlwdCIsY2FjaGU6ITAsYXN5bmM6ITEsZ2xvYmFsOiExLCJ0aHJvd3MiOiEwfSl9LHIuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGEpe3ZhciBiO3JldHVybiB0aGlzWzBdJiYoci5pc0Z1bmN0aW9uKGEpJiYoYT1hLmNhbGwodGhpc1swXSkpLGI9cihhLHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApLHRoaXNbMF0ucGFyZW50Tm9kZSYmYi5pbnNlcnRCZWZvcmUodGhpc1swXSksYi5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzO3doaWxlKGEuZmlyc3RFbGVtZW50Q2hpbGQpYT1hLmZpcnN0RWxlbWVudENoaWxkO3JldHVybiBhfSkuYXBwZW5kKHRoaXMpKSx0aGlzfSx3cmFwSW5uZXI6ZnVuY3Rpb24oYSl7cmV0dXJuIHIuaXNGdW5jdGlvbihhKT90aGlzLmVhY2goZnVuY3Rpb24oYil7cih0aGlzKS53cmFwSW5uZXIoYS5jYWxsKHRoaXMsYikpfSk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGI9cih0aGlzKSxjPWIuY29udGVudHMoKTtjLmxlbmd0aD9jLndyYXBBbGwoYSk6Yi5hcHBlbmQoYSl9KX0sd3JhcDpmdW5jdGlvbihhKXt2YXIgYj1yLmlzRnVuY3Rpb24oYSk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihjKXtyKHRoaXMpLndyYXBBbGwoYj9hLmNhbGwodGhpcyxjKTphKX0pfSx1bndyYXA6ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMucGFyZW50KGEpLm5vdCgiYm9keSIpLmVhY2goZnVuY3Rpb24oKXtyKHRoaXMpLnJlcGxhY2VXaXRoKHRoaXMuY2hpbGROb2Rlcyl9KSx0aGlzfX0pLHIuZXhwci5wc2V1ZG9zLmhpZGRlbj1mdW5jdGlvbihhKXtyZXR1cm4hci5leHByLnBzZXVkb3MudmlzaWJsZShhKX0sci5leHByLnBzZXVkb3MudmlzaWJsZT1mdW5jdGlvbihhKXtyZXR1cm4hIShhLm9mZnNldFdpZHRofHxhLm9mZnNldEhlaWdodHx8YS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCl9LHIuYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IGEuWE1MSHR0cFJlcXVlc3R9Y2F0Y2goYil7fX07dmFyIE9iPXswOjIwMCwxMjIzOjIwNH0sUGI9ci5hamF4U2V0dGluZ3MueGhyKCk7by5jb3JzPSEhUGImJiJ3aXRoQ3JlZGVudGlhbHMiaW4gUGIsby5hamF4PVBiPSEhUGIsci5hamF4VHJhbnNwb3J0KGZ1bmN0aW9uKGIpe3ZhciBjLGQ7aWYoby5jb3JzfHxQYiYmIWIuY3Jvc3NEb21haW4pcmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSxmKXt2YXIgZyxoPWIueGhyKCk7aWYoaC5vcGVuKGIudHlwZSxiLnVybCxiLmFzeW5jLGIudXNlcm5hbWUsYi5wYXNzd29yZCksYi54aHJGaWVsZHMpZm9yKGcgaW4gYi54aHJGaWVsZHMpaFtnXT1iLnhockZpZWxkc1tnXTtiLm1pbWVUeXBlJiZoLm92ZXJyaWRlTWltZVR5cGUmJmgub3ZlcnJpZGVNaW1lVHlwZShiLm1pbWVUeXBlKSxiLmNyb3NzRG9tYWlufHxlWyJYLVJlcXVlc3RlZC1XaXRoIl18fChlWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0Iik7Zm9yKGcgaW4gZSloLnNldFJlcXVlc3RIZWFkZXIoZyxlW2ddKTtjPWZ1bmN0aW9uKGEpe3JldHVybiBmdW5jdGlvbigpe2MmJihjPWQ9aC5vbmxvYWQ9aC5vbmVycm9yPWgub25hYm9ydD1oLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLCJhYm9ydCI9PT1hP2guYWJvcnQoKToiZXJyb3IiPT09YT8ibnVtYmVyIiE9dHlwZW9mIGguc3RhdHVzP2YoMCwiZXJyb3IiKTpmKGguc3RhdHVzLGguc3RhdHVzVGV4dCk6ZihPYltoLnN0YXR1c118fGguc3RhdHVzLGguc3RhdHVzVGV4dCwidGV4dCIhPT0oaC5yZXNwb25zZVR5cGV8fCJ0ZXh0Iil8fCJzdHJpbmciIT10eXBlb2YgaC5yZXNwb25zZVRleHQ/e2JpbmFyeTpoLnJlc3BvbnNlfTp7dGV4dDpoLnJlc3BvbnNlVGV4dH0saC5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0saC5vbmxvYWQ9YygpLGQ9aC5vbmVycm9yPWMoImVycm9yIiksdm9pZCAwIT09aC5vbmFib3J0P2gub25hYm9ydD1kOmgub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PWgucmVhZHlTdGF0ZSYmYS5zZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YyYmZCgpfSl9LGM9YygiYWJvcnQiKTt0cnl7aC5zZW5kKGIuaGFzQ29udGVudCYmYi5kYXRhfHxudWxsKX1jYXRjaChpKXtpZihjKXRocm93IGl9fSxhYm9ydDpmdW5jdGlvbigpe2MmJmMoKX19fSksci5hamF4UHJlZmlsdGVyKGZ1bmN0aW9uKGEpe2EuY3Jvc3NEb21haW4mJihhLmNvbnRlbnRzLnNjcmlwdD0hMSl9KSxyLmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6L1xiKD86amF2YXxlY21hKXNjcmlwdFxiL30sY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbihhKXtyZXR1cm4gci5nbG9iYWxFdmFsKGEpLGF9fX0pLHIuYWpheFByZWZpbHRlcigic2NyaXB0IixmdW5jdGlvbihhKXt2b2lkIDA9PT1hLmNhY2hlJiYoYS5jYWNoZT0hMSksYS5jcm9zc0RvbWFpbiYmKGEudHlwZT0iR0VUIil9KSxyLmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24oYSl7aWYoYS5jcm9zc0RvbWFpbil7dmFyIGIsYztyZXR1cm57c2VuZDpmdW5jdGlvbihlLGYpe2I9cigiPHNjcmlwdD4iKS5wcm9wKHtjaGFyc2V0OmEuc2NyaXB0Q2hhcnNldCxzcmM6YS51cmx9KS5vbigibG9hZCBlcnJvciIsYz1mdW5jdGlvbihhKXtiLnJlbW92ZSgpLGM9bnVsbCxhJiZmKCJlcnJvciI9PT1hLnR5cGU/NDA0OjIwMCxhLnR5cGUpfSksZC5oZWFkLmFwcGVuZENoaWxkKGJbMF0pfSxhYm9ydDpmdW5jdGlvbigpe2MmJmMoKX19fX0pO3ZhciBRYj1bXSxSYj0vKD0pXD8oPz0mfCQpfFw/XD8vO3IuYWpheFNldHVwKHtqc29ucDoiY2FsbGJhY2siLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgYT1RYi5wb3AoKXx8ci5leHBhbmRvKyJfIityYisrO3JldHVybiB0aGlzW2FdPSEwLGF9fSksci5hamF4UHJlZmlsdGVyKCJqc29uIGpzb25wIixmdW5jdGlvbihiLGMsZCl7dmFyIGUsZixnLGg9Yi5qc29ucCE9PSExJiYoUmIudGVzdChiLnVybCk/InVybCI6InN0cmluZyI9PXR5cGVvZiBiLmRhdGEmJjA9PT0oYi5jb250ZW50VHlwZXx8IiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpJiZSYi50ZXN0KGIuZGF0YSkmJiJkYXRhIik7aWYoaHx8Impzb25wIj09PWIuZGF0YVR5cGVzWzBdKXJldHVybiBlPWIuanNvbnBDYWxsYmFjaz1yLmlzRnVuY3Rpb24oYi5qc29ucENhbGxiYWNrKT9iLmpzb25wQ2FsbGJhY2soKTpiLmpzb25wQ2FsbGJhY2ssaD9iW2hdPWJbaF0ucmVwbGFjZShSYiwiJDEiK2UpOmIuanNvbnAhPT0hMSYmKGIudXJsKz0oc2IudGVzdChiLnVybCk/IiYiOiI/IikrYi5qc29ucCsiPSIrZSksYi5jb252ZXJ0ZXJzWyJzY3JpcHQganNvbiJdPWZ1bmN0aW9uKCl7cmV0dXJuIGd8fHIuZXJyb3IoZSsiIHdhcyBub3QgY2FsbGVkIiksZ1swXX0sYi5kYXRhVHlwZXNbMF09Impzb24iLGY9YVtlXSxhW2VdPWZ1bmN0aW9uKCl7Zz1hcmd1bWVudHN9LGQuYWx3YXlzKGZ1bmN0aW9uKCl7dm9pZCAwPT09Zj9yKGEpLnJlbW92ZVByb3AoZSk6YVtlXT1mLGJbZV0mJihiLmpzb25wQ2FsbGJhY2s9Yy5qc29ucENhbGxiYWNrLFFiLnB1c2goZSkpLGcmJnIuaXNGdW5jdGlvbihmKSYmZihnWzBdKSxnPWY9dm9pZCAwfSksInNjcmlwdCJ9KSxvLmNyZWF0ZUhUTUxEb2N1bWVudD1mdW5jdGlvbigpe3ZhciBhPWQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCIiKS5ib2R5O3JldHVybiBhLmlubmVySFRNTD0iPGZvcm0+PC9mb3JtPjxmb3JtPjwvZm9ybT4iLDI9PT1hLmNoaWxkTm9kZXMubGVuZ3RofSgpLHIucGFyc2VIVE1MPWZ1bmN0aW9uKGEsYixjKXtpZigic3RyaW5nIiE9dHlwZW9mIGEpcmV0dXJuW107ImJvb2xlYW4iPT10eXBlb2YgYiYmKGM9YixiPSExKTt2YXIgZSxmLGc7cmV0dXJuIGJ8fChvLmNyZWF0ZUhUTUxEb2N1bWVudD8oYj1kLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIiksZT1iLmNyZWF0ZUVsZW1lbnQoImJhc2UiKSxlLmhyZWY9ZC5sb2NhdGlvbi5ocmVmLGIuaGVhZC5hcHBlbmRDaGlsZChlKSk6Yj1kKSxmPUIuZXhlYyhhKSxnPSFjJiZbXSxmP1tiLmNyZWF0ZUVsZW1lbnQoZlsxXSldOihmPXBhKFthXSxiLGcpLGcmJmcubGVuZ3RoJiZyKGcpLnJlbW92ZSgpLHIubWVyZ2UoW10sZi5jaGlsZE5vZGVzKSl9LHIuZm4ubG9hZD1mdW5jdGlvbihhLGIsYyl7dmFyIGQsZSxmLGc9dGhpcyxoPWEuaW5kZXhPZigiICIpO3JldHVybiBoPi0xJiYoZD1tYihhLnNsaWNlKGgpKSxhPWEuc2xpY2UoMCxoKSksci5pc0Z1bmN0aW9uKGIpPyhjPWIsYj12b2lkIDApOmImJiJvYmplY3QiPT10eXBlb2YgYiYmKGU9IlBPU1QiKSxnLmxlbmd0aD4wJiZyLmFqYXgoe3VybDphLHR5cGU6ZXx8IkdFVCIsZGF0YVR5cGU6Imh0bWwiLGRhdGE6Yn0pLmRvbmUoZnVuY3Rpb24oYSl7Zj1hcmd1bWVudHMsZy5odG1sKGQ/cigiPGRpdj4iKS5hcHBlbmQoci5wYXJzZUhUTUwoYSkpLmZpbmQoZCk6YSl9KS5hbHdheXMoYyYmZnVuY3Rpb24oYSxiKXtnLmVhY2goZnVuY3Rpb24oKXtjLmFwcGx5KHRoaXMsZnx8W2EucmVzcG9uc2VUZXh0LGIsYV0pfSl9KSx0aGlzfSxyLmVhY2goWyJhamF4U3RhcnQiLCJhamF4U3RvcCIsImFqYXhDb21wbGV0ZSIsImFqYXhFcnJvciIsImFqYXhTdWNjZXNzIiwiYWpheFNlbmQiXSxmdW5jdGlvbihhLGIpe3IuZm5bYl09ZnVuY3Rpb24oYSl7cmV0dXJuIHRoaXMub24oYixhKX19KSxyLmV4cHIucHNldWRvcy5hbmltYXRlZD1mdW5jdGlvbihhKXtyZXR1cm4gci5ncmVwKHIudGltZXJzLGZ1bmN0aW9uKGIpe3JldHVybiBhPT09Yi5lbGVtfSkubGVuZ3RofTtmdW5jdGlvbiBTYihhKXtyZXR1cm4gci5pc1dpbmRvdyhhKT9hOjk9PT1hLm5vZGVUeXBlJiZhLmRlZmF1bHRWaWV3fXIub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oYSxiLGMpe3ZhciBkLGUsZixnLGgsaSxqLGs9ci5jc3MoYSwicG9zaXRpb24iKSxsPXIoYSksbT17fTsic3RhdGljIj09PWsmJihhLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSIpLGg9bC5vZmZzZXQoKSxmPXIuY3NzKGEsInRvcCIpLGk9ci5jc3MoYSwibGVmdCIpLGo9KCJhYnNvbHV0ZSI9PT1rfHwiZml4ZWQiPT09aykmJihmK2kpLmluZGV4T2YoImF1dG8iKT4tMSxqPyhkPWwucG9zaXRpb24oKSxnPWQudG9wLGU9ZC5sZWZ0KTooZz1wYXJzZUZsb2F0KGYpfHwwLGU9cGFyc2VGbG9hdChpKXx8MCksci5pc0Z1bmN0aW9uKGIpJiYoYj1iLmNhbGwoYSxjLHIuZXh0ZW5kKHt9LGgpKSksbnVsbCE9Yi50b3AmJihtLnRvcD1iLnRvcC1oLnRvcCtnKSxudWxsIT1iLmxlZnQmJihtLmxlZnQ9Yi5sZWZ0LWgubGVmdCtlKSwidXNpbmciaW4gYj9iLnVzaW5nLmNhbGwoYSxtKTpsLmNzcyhtKX19LHIuZm4uZXh0ZW5kKHtvZmZzZXQ6ZnVuY3Rpb24oYSl7aWYoYXJndW1lbnRzLmxlbmd0aClyZXR1cm4gdm9pZCAwPT09YT90aGlzOnRoaXMuZWFjaChmdW5jdGlvbihiKXtyLm9mZnNldC5zZXRPZmZzZXQodGhpcyxhLGIpfSk7dmFyIGIsYyxkLGUsZj10aGlzWzBdO2lmKGYpcmV0dXJuIGYuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGg/KGQ9Zi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSxkLndpZHRofHxkLmhlaWdodD8oZT1mLm93bmVyRG9jdW1lbnQsYz1TYihlKSxiPWUuZG9jdW1lbnRFbGVtZW50LHt0b3A6ZC50b3ArYy5wYWdlWU9mZnNldC1iLmNsaWVudFRvcCxsZWZ0OmQubGVmdCtjLnBhZ2VYT2Zmc2V0LWIuY2xpZW50TGVmdH0pOmQpOnt0b3A6MCxsZWZ0OjB9fSxwb3NpdGlvbjpmdW5jdGlvbigpe2lmKHRoaXNbMF0pe3ZhciBhLGIsYz10aGlzWzBdLGQ9e3RvcDowLGxlZnQ6MH07cmV0dXJuImZpeGVkIj09PXIuY3NzKGMsInBvc2l0aW9uIik/Yj1jLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOihhPXRoaXMub2Zmc2V0UGFyZW50KCksYj10aGlzLm9mZnNldCgpLHIubm9kZU5hbWUoYVswXSwiaHRtbCIpfHwoZD1hLm9mZnNldCgpKSxkPXt0b3A6ZC50b3Arci5jc3MoYVswXSwiYm9yZGVyVG9wV2lkdGgiLCEwKSxsZWZ0OmQubGVmdCtyLmNzcyhhWzBdLCJib3JkZXJMZWZ0V2lkdGgiLCEwKX0pLHt0b3A6Yi50b3AtZC50b3Atci5jc3MoYywibWFyZ2luVG9wIiwhMCksbGVmdDpiLmxlZnQtZC5sZWZ0LXIuY3NzKGMsIm1hcmdpbkxlZnQiLCEwKX19fSxvZmZzZXRQYXJlbnQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgYT10aGlzLm9mZnNldFBhcmVudDt3aGlsZShhJiYic3RhdGljIj09PXIuY3NzKGEsInBvc2l0aW9uIikpYT1hLm9mZnNldFBhcmVudDtyZXR1cm4gYXx8cWF9KX19KSxyLmVhY2goe3Njcm9sbExlZnQ6InBhZ2VYT2Zmc2V0IixzY3JvbGxUb3A6InBhZ2VZT2Zmc2V0In0sZnVuY3Rpb24oYSxiKXt2YXIgYz0icGFnZVlPZmZzZXQiPT09YjtyLmZuW2FdPWZ1bmN0aW9uKGQpe3JldHVybiBTKHRoaXMsZnVuY3Rpb24oYSxkLGUpe3ZhciBmPVNiKGEpO3JldHVybiB2b2lkIDA9PT1lP2Y/ZltiXTphW2RdOnZvaWQoZj9mLnNjcm9sbFRvKGM/Zi5wYWdlWE9mZnNldDplLGM/ZTpmLnBhZ2VZT2Zmc2V0KTphW2RdPWUpfSxhLGQsYXJndW1lbnRzLmxlbmd0aCl9fSksci5lYWNoKFsidG9wIiwibGVmdCJdLGZ1bmN0aW9uKGEsYil7ci5jc3NIb29rc1tiXT1PYShvLnBpeGVsUG9zaXRpb24sZnVuY3Rpb24oYSxjKXtpZihjKXJldHVybiBjPU5hKGEsYiksTGEudGVzdChjKT9yKGEpLnBvc2l0aW9uKClbYl0rInB4IjpjfSl9KSxyLmVhY2goe0hlaWdodDoiaGVpZ2h0IixXaWR0aDoid2lkdGgifSxmdW5jdGlvbihhLGIpe3IuZWFjaCh7cGFkZGluZzoiaW5uZXIiK2EsY29udGVudDpiLCIiOiJvdXRlciIrYX0sZnVuY3Rpb24oYyxkKXtyLmZuW2RdPWZ1bmN0aW9uKGUsZil7dmFyIGc9YXJndW1lbnRzLmxlbmd0aCYmKGN8fCJib29sZWFuIiE9dHlwZW9mIGUpLGg9Y3x8KGU9PT0hMHx8Zj09PSEwPyJtYXJnaW4iOiJib3JkZXIiKTtyZXR1cm4gUyh0aGlzLGZ1bmN0aW9uKGIsYyxlKXt2YXIgZjtyZXR1cm4gci5pc1dpbmRvdyhiKT8wPT09ZC5pbmRleE9mKCJvdXRlciIpP2JbImlubmVyIithXTpiLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsiY2xpZW50IithXTo5PT09Yi5ub2RlVHlwZT8oZj1iLmRvY3VtZW50RWxlbWVudCxNYXRoLm1heChiLmJvZHlbInNjcm9sbCIrYV0sZlsic2Nyb2xsIithXSxiLmJvZHlbIm9mZnNldCIrYV0sZlsib2Zmc2V0IithXSxmWyJjbGllbnQiK2FdKSk6dm9pZCAwPT09ZT9yLmNzcyhiLGMsaCk6ci5zdHlsZShiLGMsZSxoKX0sYixnP2U6dm9pZCAwLGcpfX0pfSksci5mbi5leHRlbmQoe2JpbmQ6ZnVuY3Rpb24oYSxiLGMpe3JldHVybiB0aGlzLm9uKGEsbnVsbCxiLGMpfSx1bmJpbmQ6ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5vZmYoYSxudWxsLGIpfSxkZWxlZ2F0ZTpmdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5vbihiLGEsYyxkKX0sdW5kZWxlZ2F0ZTpmdW5jdGlvbihhLGIsYyl7cmV0dXJuIDE9PT1hcmd1bWVudHMubGVuZ3RoP3RoaXMub2ZmKGEsIioqIik6dGhpcy5vZmYoYixhfHwiKioiLGMpfX0pLHIucGFyc2VKU09OPUpTT04ucGFyc2UsImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZCYmZGVmaW5lKCJqcXVlcnkiLFtdLGZ1bmN0aW9uKCl7cmV0dXJuIHJ9KTt2YXIgVGI9YS5qUXVlcnksVWI9YS4kO3JldHVybiByLm5vQ29uZmxpY3Q9ZnVuY3Rpb24oYil7cmV0dXJuIGEuJD09PXImJihhLiQ9VWIpLGImJmEualF1ZXJ5PT09ciYmKGEualF1ZXJ5PVRiKSxyfSxifHwoYS5qUXVlcnk9YS4kPXIpLHJ9KTsKAA=="
  }
}
)xyzxyz";
// ----- 
